{"version":3,"file":"static/js/25.bf0b8665.chunk.js","mappings":"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","sources":["../node_modules/pixi.js/src/scene/graphics/gl/GlGraphicsAdaptor.ts","../node_modules/pixi.js/src/scene/mesh/gl/GlMeshAdaptor.ts","../node_modules/pixi.js/src/rendering/batcher/gl/GlBatchAdaptor.ts","../node_modules/pixi.js/src/rendering/renderers/gl/buffer/const.ts","../node_modules/pixi.js/src/rendering/renderers/gl/buffer/GlBuffer.ts","../node_modules/pixi.js/src/rendering/renderers/gl/buffer/GlBufferSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/context/GlContextSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/const.ts","../node_modules/pixi.js/src/rendering/renderers/gl/geometry/utils/getGlTypeFromFormat.ts","../node_modules/pixi.js/src/rendering/renderers/gl/geometry/GlGeometrySystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlBackBufferSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlColorMaskSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlEncoderSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlLimitsSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlStencilSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/utils/createUboElementsSTD40.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/utils/generateArraySyncSTD40.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/utils/createUboSyncSTD40.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlUboSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/GlRenderTarget.ts","../node_modules/pixi.js/src/rendering/renderers/gl/renderTarget/GlRenderTargetAdaptor.ts","../node_modules/pixi.js/src/rendering/renderers/gl/renderTarget/GlRenderTargetSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/GlProgramData.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/compileShader.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/defaultValue.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/mapType.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/logProgramError.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/generateProgram.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/extractAttributesFromGlProgram.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/getUniformData.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/program/getUboData.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/GlShaderSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/GenerateShaderSyncCode.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/utils/generateUniformsSyncTypes.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/GlUniformGroupSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/shader/utils/generateUniformsSync.ts","../node_modules/pixi.js/src/rendering/renderers/gl/state/GlStateSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/state/mapWebGLBlendModesToPixi.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/GlTexture.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/uploaders/glUploadBufferImageResource.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/uploaders/glUploadCompressedTextureResource.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/uploaders/glUploadImageResource.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/uploaders/glUploadVideoResource.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/utils/pixiToGlMaps.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/utils/applyStyleParams.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/GlTextureSystem.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/utils/mapFormatToGlInternalFormat.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/utils/mapFormatToGlType.ts","../node_modules/pixi.js/src/rendering/renderers/gl/texture/utils/mapFormatToGlFormat.ts","../node_modules/pixi.js/src/rendering/renderers/gl/WebGLRenderer.ts"],"sourcesContent":["import { ExtensionType } from '../../../extensions/Extensions';\nimport { Matrix } from '../../../maths/matrix/Matrix';\nimport { compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram';\nimport { colorBitGl } from '../../../rendering/high-shader/shader-bits/colorBit';\nimport { generateTextureBatchBitGl } from '../../../rendering/high-shader/shader-bits/generateTextureBatchBit';\nimport { localUniformBitGl } from '../../../rendering/high-shader/shader-bits/localUniformBit';\nimport { roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit';\nimport { getBatchSamplersUniformGroup } from '../../../rendering/renderers/gl/shader/getBatchSamplersUniformGroup';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup';\nimport { type Renderer } from '../../../rendering/renderers/types';\n\nimport type { Batch } from '../../../rendering/batcher/shared/Batcher';\nimport type { WebGLRenderer } from '../../../rendering/renderers/gl/WebGLRenderer';\nimport type { Graphics } from '../shared/Graphics';\nimport type { GraphicsAdaptor, GraphicsPipe } from '../shared/GraphicsPipe';\n\n/**\n * A GraphicsAdaptor that uses WebGL to render graphics.\n * @category rendering\n * @ignore\n */\nexport class GlGraphicsAdaptor implements GraphicsAdaptor\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLPipesAdaptor,\n        ],\n        name: 'graphics',\n    } as const;\n\n    public shader: Shader;\n\n    public contextChange(renderer: Renderer): void\n    {\n        const uniforms = new UniformGroup({\n            uColor: { value: new Float32Array([1, 1, 1, 1]), type: 'vec4<f32>' },\n            uTransformMatrix: { value: new Matrix(), type: 'mat3x3<f32>' },\n            uRound: { value: 0, type: 'f32' },\n        });\n\n        const maxTextures = renderer.limits.maxBatchableTextures;\n\n        const glProgram = compileHighShaderGlProgram({\n            name: 'graphics',\n            bits: [\n                colorBitGl,\n                generateTextureBatchBitGl(maxTextures),\n                localUniformBitGl,\n                roundPixelsBitGl,\n            ]\n        });\n\n        this.shader = new Shader({\n            glProgram,\n            resources: {\n                localUniforms: uniforms,\n                batchSamplers: getBatchSamplersUniformGroup(maxTextures),\n            }\n        });\n    }\n\n    public execute(graphicsPipe: GraphicsPipe, renderable: Graphics): void\n    {\n        const context = renderable.context;\n        const shader = context.customShader || this.shader;\n        const renderer = graphicsPipe.renderer as WebGLRenderer;\n        const contextSystem = renderer.graphicsContext;\n\n        const {\n            batcher, instructions,\n        } = contextSystem.getContextRenderData(context);\n\n        // WebGL specific..\n        shader.groups[0] = renderer.globalUniforms.bindGroup;\n\n        renderer.state.set(graphicsPipe.state);\n\n        renderer.shader.bind(shader);\n\n        renderer.geometry.bind(batcher.geometry, shader.glProgram);\n\n        const batches = instructions.instructions as Batch[];\n\n        for (let i = 0; i < instructions.instructionSize; i++)\n        {\n            const batch = batches[i];\n\n            if (batch.size)\n            {\n                for (let j = 0; j < batch.textures.count; j++)\n                {\n                    renderer.texture.bind(batch.textures.textures[j], j);\n                }\n\n                renderer.geometry.draw(batch.topology, batch.size, batch.start);\n            }\n        }\n    }\n\n    public destroy(): void\n    {\n        this.shader.destroy(true);\n        this.shader = null;\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { Matrix } from '../../../maths/matrix/Matrix';\nimport { compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram';\nimport { localUniformBitGl } from '../../../rendering/high-shader/shader-bits/localUniformBit';\nimport { roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit';\nimport { textureBitGl } from '../../../rendering/high-shader/shader-bits/textureBit';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader';\nimport { Texture } from '../../../rendering/renderers/shared/texture/Texture';\nimport { warn } from '../../../utils/logging/warn';\n\nimport type { Mesh } from '../shared/Mesh';\nimport type { MeshAdaptor, MeshPipe } from '../shared/MeshPipe';\n\n/**\n * A MeshAdaptor that uses the WebGL to render meshes.\n * @category rendering\n * @ignore\n */\nexport class GlMeshAdaptor implements MeshAdaptor\n{\n    public static extension = {\n        type: [\n            ExtensionType.WebGLPipesAdaptor,\n        ],\n        name: 'mesh',\n    } as const;\n\n    private _shader: Shader;\n\n    public init(): void\n    {\n        const glProgram = compileHighShaderGlProgram({\n            name: 'mesh',\n            bits: [\n                localUniformBitGl,\n                textureBitGl,\n                roundPixelsBitGl,\n            ]\n        });\n\n        this._shader = new Shader({\n            glProgram,\n            resources: {\n                uTexture: Texture.EMPTY.source,\n                textureUniforms: {\n                    uTextureMatrix: { type: 'mat3x3<f32>', value: new Matrix() },\n                }\n            }\n        });\n    }\n\n    public execute(meshPipe: MeshPipe, mesh: Mesh): void\n    {\n        const renderer = meshPipe.renderer;\n\n        let shader: Shader = mesh._shader;\n\n        if (!shader)\n        {\n            shader = this._shader;\n\n            const texture = mesh.texture;\n            const source = texture.source;\n\n            shader.resources.uTexture = source;\n            shader.resources.uSampler = source.style;\n            shader.resources.textureUniforms.uniforms.uTextureMatrix = texture.textureMatrix.mapCoord;\n        }\n        else if (!shader.glProgram)\n        {\n            // #if _DEBUG\n            warn('Mesh shader has no glProgram', mesh.shader);\n            // #endif\n\n            return;\n        }\n\n        // setting the groups to be high to be compatible and not\n        // overlap any other groups\n        shader.groups[100] = renderer.globalUniforms.bindGroup;\n        shader.groups[101] = meshPipe.localUniformsBindGroup;\n\n        renderer.encoder.draw({\n            geometry: mesh._geometry,\n            shader,\n            state: mesh.state,\n        });\n    }\n\n    public destroy(): void\n    {\n        this._shader.destroy(true);\n        this._shader = null;\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { State } from '../../renderers/shared/state/State';\n\nimport type { WebGLRenderer } from '../../renderers/gl/WebGLRenderer';\nimport type { Geometry } from '../../renderers/shared/geometry/Geometry';\nimport type { Shader } from '../../renderers/shared/shader/Shader';\nimport type { Batch } from '../shared/Batcher';\nimport type { BatcherAdaptor, BatcherPipe } from '../shared/BatcherPipe';\n\n/**\n * A BatcherAdaptor that uses WebGL to render batches.\n * @category rendering\n * @ignore\n */\nexport class GlBatchAdaptor implements BatcherAdaptor\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLPipesAdaptor,\n        ],\n        name: 'batch',\n    } as const;\n\n    private readonly _tempState = State.for2d();\n\n    /**\n     * We only want to sync the a batched shaders uniforms once on first use\n     * this is a hash of shader uids to a boolean value.  When the shader is first bound\n     * we set the value to true.  When the shader is bound again we check the value and\n     * if it is true we know that the uniforms have already been synced and we skip it.\n     */\n    private _didUploadHash: Record<string, boolean> = {};\n    public init(batcherPipe: BatcherPipe): void\n    {\n        batcherPipe.renderer.runners.contextChange.add(this);\n    }\n\n    public contextChange(): void\n    {\n        this._didUploadHash = {};\n    }\n\n    public start(batchPipe: BatcherPipe, geometry: Geometry, shader: Shader): void\n    {\n        const renderer = batchPipe.renderer as WebGLRenderer;\n\n        const didUpload = this._didUploadHash[shader.uid];\n\n        // only want to sync the shade ron its first bind!\n        renderer.shader.bind(shader, didUpload);\n\n        if (!didUpload)\n        {\n            this._didUploadHash[shader.uid] = true;\n        }\n\n        renderer.shader.updateUniformGroup(renderer.globalUniforms.uniformGroup);\n\n        renderer.geometry.bind(geometry, shader.glProgram);\n    }\n\n    public execute(batchPipe: BatcherPipe, batch: Batch): void\n    {\n        const renderer = batchPipe.renderer as WebGLRenderer;\n\n        this._tempState.blendMode = batch.blendMode;\n\n        renderer.state.set(this._tempState);\n\n        const textures = batch.textures.textures;\n\n        for (let i = 0; i < batch.textures.count; i++)\n        {\n            renderer.texture.bind(textures[i], i);\n        }\n\n        renderer.geometry.draw(batch.topology, batch.size, batch.start);\n    }\n}\n","/**\n * Constants for various buffer types in Pixi\n * @category rendering\n * @advanced\n */\nexport enum BUFFER_TYPE\n{\n    /** buffer type for using as an index buffer */\n    ELEMENT_ARRAY_BUFFER = 34963,\n    /** buffer type for using attribute data */\n    ARRAY_BUFFER = 34962,\n    /** the buffer type is for uniform buffer objects */\n    UNIFORM_BUFFER = 35345,\n}\n\n","import type { BUFFER_TYPE } from './const';\n\n/** @internal */\nexport class GlBuffer\n{\n    public buffer: WebGLBuffer;\n    public updateID: number;\n    public byteLength: number;\n    public type: number;\n\n    public _lastBindBaseLocation: number = -1;\n    public _lastBindCallId: number = -1;\n\n    constructor(buffer: WebGLBuffer, type: BUFFER_TYPE)\n    {\n        this.buffer = buffer || null;\n        this.updateID = -1;\n        this.byteLength = -1;\n        this.type = type;\n    }\n}\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { BufferUsage } from '../../shared/buffer/const';\nimport { BUFFER_TYPE } from './const';\nimport { GlBuffer } from './GlBuffer';\n\nimport type { Buffer } from '../../shared/buffer/Buffer';\nimport type { System } from '../../shared/system/System';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\nimport type { WebGLRenderer } from '../WebGLRenderer';\n\n/**\n * System plugin to the renderer to manage buffers.\n *\n * WebGL uses Buffers as a way to store objects to the GPU.\n * This system makes working with them a lot easier.\n *\n * Buffers are used in three main places in WebGL\n * - geometry information\n * - Uniform information (via uniform buffer objects - a WebGL 2 only feature)\n * - Transform feedback information. (WebGL 2 only feature)\n *\n * This system will handle the binding of buffers to the GPU as well as uploading\n * them. With this system, you never need to work directly with GPU buffers, but instead work with\n * the Buffer class.\n * @class\n * @category rendering\n * @advanced\n */\nexport class GlBufferSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'buffer',\n    } as const;\n\n    private _gl: GlRenderingContext;\n    private _gpuBuffers: {[key: number]: GlBuffer} = Object.create(null);\n\n    /** Cache keeping track of the base bound buffer bases */\n    private _boundBufferBases: {[key: number]: GlBuffer} = Object.create(null);\n\n    private _renderer: WebGLRenderer;\n\n    private _minBaseLocation = 0;\n    private _maxBindings: number;\n    private _nextBindBaseIndex = this._minBaseLocation;\n    private _bindCallId = 0;\n\n    /**\n     * @param {Renderer} renderer - The renderer this System works for.\n     */\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n\n        this._renderer.renderableGC.addManagedHash(this, '_gpuBuffers');\n    }\n\n    /** @ignore */\n    public destroy(): void\n    {\n        this._renderer = null;\n        this._gl = null;\n        this._gpuBuffers = null;\n        (this._boundBufferBases as null) = null;\n    }\n\n    /** Sets up the renderer context and necessary buffers. */\n    protected contextChange(): void\n    {\n        this._gl = this._renderer.gl;\n\n        this._gpuBuffers = Object.create(null);\n        this._maxBindings = this._renderer.limits.maxUniformBindings;\n    }\n\n    public getGlBuffer(buffer: Buffer): GlBuffer\n    {\n        return this._gpuBuffers[buffer.uid] || this.createGLBuffer(buffer);\n    }\n\n    /**\n     * This binds specified buffer. On first run, it will create the webGL buffers for the context too\n     * @param buffer - the buffer to bind to the renderer\n     */\n    public bind(buffer: Buffer): void\n    {\n        const { _gl: gl } = this;\n\n        const glBuffer = this.getGlBuffer(buffer);\n\n        gl.bindBuffer(glBuffer.type, glBuffer.buffer);\n    }\n\n    /**\n     * Binds an uniform buffer to at the given index.\n     *\n     * A cache is used so a buffer will not be bound again if already bound.\n     * @param glBuffer - the buffer to bind\n     * @param index - the base index to bind it to.\n     */\n    public bindBufferBase(glBuffer: GlBuffer, index: number): void\n    {\n        const { _gl: gl } = this;\n\n        if (this._boundBufferBases[index] !== glBuffer)\n        {\n            this._boundBufferBases[index] = glBuffer;\n            glBuffer._lastBindBaseLocation = index;\n\n            gl.bindBufferBase(gl.UNIFORM_BUFFER, index, glBuffer.buffer);\n        }\n    }\n\n    public nextBindBase(hasTransformFeedback: boolean)\n    {\n        this._bindCallId++;\n        this._minBaseLocation = 0;\n        if (hasTransformFeedback)\n        {\n            this._boundBufferBases[0] = null;\n            this._minBaseLocation = 1;\n            if (this._nextBindBaseIndex < 1)\n            {\n                this._nextBindBaseIndex = 1;\n            }\n        }\n    }\n\n    public freeLocationForBufferBase(glBuffer: GlBuffer): number\n    {\n        let freeIndex = this.getLastBindBaseLocation(glBuffer);\n\n        // check if it is already bound..\n        if (freeIndex >= this._minBaseLocation)\n        {\n            glBuffer._lastBindCallId = this._bindCallId;\n\n            return freeIndex;\n        }\n\n        let loop = 0;\n        let nextIndex = this._nextBindBaseIndex;\n\n        while (loop < 2)\n        {\n            if (nextIndex >= this._maxBindings)\n            {\n                nextIndex = this._minBaseLocation;\n                loop++;\n            }\n\n            const curBuf = this._boundBufferBases[nextIndex];\n\n            if (curBuf && curBuf._lastBindCallId === this._bindCallId)\n            {\n                nextIndex++;\n                continue;\n            }\n            break;\n        }\n\n        freeIndex = nextIndex;\n        this._nextBindBaseIndex = nextIndex + 1;\n\n        if (loop >= 2)\n        {\n            // TODO: error\n            return -1;\n        }\n\n        glBuffer._lastBindCallId = this._bindCallId;\n        this._boundBufferBases[freeIndex] = null;\n\n        return freeIndex;\n    }\n\n    public getLastBindBaseLocation(glBuffer: GlBuffer): number\n    {\n        const index = glBuffer._lastBindBaseLocation;\n\n        if (this._boundBufferBases[index] === glBuffer)\n        {\n            return index;\n        }\n\n        return -1;\n    }\n\n    /**\n     * Binds a buffer whilst also binding its range.\n     * This will make the buffer start from the offset supplied rather than 0 when it is read.\n     * @param glBuffer - the buffer to bind\n     * @param index - the base index to bind at, defaults to 0\n     * @param offset - the offset to bind at (this is blocks of 256). 0 = 0, 1 = 256, 2 = 512 etc\n     * @param size - the size to bind at (this is blocks of 256).\n     */\n    public bindBufferRange(glBuffer: GlBuffer, index?: number, offset?: number, size?: number): void\n    {\n        const { _gl: gl } = this;\n\n        offset ||= 0;\n        index ||= 0;\n\n        this._boundBufferBases[index] = null;\n\n        gl.bindBufferRange(gl.UNIFORM_BUFFER, index || 0, glBuffer.buffer, offset * 256, size || 256);\n    }\n\n    /**\n     * Will ensure the data in the buffer is uploaded to the GPU.\n     * @param {Buffer} buffer - the buffer to update\n     */\n    public updateBuffer(buffer: Buffer): GlBuffer\n    {\n        const { _gl: gl } = this;\n\n        const glBuffer = this.getGlBuffer(buffer);\n\n        if (buffer._updateID === glBuffer.updateID)\n        {\n            return glBuffer;\n        }\n\n        glBuffer.updateID = buffer._updateID;\n\n        gl.bindBuffer(glBuffer.type, glBuffer.buffer);\n\n        const data = buffer.data;\n\n        const drawType = (buffer.descriptor.usage & BufferUsage.STATIC) ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW;\n\n        if (data)\n        {\n            if (glBuffer.byteLength >= data.byteLength)\n            {\n                // assuming our buffers are aligned to 4 bits...\n                // offset is always zero for now!\n                gl.bufferSubData(glBuffer.type, 0, data, 0, buffer._updateSize / data.BYTES_PER_ELEMENT);\n            }\n            else\n            {\n                glBuffer.byteLength = data.byteLength;\n                // assuming our buffers are aligned to 4 bits...\n                gl.bufferData(glBuffer.type, data, drawType);\n            }\n        }\n        else\n        {\n            glBuffer.byteLength = buffer.descriptor.size;\n            gl.bufferData(glBuffer.type, glBuffer.byteLength, drawType);\n        }\n\n        return glBuffer;\n    }\n\n    /** dispose all WebGL resources of all managed buffers */\n    public destroyAll(): void\n    {\n        const gl = this._gl;\n\n        for (const id in this._gpuBuffers)\n        {\n            gl.deleteBuffer(this._gpuBuffers[id].buffer);\n        }\n\n        this._gpuBuffers = Object.create(null);\n    }\n\n    /**\n     * Disposes buffer\n     * @param {Buffer} buffer - buffer with data\n     * @param {boolean} [contextLost=false] - If context was lost, we suppress deleteVertexArray\n     */\n    protected onBufferDestroy(buffer: Buffer, contextLost?: boolean): void\n    {\n        const glBuffer = this._gpuBuffers[buffer.uid];\n\n        const gl = this._gl;\n\n        if (!contextLost)\n        {\n            gl.deleteBuffer(glBuffer.buffer);\n        }\n\n        this._gpuBuffers[buffer.uid] = null;\n    }\n\n    /**\n     * creates and attaches a GLBuffer object tied to the current context.\n     * @param buffer\n     * @protected\n     */\n    protected createGLBuffer(buffer: Buffer): GlBuffer\n    {\n        const { _gl: gl } = this;\n\n        let type = BUFFER_TYPE.ARRAY_BUFFER;\n\n        if ((buffer.descriptor.usage & BufferUsage.INDEX))\n        {\n            type = BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;\n        }\n        else if ((buffer.descriptor.usage & BufferUsage.UNIFORM))\n        {\n            type = BUFFER_TYPE.UNIFORM_BUFFER;\n        }\n\n        const glBuffer = new GlBuffer(gl.createBuffer(), type);\n\n        this._gpuBuffers[buffer.uid] = glBuffer;\n\n        buffer.on('destroy', this.onBufferDestroy, this);\n\n        return glBuffer;\n    }\n\n    public resetState(): void\n    {\n        this._boundBufferBases = Object.create(null);\n    }\n}\n","import { DOMAdapter } from '../../../../environment/adapter';\nimport { ExtensionType } from '../../../../extensions/Extensions';\nimport { warn } from '../../../../utils/logging/warn';\nimport { type GpuPowerPreference } from '../../types';\n\nimport type { ICanvas } from '../../../../environment/canvas/ICanvas';\nimport type { System } from '../../shared/system/System';\nimport type { WebGLRenderer } from '../WebGLRenderer';\nimport type { WebGLExtensions } from './WebGLExtensions';\n\n/**\n * Options for the context system.\n * @category rendering\n * @advanced\n * @property {WebGL2RenderingContext | null} [context=null] - User-provided WebGL rendering context object.\n * @property {GpuPowerPreference} [powerPreference='default'] - An optional hint indicating what configuration\n * of GPU is suitable for the WebGL context, can be `'high-performance'` or `'low-power'`. Setting to `'high-performance'`\n * will prioritize rendering performance over power consumption, while setting to `'low-power'` will prioritize power saving\n * over rendering performance.\n * @property {boolean} [premultipliedAlpha=true] - Whether the compositor will assume the drawing buffer contains\n * colors with premultiplied alpha.\n * @property {boolean} [preserveDrawingBuffer=false] - Whether to enable drawing buffer preservation.\n * If enabled, the drawing buffer will preserve\n * its value until cleared or overwritten. Enable this if you need to call `toDataUrl` on the WebGL context.\n * @property {boolean} [antialias] - Whether to enable antialiasing.\n * @property {1 | 2} [preferWebGLVersion=2] - The preferred WebGL version to use.\n */\nexport interface ContextSystemOptions\n{\n    /**\n     * User-provided WebGL rendering context object.\n     * @default null\n     */\n    context: WebGL2RenderingContext | null;\n    /**\n     * An optional hint indicating what configuration of GPU is suitable for the WebGL context,\n     * can be `'high-performance'` or `'low-power'`.\n     * Setting to `'high-performance'` will prioritize rendering performance over power consumption,\n     * while setting to `'low-power'` will prioritize power saving over rendering performance.\n     * @default undefined\n     */\n    powerPreference?: GpuPowerPreference;\n\n    /**\n     * Whether the compositor will assume the drawing buffer contains colors with premultiplied alpha.\n     * @default true\n     */\n    premultipliedAlpha: boolean;\n    /**\n     * Whether to enable drawing buffer preservation. If enabled, the drawing buffer will preserve\n     * its value until cleared or overwritten. Enable this if you need to call `toDataUrl` on the WebGL context.\n     * @default false\n     */\n    preserveDrawingBuffer: boolean;\n\n    antialias?: boolean;\n\n    /**\n     * The preferred WebGL version to use.\n     * @default 2\n     */\n    preferWebGLVersion?: 1 | 2;\n\n    /**\n     * Whether to enable multi-view rendering. Set to true when rendering to multiple\n     * canvases on the dom.\n     * @default false\n     */\n    multiView: boolean;\n}\n\n/**\n * System plugin to the renderer to manage the context\n * @category rendering\n * @advanced\n */\nexport class GlContextSystem implements System<ContextSystemOptions>\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'context',\n    } as const;\n\n    /** The default options for the system. */\n    public static defaultOptions: ContextSystemOptions = {\n        /**\n         * {@link WebGLOptions.context}\n         * @default null\n         */\n        context: null,\n        /**\n         * {@link WebGLOptions.premultipliedAlpha}\n         * @default true\n         */\n        premultipliedAlpha: true,\n        /**\n         * {@link WebGLOptions.preserveDrawingBuffer}\n         * @default false\n         */\n        preserveDrawingBuffer: false,\n        /**\n         * {@link WebGLOptions.powerPreference}\n         * @default default\n         */\n        powerPreference: undefined,\n        /**\n         * {@link WebGLOptions.webGLVersion}\n         * @default 2\n         */\n        preferWebGLVersion: 2,\n        /**\n         * {@link WebGLOptions.multiView}\n         * @default false\n         */\n        multiView: false\n    };\n\n    protected CONTEXT_UID: number;\n    protected gl: WebGL2RenderingContext;\n\n    /**\n     * Features supported by current renderer.\n     * @type {object}\n     * @readonly\n     */\n    public supports = {\n        /** Support for 32-bit indices buffer. */\n        uint32Indices: true,\n        /** Support for UniformBufferObjects */\n        uniformBufferObject: true,\n        /** Support for VertexArrayObjects */\n        vertexArrayObject: true,\n        /** Support for SRGB texture format */\n        srgbTextures: true,\n        /** Support for wrapping modes if a texture is non-power of two */\n        nonPowOf2wrapping: true,\n        /** Support for MSAA (antialiasing of dynamic textures) */\n        msaa: true,\n        /** Support for mipmaps if a texture is non-power of two */\n        nonPowOf2mipmaps: true,\n    };\n\n    /**\n     * Extensions available.\n     * @type {object}\n     * @readonly\n     * @property {WEBGL_draw_buffers} drawBuffers - WebGL v1 extension\n     * @property {WEBGL_depth_texture} depthTexture - WebGL v1 extension\n     * @property {OES_texture_float} floatTexture - WebGL v1 extension\n     * @property {WEBGL_lose_context} loseContext - WebGL v1 extension\n     * @property {OES_vertex_array_object} vertexArrayObject - WebGL v1 extension\n     * @property {EXT_texture_filter_anisotropic} anisotropicFiltering - WebGL v1 and v2 extension\n     */\n    public extensions: WebGLExtensions;\n\n    public webGLVersion: 1 | 2;\n\n    /**\n     * Whether to enable multi-view rendering. Set to true when rendering to multiple\n     * canvases on the dom.\n     * @default false\n     */\n    public multiView: boolean;\n\n    /**\n     * The canvas that the WebGL Context is rendering to.\n     * This will be the view canvas. But if multiView is enabled, this canvas will not be attached to the DOM.\n     * It will be rendered to and then copied to the target canvas.\n     * @readonly\n     */\n    public canvas: ICanvas;\n\n    private _renderer: WebGLRenderer;\n    private _contextLossForced: boolean;\n\n    /** @param renderer - The renderer this System works for. */\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n\n        this.extensions = Object.create(null);\n\n        // Bind functions\n        this.handleContextLost = this.handleContextLost.bind(this);\n        this.handleContextRestored = this.handleContextRestored.bind(this);\n    }\n\n    /**\n     * `true` if the context is lost\n     * @readonly\n     */\n    get isLost(): boolean\n    {\n        return (!this.gl || this.gl.isContextLost());\n    }\n\n    /**\n     * Handles the context change event.\n     * @param {WebGLRenderingContext} gl - New WebGL context.\n     */\n    protected contextChange(gl: WebGL2RenderingContext): void\n    {\n        this.gl = gl;\n        this._renderer.gl = gl;\n    }\n\n    public init(options: ContextSystemOptions): void\n    {\n        options = { ...GlContextSystem.defaultOptions, ...options };\n\n        // TODO add to options\n        let multiView = this.multiView = options.multiView;\n\n        if (options.context && multiView)\n        {\n            // eslint-disable-next-line max-len\n            warn('Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together.');\n\n            multiView = false;\n        }\n\n        if (multiView)\n        {\n            this.canvas = DOMAdapter.get()\n                .createCanvas(this._renderer.canvas.width, this._renderer.canvas.height);\n        }\n        else\n        {\n            this.canvas = this._renderer.view.canvas;\n        }\n        /*\n         * The options passed in to create a new WebGL context.\n         */\n        if (options.context)\n        {\n            this.initFromContext(options.context);\n        }\n        else\n        {\n            const alpha = this._renderer.background.alpha < 1;\n            const premultipliedAlpha = options.premultipliedAlpha ?? true;\n            const antialias = options.antialias && !this._renderer.backBuffer.useBackBuffer;\n\n            this.createContext(options.preferWebGLVersion, {\n                alpha,\n                premultipliedAlpha,\n                antialias,\n                stencil: true,\n                preserveDrawingBuffer: options.preserveDrawingBuffer,\n                powerPreference: options.powerPreference ?? 'default',\n            });\n        }\n    }\n\n    public ensureCanvasSize(targetCanvas: ICanvas): void\n    {\n        if (!this.multiView)\n        {\n            if (targetCanvas !== this.canvas)\n            {\n                warn('multiView is disabled, but targetCanvas is not the main canvas');\n            }\n\n            return;\n        }\n\n        const { canvas } = this;\n\n        if (canvas.width < targetCanvas.width || canvas.height < targetCanvas.height)\n        {\n            canvas.width = Math.max(targetCanvas.width, targetCanvas.width);\n            canvas.height = Math.max(targetCanvas.height, targetCanvas.height);\n        }\n    }\n\n    /**\n     * Initializes the context.\n     * @protected\n     * @param {WebGLRenderingContext} gl - WebGL context\n     */\n    protected initFromContext(gl: WebGL2RenderingContext): void\n    {\n        this.gl = gl;\n\n        this.webGLVersion = gl instanceof DOMAdapter.get().getWebGLRenderingContext() ? 1 : 2;\n\n        this.getExtensions();\n\n        this.validateContext(gl);\n\n        this._renderer.runners.contextChange.emit(gl);\n\n        const element = this._renderer.view.canvas;\n\n        (element as any).addEventListener('webglcontextlost', this.handleContextLost, false);\n        element.addEventListener('webglcontextrestored', this.handleContextRestored, false);\n    }\n\n    /**\n     * Initialize from context options\n     * @protected\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/getContext\n     * @param preferWebGLVersion\n     * @param {object} options - context attributes\n     */\n    protected createContext(preferWebGLVersion: 1 | 2, options: WebGLContextAttributes): void\n    {\n        let gl: WebGL2RenderingContext | WebGLRenderingContext;\n\n        const canvas = this.canvas;\n\n        if (preferWebGLVersion === 2)\n        {\n            gl = canvas.getContext('webgl2', options);\n        }\n\n        if (!gl)\n        {\n            gl = canvas.getContext('webgl', options);\n\n            if (!gl)\n            {\n                // fail, not able to get a context\n                throw new Error('This browser does not support WebGL. Try using the canvas renderer');\n            }\n        }\n\n        this.gl = gl as WebGL2RenderingContext;\n\n        this.initFromContext(this.gl);\n    }\n\n    /** Auto-populate the {@link GlContextSystem.extensions extensions}. */\n    protected getExtensions(): void\n    {\n        // time to set up default extensions that Pixi uses.\n        const { gl } = this;\n\n        const common = {\n            anisotropicFiltering: gl.getExtension('EXT_texture_filter_anisotropic'),\n            floatTextureLinear: gl.getExtension('OES_texture_float_linear'),\n\n            s3tc: gl.getExtension('WEBGL_compressed_texture_s3tc'),\n            s3tc_sRGB: gl.getExtension('WEBGL_compressed_texture_s3tc_srgb'), // eslint-disable-line camelcase\n            etc: gl.getExtension('WEBGL_compressed_texture_etc'),\n            etc1: gl.getExtension('WEBGL_compressed_texture_etc1'),\n            pvrtc: gl.getExtension('WEBGL_compressed_texture_pvrtc')\n                || gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'),\n            atc: gl.getExtension('WEBGL_compressed_texture_atc'),\n            astc: gl.getExtension('WEBGL_compressed_texture_astc'),\n            bptc: gl.getExtension('EXT_texture_compression_bptc'),\n            rgtc: gl.getExtension('EXT_texture_compression_rgtc'),\n            loseContext: gl.getExtension('WEBGL_lose_context'),\n        };\n\n        if (this.webGLVersion === 1)\n        {\n            this.extensions = {\n                ...common,\n\n                drawBuffers: gl.getExtension('WEBGL_draw_buffers'),\n                depthTexture: gl.getExtension('WEBGL_depth_texture'),\n                vertexArrayObject: gl.getExtension('OES_vertex_array_object')\n                    || gl.getExtension('MOZ_OES_vertex_array_object')\n                    || gl.getExtension('WEBKIT_OES_vertex_array_object'),\n                uint32ElementIndex: gl.getExtension('OES_element_index_uint'),\n                // Floats and half-floats\n                floatTexture: gl.getExtension('OES_texture_float'),\n                floatTextureLinear: gl.getExtension('OES_texture_float_linear'),\n                textureHalfFloat: gl.getExtension('OES_texture_half_float'),\n                textureHalfFloatLinear: gl.getExtension('OES_texture_half_float_linear'),\n                vertexAttribDivisorANGLE: gl.getExtension('ANGLE_instanced_arrays'),\n                srgb: gl.getExtension('EXT_sRGB'),\n            };\n        }\n        else\n        {\n            this.extensions = {\n                ...common,\n                colorBufferFloat: gl.getExtension('EXT_color_buffer_float'),\n            };\n\n            const provokeExt = gl.getExtension('WEBGL_provoking_vertex');\n\n            if (provokeExt)\n            {\n                provokeExt.provokingVertexWEBGL(provokeExt.FIRST_VERTEX_CONVENTION_WEBGL);\n            }\n        }\n    }\n\n    /**\n     * Handles a lost webgl context\n     * @param {WebGLContextEvent} event - The context lost event.\n     */\n    protected handleContextLost(event: WebGLContextEvent): void\n    {\n        event.preventDefault();\n\n        // only restore if we purposefully nuked it\n        if (this._contextLossForced)\n        {\n            this._contextLossForced = false;\n            // Restore the context after this event has exited\n            setTimeout(() =>\n            {\n                if (this.gl.isContextLost())\n                {\n                    this.extensions.loseContext?.restoreContext();\n                }\n            }, 0);\n        }\n    }\n\n    /** Handles a restored webgl context. */\n    protected handleContextRestored(): void\n    {\n        this.getExtensions(); // restore extensions state\n        this._renderer.runners.contextChange.emit(this.gl);\n    }\n\n    public destroy(): void\n    {\n        const element = this._renderer.view.canvas;\n\n        this._renderer = null;\n\n        // remove listeners\n        (element as any).removeEventListener('webglcontextlost', this.handleContextLost);\n        element.removeEventListener('webglcontextrestored', this.handleContextRestored);\n\n        this.gl.useProgram(null);\n\n        this.extensions.loseContext?.loseContext();\n    }\n\n    /**\n     * this function can be called to force a webGL context loss\n     * this will release all resources on the GPU.\n     * Useful if you need to put Pixi to sleep, and save some GPU memory\n     *\n     * As soon as render is called - all resources will be created again.\n     */\n    public forceContextLoss(): void\n    {\n        this.extensions.loseContext?.loseContext();\n        this._contextLossForced = true;\n    }\n    /**\n     * Validate context.\n     * @param {WebGLRenderingContext} gl - Render context.\n     */\n    protected validateContext(gl: WebGL2RenderingContext): void\n    {\n        const attributes = gl.getContextAttributes();\n\n        // this is going to be fairly simple for now.. but at least we have room to grow!\n        if (attributes && !attributes.stencil)\n        {\n            // #if _DEBUG\n            warn('Provided WebGL context does not have a stencil buffer, masks may not render correctly');\n            // #endif\n        }\n\n        // support\n        const supports = this.supports;\n\n        const isWebGl2 = this.webGLVersion === 2;\n        const extensions = this.extensions;\n\n        supports.uint32Indices = isWebGl2 || !!extensions.uint32ElementIndex;\n        supports.uniformBufferObject = isWebGl2;\n        supports.vertexArrayObject = isWebGl2 || !!extensions.vertexArrayObject;\n        supports.srgbTextures = isWebGl2 || !!extensions.srgb;\n        supports.nonPowOf2wrapping = isWebGl2;\n        supports.nonPowOf2mipmaps = isWebGl2;\n        supports.msaa = isWebGl2;\n\n        if (!supports.uint32Indices)\n        {\n            // #if _DEBUG\n            warn('Provided WebGL context does not support 32 index buffer, large scenes may not render correctly');\n            // #endif\n        }\n    }\n}\n","/**\n * Various GL texture/resources formats.\n * @category rendering\n * @advanced\n */\nexport enum GL_FORMATS\n{\n    RGBA = 6408,\n    RGB = 6407,\n    RG = 33319,\n    RED = 6403,\n    RGBA_INTEGER = 36249,\n    RGB_INTEGER = 36248,\n    RG_INTEGER = 33320,\n    RED_INTEGER = 36244,\n    ALPHA = 6406,\n    LUMINANCE = 6409,\n    LUMINANCE_ALPHA = 6410,\n    DEPTH_COMPONENT = 6402,\n    DEPTH_STENCIL = 34041,\n}\n\n/**\n * Various GL target types.\n * @category rendering\n * @advanced\n */\nexport enum GL_TARGETS\n{\n    TEXTURE_2D = 3553,\n    TEXTURE_CUBE_MAP = 34067,\n    TEXTURE_2D_ARRAY = 35866,\n    TEXTURE_CUBE_MAP_POSITIVE_X = 34069,\n    TEXTURE_CUBE_MAP_NEGATIVE_X = 34070,\n    TEXTURE_CUBE_MAP_POSITIVE_Y = 34071,\n    TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072,\n    TEXTURE_CUBE_MAP_POSITIVE_Z = 34073,\n    TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074,\n}\n\n/**\n * The wrap modes that are supported by pixi.\n *\n * The {@link WRAP_MODE} wrap mode affects the default wrapping mode of future operations.\n * It can be re-assigned to either CLAMP or REPEAT, depending upon suitability.\n * If the texture is non power of two then clamp will be used regardless as WebGL can\n * only use REPEAT if the texture is po2.\n *\n * This property only affects WebGL.\n * @category rendering\n * @advanced\n */\nexport enum GL_WRAP_MODES\n{\n    /**\n     * The textures uvs are clamped\n     * @default 33071\n     */\n    CLAMP = 33071,\n    /**\n     * The texture uvs tile and repeat\n     * @default 10497\n     */\n    REPEAT = 10497,\n    /**\n     * The texture uvs tile and repeat with mirroring\n     * @default 33648\n     */\n    MIRRORED_REPEAT = 33648,\n}\n\n/** @internal */\nexport enum GL_TYPES\n{\n    /**\n     * 8 bits per channel for gl.RGBA\n     * @default 5121\n     */\n    UNSIGNED_BYTE = 5121,\n    /** @default 5123 */\n    UNSIGNED_SHORT = 5123,\n    /**\n     * 5 red bits, 6 green bits, 5 blue bits.\n     * @default 33635\n     */\n    UNSIGNED_SHORT_5_6_5 = 33635,\n    /**\n     * 4 red bits, 4 green bits, 4 blue bits, 4 alpha bits.\n     * @default 32819\n     */\n    UNSIGNED_SHORT_4_4_4_4 = 32819,\n    /**\n     * 5 red bits, 5 green bits, 5 blue bits, 1 alpha bit.\n     * @default 32820\n     */\n    UNSIGNED_SHORT_5_5_5_1 = 32820,\n    /** @default 5125 */\n    UNSIGNED_INT = 5125,\n    /** @default 35899 */\n    UNSIGNED_INT_10F_11F_11F_REV = 35899,\n    /** @default 33640 */\n    UNSIGNED_INT_2_10_10_10_REV = 33640,\n    /** @default 34042 */\n    UNSIGNED_INT_24_8 = 34042,\n    /** @default 35902 */\n    UNSIGNED_INT_5_9_9_9_REV = 35902,\n    /** @default 5120 */\n    BYTE = 5120,\n    /** @default 5122 */\n    SHORT = 5122,\n    /** @default 5124 */\n    INT = 5124,\n    /** @default 5126 */\n    FLOAT = 5126,\n    /** @default 36269 */\n    FLOAT_32_UNSIGNED_INT_24_8_REV = 36269,\n    /** @default 36193 */\n    HALF_FLOAT = 36193,\n}\n\n","import { GL_TYPES } from '../../texture/const';\n\nimport type { VertexFormat } from '../../../shared/geometry/const';\n\nconst infoMap = {\n    uint8x2: GL_TYPES.UNSIGNED_BYTE,\n    uint8x4: GL_TYPES.UNSIGNED_BYTE,\n    sint8x2: GL_TYPES.BYTE,\n    sint8x4: GL_TYPES.BYTE,\n    unorm8x2: GL_TYPES.UNSIGNED_BYTE,\n    unorm8x4: GL_TYPES.UNSIGNED_BYTE,\n    snorm8x2: GL_TYPES.BYTE,\n    snorm8x4: GL_TYPES.BYTE,\n    uint16x2: GL_TYPES.UNSIGNED_SHORT,\n    uint16x4: GL_TYPES.UNSIGNED_SHORT,\n    sint16x2: GL_TYPES.SHORT,\n    sint16x4: GL_TYPES.SHORT,\n    unorm16x2: GL_TYPES.UNSIGNED_SHORT,\n    unorm16x4: GL_TYPES.UNSIGNED_SHORT,\n    snorm16x2: GL_TYPES.SHORT,\n    snorm16x4: GL_TYPES.SHORT,\n    float16x2: GL_TYPES.HALF_FLOAT,\n    float16x4: GL_TYPES.HALF_FLOAT,\n    float32: GL_TYPES.FLOAT,\n    float32x2: GL_TYPES.FLOAT,\n    float32x3: GL_TYPES.FLOAT,\n    float32x4: GL_TYPES.FLOAT,\n    uint32: GL_TYPES.UNSIGNED_INT,\n    uint32x2: GL_TYPES.UNSIGNED_INT,\n    uint32x3: GL_TYPES.UNSIGNED_INT,\n    uint32x4: GL_TYPES.UNSIGNED_INT,\n    sint32: GL_TYPES.INT,\n    sint32x2: GL_TYPES.INT,\n    sint32x3: GL_TYPES.INT,\n    sint32x4: GL_TYPES.INT\n};\n\n/**\n * @param format\n * @internal\n */\nexport function getGlTypeFromFormat(format: VertexFormat): number\n{\n    return infoMap[format] ?? infoMap.float32;\n}\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { getAttributeInfoFromFormat } from '../../shared/geometry/utils/getAttributeInfoFromFormat';\nimport { ensureAttributes } from '../shader/program/ensureAttributes';\nimport { getGlTypeFromFormat } from './utils/getGlTypeFromFormat';\n\nimport type { Topology } from '../../shared/geometry/const';\nimport type { Geometry } from '../../shared/geometry/Geometry';\nimport type { System } from '../../shared/system/System';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\nimport type { GlProgram } from '../shader/GlProgram';\nimport type { WebGLRenderer } from '../WebGLRenderer';\n\nconst topologyToGlMap = {\n    'point-list': 0x0000,\n    'line-list': 0x0001,\n    'line-strip': 0x0003,\n    'triangle-list': 0x0004,\n    'triangle-strip': 0x0005\n};\n\n/**\n * System plugin to the renderer to manage geometry.\n * @category rendering\n * @advanced\n */\nexport class GlGeometrySystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'geometry',\n    } as const;\n\n    /**\n     * `true` if we has `*_vertex_array_object` extension.\n     * @readonly\n     */\n    public hasVao: boolean;\n\n    /**\n     * `true` if has `ANGLE_instanced_arrays` extension.\n     * @readonly\n     */\n    public hasInstance: boolean;\n\n    protected gl: GlRenderingContext;\n    protected _activeGeometry: Geometry;\n    protected _activeVao: WebGLVertexArrayObject;\n\n    protected _geometryVaoHash: Record<number, Record<string, WebGLVertexArrayObject>> = Object.create(null);\n\n    /** Renderer that owns this {@link GeometrySystem}. */\n    private _renderer: WebGLRenderer;\n\n    /** @param renderer - The renderer this System works for. */\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n        this._activeGeometry = null;\n        this._activeVao = null;\n\n        this.hasVao = true;\n        this.hasInstance = true;\n\n        this._renderer.renderableGC.addManagedHash(this, '_geometryVaoHash');\n    }\n\n    /** Sets up the renderer context and necessary buffers. */\n    protected contextChange(): void\n    {\n        const gl = this.gl = this._renderer.gl;\n\n        if (!this._renderer.context.supports.vertexArrayObject)\n        {\n            throw new Error('[PixiJS] Vertex Array Objects are not supported on this device');\n        }\n\n        const nativeVaoExtension = this._renderer.context.extensions.vertexArrayObject;\n\n        if (nativeVaoExtension)\n        {\n            gl.createVertexArray = (): WebGLVertexArrayObject =>\n                nativeVaoExtension.createVertexArrayOES();\n\n            gl.bindVertexArray = (vao): void =>\n                nativeVaoExtension.bindVertexArrayOES(vao);\n\n            gl.deleteVertexArray = (vao): void =>\n                nativeVaoExtension.deleteVertexArrayOES(vao);\n        }\n\n        const nativeInstancedExtension = this._renderer.context.extensions.vertexAttribDivisorANGLE;\n\n        if (nativeInstancedExtension)\n        {\n            gl.drawArraysInstanced = (a, b, c, d): void =>\n            {\n                nativeInstancedExtension.drawArraysInstancedANGLE(a, b, c, d);\n            };\n\n            gl.drawElementsInstanced = (a, b, c, d, e): void =>\n            {\n                nativeInstancedExtension.drawElementsInstancedANGLE(a, b, c, d, e);\n            };\n\n            gl.vertexAttribDivisor = (a, b): void =>\n                nativeInstancedExtension.vertexAttribDivisorANGLE(a, b);\n        }\n\n        this._activeGeometry = null;\n        this._activeVao = null;\n        this._geometryVaoHash = Object.create(null);\n    }\n\n    /**\n     * Binds geometry so that is can be drawn. Creating a Vao if required\n     * @param geometry - Instance of geometry to bind.\n     * @param program - Instance of program to use vao for.\n     */\n    public bind(geometry?: Geometry, program?: GlProgram): void\n    {\n        // shader ||= this.renderer.shader.shader;\n\n        const gl = this.gl;\n\n        this._activeGeometry = geometry;\n\n        const vao = this.getVao(geometry, program);\n\n        if (this._activeVao !== vao)\n        {\n            this._activeVao = vao;\n\n            gl.bindVertexArray(vao);\n        }\n\n        this.updateBuffers();\n    }\n\n    /** Reset and unbind any active VAO and geometry. */\n    public resetState(): void\n    {\n        this.unbind();\n    }\n\n    /** Update buffers of the currently bound geometry. */\n    public updateBuffers(): void\n    {\n        const geometry = this._activeGeometry;\n\n        const bufferSystem = this._renderer.buffer;\n\n        for (let i = 0; i < geometry.buffers.length; i++)\n        {\n            const buffer = geometry.buffers[i];\n\n            bufferSystem.updateBuffer(buffer);\n        }\n    }\n\n    /**\n     * Check compatibility between a geometry and a program\n     * @param geometry - Geometry instance.\n     * @param program - Program instance.\n     */\n    protected checkCompatibility(geometry: Geometry, program: GlProgram): void\n    {\n        // geometry must have at least all the attributes that the shader requires.\n        const geometryAttributes = geometry.attributes;\n        const shaderAttributes = program._attributeData;\n\n        for (const j in shaderAttributes)\n        {\n            if (!geometryAttributes[j])\n            {\n                throw new Error(`shader and geometry incompatible, geometry missing the \"${j}\" attribute`);\n            }\n        }\n    }\n\n    /**\n     * Takes a geometry and program and generates a unique signature for them.\n     * @param geometry - To get signature from.\n     * @param program - To test geometry against.\n     * @returns - Unique signature of the geometry and program\n     */\n    protected getSignature(geometry: Geometry, program: GlProgram): string\n    {\n        const attribs = geometry.attributes;\n        const shaderAttributes = program._attributeData;\n\n        const strings = ['g', geometry.uid];\n\n        for (const i in attribs)\n        {\n            if (shaderAttributes[i])\n            {\n                strings.push(i, shaderAttributes[i].location);\n            }\n        }\n\n        return strings.join('-');\n    }\n\n    protected getVao(geometry: Geometry, program: GlProgram): WebGLVertexArrayObject\n    {\n        return this._geometryVaoHash[geometry.uid]?.[program._key] || this.initGeometryVao(geometry, program);\n    }\n\n    /**\n     * Creates or gets Vao with the same structure as the geometry and stores it on the geometry.\n     * If vao is created, it is bound automatically. We use a shader to infer what and how to set up the\n     * attribute locations.\n     * @param geometry - Instance of geometry to to generate Vao for.\n     * @param program\n     * @param _incRefCount - Increment refCount of all geometry buffers.\n     */\n    protected initGeometryVao(geometry: Geometry, program: GlProgram, _incRefCount = true): WebGLVertexArrayObject\n    {\n        const gl = this._renderer.gl;\n        // const CONTEXT_UID = this.CONTEXT_UID;\n        const bufferSystem = this._renderer.buffer;\n\n        this._renderer.shader._getProgramData(program);\n\n        this.checkCompatibility(geometry, program);\n\n        const signature = this.getSignature(geometry, program);\n\n        if (!this._geometryVaoHash[geometry.uid])\n        {\n            this._geometryVaoHash[geometry.uid] = Object.create(null);\n\n            geometry.on('destroy', this.onGeometryDestroy, this);\n        }\n\n        const vaoObjectHash = this._geometryVaoHash[geometry.uid];\n\n        let vao = vaoObjectHash[signature];\n\n        if (vao)\n        {\n            // this will give us easy access to the vao\n            vaoObjectHash[program._key] = vao;\n\n            return vao;\n        }\n\n        ensureAttributes(geometry, program._attributeData);\n\n        const buffers = geometry.buffers;\n\n        // @TODO: We don't know if VAO is supported.\n        vao = gl.createVertexArray();\n\n        gl.bindVertexArray(vao);\n\n        // first update - and create the buffers!\n        // only create a gl buffer if it actually gets\n        for (let i = 0; i < buffers.length; i++)\n        {\n            const buffer = buffers[i];\n\n            bufferSystem.bind(buffer);\n        }\n\n        // TODO - maybe make this a data object?\n        // lets wait to see if we need to first!\n\n        this.activateVao(geometry, program);\n\n        // add it to the cache!\n        vaoObjectHash[program._key] = vao;\n        vaoObjectHash[signature] = vao;\n\n        gl.bindVertexArray(null);\n\n        return vao;\n    }\n\n    /**\n     * Disposes geometry.\n     * @param geometry - Geometry with buffers. Only VAO will be disposed\n     * @param [contextLost=false] - If context was lost, we suppress deleteVertexArray\n     */\n    protected onGeometryDestroy(geometry: Geometry, contextLost?: boolean): void\n    {\n        const vaoObjectHash = this._geometryVaoHash[geometry.uid];\n\n        const gl = this.gl;\n\n        if (vaoObjectHash)\n        {\n            if (contextLost)\n            {\n                for (const i in vaoObjectHash)\n                {\n                    if (this._activeVao !== vaoObjectHash[i])\n                    {\n                        this.unbind();\n                    }\n\n                    gl.deleteVertexArray(vaoObjectHash[i]);\n                }\n            }\n\n            this._geometryVaoHash[geometry.uid] = null;\n        }\n    }\n\n    /**\n     * Dispose all WebGL resources of all managed geometries.\n     * @param [contextLost=false] - If context was lost, we suppress `gl.delete` calls\n     */\n    public destroyAll(contextLost = false): void\n    {\n        const gl = this.gl;\n\n        for (const i in this._geometryVaoHash)\n        {\n            if (contextLost)\n            {\n                for (const j in this._geometryVaoHash[i])\n                {\n                    const vaoObjectHash = this._geometryVaoHash[i];\n\n                    if (this._activeVao !== vaoObjectHash)\n                    {\n                        this.unbind();\n                    }\n\n                    gl.deleteVertexArray(vaoObjectHash[j]);\n                }\n            }\n\n            this._geometryVaoHash[i] = null;\n        }\n    }\n\n    /**\n     * Activate vertex array object.\n     * @param geometry - Geometry instance.\n     * @param program - Shader program instance.\n     */\n    protected activateVao(geometry: Geometry, program: GlProgram): void\n    {\n        const gl = this._renderer.gl;\n\n        const bufferSystem = this._renderer.buffer;\n        const attributes = geometry.attributes;\n\n        if (geometry.indexBuffer)\n        {\n            // first update the index buffer if we have one..\n            bufferSystem.bind(geometry.indexBuffer);\n        }\n\n        let lastBuffer = null;\n\n        // add a new one!\n        for (const j in attributes)\n        {\n            const attribute = attributes[j];\n            const buffer = attribute.buffer;\n            const glBuffer = bufferSystem.getGlBuffer(buffer);\n            const programAttrib = program._attributeData[j];\n\n            if (programAttrib)\n            {\n                if (lastBuffer !== glBuffer)\n                {\n                    bufferSystem.bind(buffer);\n\n                    lastBuffer = glBuffer;\n                }\n\n                const location = programAttrib.location;\n\n                // TODO introduce state again\n                // we can optimise this for older devices that have no VAOs\n                gl.enableVertexAttribArray(location);\n\n                const attributeInfo = getAttributeInfoFromFormat(attribute.format);\n\n                const type = getGlTypeFromFormat(attribute.format);\n\n                if (programAttrib.format?.substring(1, 4) === 'int')\n                {\n                    gl.vertexAttribIPointer(location,\n                        attributeInfo.size,\n                        type,\n                        attribute.stride,\n                        attribute.offset);\n                }\n                else\n                {\n                    gl.vertexAttribPointer(location,\n                        attributeInfo.size,\n                        type,\n                        attributeInfo.normalised,\n                        attribute.stride,\n                        attribute.offset);\n                }\n\n                if (attribute.instance)\n                {\n                    // TODO calculate instance count based of this...\n                    if (this.hasInstance)\n                    {\n                        // Can't use truthiness check to determine if divisor is set,\n                        // since 0 is a valid value for divisor\n                        const divisor = attribute.divisor ?? 1;\n\n                        gl.vertexAttribDivisor(location, divisor);\n                    }\n                    else\n                    {\n                        throw new Error('geometry error, GPU Instancing is not supported on this device');\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Draws the currently bound geometry.\n     * @param topology - The type primitive to render.\n     * @param size - The number of elements to be rendered. If not specified, all vertices after the\n     *  starting vertex will be drawn.\n     * @param start - The starting vertex in the geometry to start drawing from. If not specified,\n     *  drawing will start from the first vertex.\n     * @param instanceCount - The number of instances of the set of elements to execute. If not specified,\n     *  all instances will be drawn.\n     * @returns This instance of the geometry system.\n     */\n    public draw(topology?: Topology, size?: number, start?: number, instanceCount?: number): this\n    {\n        const { gl } = this._renderer;\n        const geometry = this._activeGeometry;\n\n        const glTopology = topologyToGlMap[topology || geometry.topology];\n\n        instanceCount ??= geometry.instanceCount;\n\n        if (geometry.indexBuffer)\n        {\n            const byteSize = geometry.indexBuffer.data.BYTES_PER_ELEMENT;\n            const glType = byteSize === 2 ? gl.UNSIGNED_SHORT : gl.UNSIGNED_INT;\n\n            if (instanceCount > 1)\n            {\n                /* eslint-disable max-len */\n                gl.drawElementsInstanced(glTopology, size || geometry.indexBuffer.data.length, glType, (start || 0) * byteSize, instanceCount);\n                /* eslint-enable max-len */\n            }\n            else\n            {\n                gl.drawElements(glTopology, size || geometry.indexBuffer.data.length, glType, (start || 0) * byteSize);\n            }\n        }\n        else if (instanceCount > 1)\n        {\n            // TODO need a better way to calculate size..\n            gl.drawArraysInstanced(glTopology, start || 0, size || geometry.getSize(), instanceCount);\n        }\n        else\n        {\n            gl.drawArrays(glTopology, start || 0, size || geometry.getSize());\n        }\n\n        return this;\n    }\n\n    /** Unbind/reset everything. */\n    protected unbind(): void\n    {\n        this.gl.bindVertexArray(null);\n        this._activeVao = null;\n        this._activeGeometry = null;\n    }\n\n    public destroy(): void\n    {\n        this._renderer = null;\n        this.gl = null;\n        this._activeVao = null;\n        this._activeGeometry = null;\n        this._geometryVaoHash = null;\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { warn } from '../../../utils/logging/warn';\nimport { Geometry } from '../shared/geometry/Geometry';\nimport { Shader } from '../shared/shader/Shader';\nimport { State } from '../shared/state/State';\nimport { TextureSource } from '../shared/texture/sources/TextureSource';\nimport { Texture } from '../shared/texture/Texture';\nimport { GlProgram } from './shader/GlProgram';\n\nimport type { RenderOptions } from '../shared/system/AbstractRenderer';\nimport type { System } from '../shared/system/System';\nimport type { WebGLRenderer } from './WebGLRenderer';\n\nconst bigTriangleGeometry = new Geometry({\n    attributes: {\n        aPosition: [\n            -1.0, -1.0, // Bottom left corner\n            3.0, -1.0, // Bottom right corner, extending beyond right edge\n            -1.0, 3.0 // Top left corner, extending beyond top edge\n        ],\n    },\n});\n\n/**\n * The options for the back buffer system.\n * @category rendering\n * @property {boolean} [useBackBuffer=false] - if true will use the back buffer where required\n * @property {boolean} [antialias=false] - if true will ensure the texture is antialiased\n * @advanced\n */\nexport interface GlBackBufferOptions\n{\n    /**\n     * if true will use the back buffer where required\n     * @default false\n     */\n    useBackBuffer?: boolean;\n    /** if true will ensure the texture is antialiased */\n    antialias?: boolean;\n}\n\n/**\n * For blend modes you need to know what pixels you are actually drawing to. For this to be possible in WebGL\n * we need to render to a texture and then present that texture to the screen. This system manages that process.\n *\n * As the main scene is rendered to a texture, it means we can sample it and copy its pixels,\n * something not possible on the main canvas.\n *\n * If antialiasing is set to to true and useBackBuffer is set to true, then the back buffer will be antialiased.\n * and the main gl context will not.\n *\n * You only need to activate this back buffer if you are using a blend mode that requires it.\n *\n * to activate is simple, you pass `useBackBuffer:true` to your render options\n * @category rendering\n * @advanced\n */\nexport class GlBackBufferSystem implements System<GlBackBufferOptions>\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'backBuffer',\n        priority: 1\n    } as const;\n\n    /** default options for the back buffer system */\n    public static defaultOptions: GlBackBufferOptions = {\n        /** if true will use the back buffer where required */\n        useBackBuffer: false,\n    };\n\n    /** if true, the back buffer is used */\n    public useBackBuffer = false;\n\n    private _backBufferTexture: Texture;\n    private readonly _renderer: WebGLRenderer;\n    private _targetTexture: TextureSource;\n    private _useBackBufferThisRender = false;\n    private _antialias: boolean;\n    private _state: State;\n    private _bigTriangleShader: Shader;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n    }\n\n    public init(options: GlBackBufferOptions = {})\n    {\n        const { useBackBuffer, antialias } = { ...GlBackBufferSystem.defaultOptions, ...options };\n\n        this.useBackBuffer = useBackBuffer;\n\n        this._antialias = antialias;\n\n        if (!this._renderer.context.supports.msaa)\n        {\n            warn('antialiasing, is not supported on when using the back buffer');\n\n            this._antialias = false;\n        }\n\n        this._state = State.for2d();\n\n        const bigTriangleProgram = new GlProgram({\n            vertex: `\n                attribute vec2 aPosition;\n                out vec2 vUv;\n\n                void main() {\n                    gl_Position = vec4(aPosition, 0.0, 1.0);\n\n                    vUv = (aPosition + 1.0) / 2.0;\n\n                    // flip dem UVs\n                    vUv.y = 1.0 - vUv.y;\n                }`,\n            fragment: `\n                in vec2 vUv;\n                out vec4 finalColor;\n\n                uniform sampler2D uTexture;\n\n                void main() {\n                    finalColor = texture(uTexture, vUv);\n                }`,\n            name: 'big-triangle',\n        });\n\n        this._bigTriangleShader = new Shader({\n            glProgram: bigTriangleProgram,\n            resources: {\n                uTexture: Texture.WHITE.source,\n            },\n        });\n    }\n\n    /**\n     * This is called before the RenderTargetSystem is started. This is where\n     * we replace the target with the back buffer if required.\n     * @param options - The options for this render.\n     */\n    protected renderStart(options: RenderOptions)\n    {\n        const renderTarget = this._renderer.renderTarget.getRenderTarget(options.target);\n\n        this._useBackBufferThisRender = this.useBackBuffer && !!renderTarget.isRoot;\n\n        if (this._useBackBufferThisRender)\n        {\n            const renderTarget = this._renderer.renderTarget.getRenderTarget(options.target);\n\n            this._targetTexture = renderTarget.colorTexture;\n\n            options.target = this._getBackBufferTexture(renderTarget.colorTexture);\n        }\n    }\n\n    protected renderEnd()\n    {\n        this._presentBackBuffer();\n    }\n\n    private _presentBackBuffer()\n    {\n        const renderer = this._renderer;\n\n        renderer.renderTarget.finishRenderPass();\n\n        if (!this._useBackBufferThisRender) return;\n\n        renderer.renderTarget.bind(this._targetTexture, false);\n\n        this._bigTriangleShader.resources.uTexture = this._backBufferTexture.source;\n\n        renderer.encoder.draw({\n            geometry: bigTriangleGeometry,\n            shader: this._bigTriangleShader,\n            state: this._state,\n        });\n    }\n\n    private _getBackBufferTexture(targetSourceTexture: TextureSource)\n    {\n        this._backBufferTexture = this._backBufferTexture || new Texture({\n            source: new TextureSource({\n                width: targetSourceTexture.width,\n                height: targetSourceTexture.height,\n                resolution: targetSourceTexture._resolution,\n                antialias: this._antialias,\n            }),\n        });\n\n        // this will not resize if its the same size already! No extra check required\n        this._backBufferTexture.source.resize(\n            targetSourceTexture.width,\n            targetSourceTexture.height,\n            targetSourceTexture._resolution,\n        );\n\n        return this._backBufferTexture;\n    }\n\n    /** destroys the back buffer */\n    public destroy()\n    {\n        if (this._backBufferTexture)\n        {\n            this._backBufferTexture.destroy();\n            this._backBufferTexture = null;\n        }\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\n\nimport type { System } from '../shared/system/System';\nimport type { WebGLRenderer } from './WebGLRenderer';\n\n/**\n * The system that handles color masking for the WebGL.\n * @category rendering\n * @advanced\n */\nexport class GlColorMaskSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'colorMask',\n    } as const;\n\n    private readonly _renderer: WebGLRenderer;\n    private _colorMaskCache = 0b1111;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n    }\n\n    public setMask(colorMask: number)\n    {\n        if (this._colorMaskCache === colorMask) return;\n        this._colorMaskCache = colorMask;\n\n        this._renderer.gl.colorMask(\n            !!(colorMask & 0b1000),\n            !!(colorMask & 0b0100),\n            !!(colorMask & 0b0010),\n            !!(colorMask & 0b0001)\n        );\n    }\n\n    public destroy?: () => void;\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\n\nimport type { Topology } from '../shared/geometry/const';\nimport type { Geometry } from '../shared/geometry/Geometry';\nimport type { Shader } from '../shared/shader/Shader';\nimport type { State } from '../shared/state/State';\nimport type { System } from '../shared/system/System';\nimport type { WebGLRenderer } from './WebGLRenderer';\n\n/**\n * The system that handles encoding commands for the WebGL.\n * @category rendering\n * @advanced\n */\nexport class GlEncoderSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'encoder',\n    } as const;\n\n    public readonly commandFinished = Promise.resolve();\n    private readonly _renderer: WebGLRenderer;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n    }\n\n    public setGeometry(geometry: Geometry, shader?: Shader)\n    {\n        this._renderer.geometry.bind(geometry, shader.glProgram);\n    }\n\n    public finishRenderPass()\n    {\n        // noop\n    }\n\n    public draw(options: {\n        geometry: Geometry,\n        shader: Shader,\n        state?: State,\n        topology?: Topology,\n        size?: number,\n        start?: number,\n        instanceCount?: number\n        skipSync?: boolean,\n    })\n    {\n        const renderer = this._renderer;\n        const { geometry, shader, state, skipSync, topology: type, size, start, instanceCount } = options;\n\n        renderer.shader.bind(shader, skipSync);\n\n        renderer.geometry.bind(geometry, renderer.shader._activeProgram);\n\n        if (state)\n        {\n            renderer.state.set(state);\n        }\n\n        renderer.geometry.draw(type, size, start, instanceCount ?? geometry.instanceCount);\n    }\n\n    public destroy()\n    {\n        (this._renderer as null) = null;\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { checkMaxIfStatementsInShader } from '../../batcher/gl/utils/checkMaxIfStatementsInShader';\nimport { type System } from '../shared/system/System';\n\nimport type { WebGLRenderer } from './WebGLRenderer';\n/**\n * The GpuLimitsSystem provides information about the capabilities and limitations of the underlying GPU.\n * These limits, such as the maximum number of textures that can be used in a shader\n * (`maxTextures`) or the maximum number of textures that can be batched together (`maxBatchableTextures`),\n * are determined by the specific graphics hardware and driver.\n *\n * The values for these limits are not available immediately upon instantiation of the class.\n * They are populated when the GL rendering context is successfully initialized and ready,\n * which occurs after the `renderer.init()` method has completed.\n * Attempting to access these properties before the context is ready will result in undefined or default values.\n *\n * This system allows the renderer to adapt its behavior and resource allocation strategies\n * to stay within the supported boundaries of the GPU, ensuring optimal performance and stability.\n * @example\n * ```ts\n * const renderer = new WebGlRenderer();\n * await renderer.init();\n *\n * console.log(renderer.limits.maxTextures);\n * ```\n * @category rendering\n * @advanced\n */\nexport class GlLimitsSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'limits',\n    } as const;\n\n    /** The maximum number of textures that can be used by a shader */\n    public maxTextures: number;\n    /** The maximum number of batchable textures */\n    public maxBatchableTextures: number;\n\n    /** The maximum number of uniform bindings */\n    public maxUniformBindings: number;\n\n    private readonly _renderer: WebGLRenderer;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n    }\n\n    public contextChange(): void\n    {\n        const gl = this._renderer.gl;\n\n        // step 1: first check max textures the GPU can handle.\n        this.maxTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n\n        // step 2: check the maximum number of if statements the shader can have too..\n        this.maxBatchableTextures = checkMaxIfStatementsInShader(this.maxTextures, gl);\n\n        // step 3: check the limit of uniform buffer bindings.\n        // UBs are available only in WebGL2 context, requesting within WebGL1 produces a warning.\n        const isWebGl2 = this._renderer.context.webGLVersion === 2;\n\n        this.maxUniformBindings = isWebGl2\n            ? gl.getParameter(gl.MAX_UNIFORM_BUFFER_BINDINGS)\n            : 0;\n    }\n\n    public destroy(): void\n    {\n        // boom!\n    }\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { GpuStencilModesToPixi } from '../gpu/state/GpuStencilModesToPixi';\nimport { STENCIL_MODES } from '../shared/state/const';\n\nimport type { RenderTarget } from '../shared/renderTarget/RenderTarget';\nimport type { System } from '../shared/system/System';\nimport type { WebGLRenderer } from './WebGLRenderer';\n\n/**\n * This manages the stencil buffer. Used primarily for masking\n * @category rendering\n * @advanced\n */\nexport class GlStencilSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'stencil',\n    } as const;\n\n    private _gl: WebGLRenderingContext;\n\n    private readonly _stencilCache = {\n        enabled: false,\n        stencilReference: 0,\n        stencilMode: STENCIL_MODES.NONE,\n    };\n\n    private _renderTargetStencilState: Record<number, {\n        stencilMode: STENCIL_MODES;\n        stencilReference: number;\n    }> = Object.create(null);\n\n    private _stencilOpsMapping: {\n        keep: number;\n        zero: number;\n        replace: number;\n        invert: number;\n        'increment-clamp': number;\n        'decrement-clamp': number;\n        'increment-wrap': number;\n        'decrement-wrap': number;\n    };\n\n    private _comparisonFuncMapping: {\n        always: number;\n        never: number;\n        equal: number;\n        'not-equal': number;\n        less: number;\n        'less-equal': number;\n        greater: number;\n        'greater-equal': number;\n    };\n\n    private _activeRenderTarget: RenderTarget;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        renderer.renderTarget.onRenderTargetChange.add(this);\n    }\n\n    protected contextChange(gl: WebGLRenderingContext)\n    {\n        // TODO - this could be declared in a gl const\n        // we know the numbers don't tend to change!\n        this._gl = gl;\n\n        this._comparisonFuncMapping = {\n            always: gl.ALWAYS,\n            never: gl.NEVER,\n            equal: gl.EQUAL,\n            'not-equal': gl.NOTEQUAL,\n            less: gl.LESS,\n            'less-equal': gl.LEQUAL,\n            greater: gl.GREATER,\n            'greater-equal': gl.GEQUAL,\n        };\n\n        this._stencilOpsMapping = {\n            keep: gl.KEEP,\n            zero: gl.ZERO,\n            replace: gl.REPLACE,\n            invert: gl.INVERT,\n            'increment-clamp': gl.INCR,\n            'decrement-clamp': gl.DECR,\n            'increment-wrap': gl.INCR_WRAP,\n            'decrement-wrap': gl.DECR_WRAP,\n        };\n\n        this.resetState();\n    }\n\n    protected onRenderTargetChange(renderTarget: RenderTarget)\n    {\n        if (this._activeRenderTarget === renderTarget) return;\n\n        this._activeRenderTarget = renderTarget;\n\n        let stencilState = this._renderTargetStencilState[renderTarget.uid];\n\n        if (!stencilState)\n        {\n            stencilState = this._renderTargetStencilState[renderTarget.uid] = {\n                stencilMode: STENCIL_MODES.DISABLED,\n                stencilReference: 0,\n            };\n        }\n\n        // restore the current render targets stencil state..\n        this.setStencilMode(stencilState.stencilMode, stencilState.stencilReference);\n    }\n\n    public resetState()\n    {\n        // reset stencil cache\n        this._stencilCache.enabled = false;\n        this._stencilCache.stencilMode = STENCIL_MODES.NONE;\n        this._stencilCache.stencilReference = 0;\n    }\n\n    public setStencilMode(stencilMode: STENCIL_MODES, stencilReference: number)\n    {\n        const stencilState = this._renderTargetStencilState[this._activeRenderTarget.uid];\n\n        const gl = this._gl;\n        const mode = GpuStencilModesToPixi[stencilMode];\n\n        const _stencilCache = this._stencilCache;\n\n        // store the stencil state for restoration later, if a render target changes\n        stencilState.stencilMode = stencilMode;\n        stencilState.stencilReference = stencilReference;\n\n        if (stencilMode === STENCIL_MODES.DISABLED)\n        {\n            if (this._stencilCache.enabled)\n            {\n                this._stencilCache.enabled = false;\n\n                gl.disable(gl.STENCIL_TEST);\n            }\n\n            return;\n        }\n\n        if (!this._stencilCache.enabled)\n        {\n            this._stencilCache.enabled = true;\n            gl.enable(gl.STENCIL_TEST);\n        }\n\n        if (stencilMode !== _stencilCache.stencilMode || _stencilCache.stencilReference !== stencilReference)\n        {\n            _stencilCache.stencilMode = stencilMode;\n            _stencilCache.stencilReference = stencilReference;\n\n            // this is pretty simple mapping.\n            // will work for pixi's simple mask cases.\n            // although a true mapping of the GPU state to webGL state should be done\n            gl.stencilFunc(this._comparisonFuncMapping[mode.stencilBack.compare], stencilReference, 0xFF);\n            gl.stencilOp(gl.KEEP, gl.KEEP, this._stencilOpsMapping[mode.stencilBack.passOp]);\n        }\n    }\n\n    public destroy?: () => void;\n}\n","import type { UboElement, UboLayout, UniformData } from '../../../shared/shader/types';\n\n/** @internal */\nexport const WGSL_TO_STD40_SIZE: Record<string, number> = {\n    f32: 4,\n    i32: 4,\n    'vec2<f32>': 8,\n    'vec3<f32>': 12,\n    'vec4<f32>': 16,\n\n    'vec2<i32>': 8,\n    'vec3<i32>': 12,\n    'vec4<i32>': 16,\n\n    'mat2x2<f32>': 16 * 2,\n    'mat3x3<f32>': 16 * 3,\n    'mat4x4<f32>': 16 * 4,\n\n    // TODO - not essential for now but support these in the future\n    // int:      4,\n    // ivec2:    8,\n    // ivec3:    12,\n    // ivec4:    16,\n\n    // uint:     4,\n    // uvec2:    8,\n    // uvec3:    12,\n    // uvec4:    16,\n\n    // bool:     4,\n    // bvec2:    8,\n    // bvec3:    12,\n    // bvec4:    16,\n\n    // mat2:     16 * 2,\n    // mat3:     16 * 3,\n    // mat4:     16 * 4,\n};\n\n/**\n * @param uniformData\n * @internal\n */\nexport function createUboElementsSTD40(uniformData: UniformData[]): UboLayout\n{\n    const uboElements: UboElement[] = uniformData.map((data: UniformData) =>\n        ({\n            data,\n            offset: 0,\n            size: 0,\n        }));\n\n    const chunkSize = 16;\n\n    let size = 0;\n    let offset = 0;\n\n    for (let i = 0; i < uboElements.length; i++)\n    {\n        const uboElement = uboElements[i];\n\n        size = WGSL_TO_STD40_SIZE[uboElement.data.type];\n\n        if (!size)\n        {\n            throw new Error(`Unknown type ${uboElement.data.type}`);\n        }\n\n        if (uboElement.data.size > 1)\n        {\n            size = Math.max(size, chunkSize) * uboElement.data.size;\n        }\n\n        const boundary = size === 12 ? 16 : size;\n\n        uboElement.size = size;\n\n        const curOffset = offset % chunkSize;\n\n        if (curOffset > 0 && chunkSize - curOffset < boundary)\n        {\n            offset += (chunkSize - curOffset) % 16;\n        }\n        else\n        {\n            offset += (size - (curOffset % size)) % size;\n        }\n\n        uboElement.offset = offset;\n        offset += size;\n    }\n\n    offset = Math.ceil(offset / 16) * 16;\n\n    return { uboElements, size: offset };\n}\n\n","import { WGSL_TO_STD40_SIZE } from './createUboElementsSTD40';\n\nimport type { UboElement } from '../../../shared/shader/types';\n\n/**\n * This generates a function that will sync an array to the uniform buffer\n * following the std140 layout\n * @param uboElement - the element to generate the array sync for\n * @param offsetToAdd - the offset to append at the start of the code\n * @returns - the generated code\n * @internal\n */\nexport function generateArraySyncSTD40(uboElement: UboElement, offsetToAdd: number): string\n{\n    const rowSize = Math.max(WGSL_TO_STD40_SIZE[uboElement.data.type] / 16, 1);\n    const elementSize = (uboElement.data.value as Array<number>).length / uboElement.data.size;// size / rowSize;\n\n    const remainder = (4 - (elementSize % 4)) % 4;\n    const data = uboElement.data.type.indexOf('i32') >= 0 ? 'dataInt32' : 'data';\n\n    return `\n        v = uv.${uboElement.data.name};\n        offset += ${offsetToAdd};\n\n        arrayOffset = offset;\n\n        t = 0;\n\n        for(var i=0; i < ${uboElement.data.size * rowSize}; i++)\n        {\n            for(var j = 0; j < ${elementSize}; j++)\n            {\n                ${data}[arrayOffset++] = v[t++];\n            }\n            ${remainder !== 0 ? `arrayOffset += ${remainder};` : ''}\n        }\n    `;\n}\n","import { createUboSyncFunction } from '../../../shared/shader/utils/createUboSyncFunction';\nimport { uboSyncFunctionsSTD40 } from '../../../shared/shader/utils/uboSyncFunctions';\nimport { generateArraySyncSTD40 } from './generateArraySyncSTD40';\n\nimport type { UboElement, UniformsSyncCallback } from '../../../shared/shader/types';\n\n/**\n * @param uboElements\n * @internal\n */\nexport function createUboSyncFunctionSTD40(\n    uboElements: UboElement[],\n): UniformsSyncCallback\n{\n    return createUboSyncFunction(\n        uboElements,\n        'uboStd40',\n        generateArraySyncSTD40,\n        uboSyncFunctionsSTD40,\n    );\n}\n","import { ExtensionType } from '../../../extensions/Extensions';\nimport { UboSystem } from '../shared/shader/UboSystem';\nimport { createUboElementsSTD40 } from './shader/utils/createUboElementsSTD40';\nimport { createUboSyncFunctionSTD40 } from './shader/utils/createUboSyncSTD40';\n\n/**\n * System plugin to the renderer to manage uniform buffers. But with an WGSL adaptor.\n * @category rendering\n * @advanced\n */\nexport class GlUboSystem extends UboSystem\n{\n    /** @ignore */\n    public static extension = {\n        type: [ExtensionType.WebGLSystem],\n        name: 'ubo',\n    } as const;\n\n    constructor()\n    {\n        super({\n            createUboElements: createUboElementsSTD40,\n            generateUboSync: createUboSyncFunctionSTD40,\n        });\n    }\n}\n","/**\n * Represents a render target.\n * @category rendering\n * @ignore\n */\nexport class GlRenderTarget\n{\n    public width = -1;\n    public height = -1;\n    public msaa = false;\n    public framebuffer: WebGLFramebuffer;\n    public resolveTargetFramebuffer: WebGLFramebuffer;\n    public msaaRenderBuffer: WebGLRenderbuffer[] = [];\n    public depthStencilRenderBuffer: WebGLRenderbuffer;\n}\n","import { Rectangle } from '../../../../maths/shapes/Rectangle';\nimport { warn } from '../../../../utils/logging/warn';\nimport { CanvasSource } from '../../shared/texture/sources/CanvasSource';\nimport { CLEAR } from '../const';\nimport { GlRenderTarget } from '../GlRenderTarget';\n\nimport type { RgbaArray } from '../../../../color/Color';\nimport type { RenderTarget } from '../../shared/renderTarget/RenderTarget';\nimport type { RenderTargetAdaptor, RenderTargetSystem } from '../../shared/renderTarget/RenderTargetSystem';\nimport type { Texture } from '../../shared/texture/Texture';\nimport type { CLEAR_OR_BOOL } from '../const';\nimport type { WebGLRenderer } from '../WebGLRenderer';\n\n/**\n * The WebGL adaptor for the render target system. Allows the Render Target System to be used with the WebGL renderer\n * @category rendering\n * @ignore\n */\nexport class GlRenderTargetAdaptor implements RenderTargetAdaptor<GlRenderTarget>\n{\n    private _renderTargetSystem: RenderTargetSystem<GlRenderTarget>;\n    private _renderer: WebGLRenderer<HTMLCanvasElement>;\n    private _clearColorCache: RgbaArray = [0, 0, 0, 0];\n    private _viewPortCache: Rectangle = new Rectangle();\n\n    public init(renderer: WebGLRenderer, renderTargetSystem: RenderTargetSystem<GlRenderTarget>): void\n    {\n        this._renderer = renderer;\n        this._renderTargetSystem = renderTargetSystem;\n\n        renderer.runners.contextChange.add(this);\n    }\n\n    public contextChange(): void\n    {\n        this._clearColorCache = [0, 0, 0, 0];\n        this._viewPortCache = new Rectangle();\n    }\n\n    public copyToTexture(\n        sourceRenderSurfaceTexture: RenderTarget,\n        destinationTexture: Texture,\n        originSrc: { x: number; y: number; },\n        size: { width: number; height: number; },\n        originDest: { x: number; y: number; },\n    )\n    {\n        const renderTargetSystem = this._renderTargetSystem;\n\n        const renderer = this._renderer;\n        const glRenderTarget = renderTargetSystem.getGpuRenderTarget(sourceRenderSurfaceTexture);\n        const gl = renderer.gl;\n\n        this.finishRenderPass(sourceRenderSurfaceTexture);\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, glRenderTarget.resolveTargetFramebuffer);\n\n        renderer.texture.bind(destinationTexture, 0);\n\n        gl.copyTexSubImage2D(gl.TEXTURE_2D, 0,\n            originDest.x, originDest.y,\n            originSrc.x,\n            originSrc.y,\n            size.width,\n            size.height\n        );\n\n        return destinationTexture;\n    }\n\n    public startRenderPass(\n        renderTarget: RenderTarget,\n        clear: CLEAR_OR_BOOL = true,\n        clearColor?: RgbaArray,\n        viewport?: Rectangle\n    )\n    {\n        const renderTargetSystem = this._renderTargetSystem;\n\n        const source = renderTarget.colorTexture;\n        const gpuRenderTarget = renderTargetSystem.getGpuRenderTarget(renderTarget);\n\n        let viewPortY = viewport.y;\n\n        if (renderTarget.isRoot)\n        {\n            // /TODO this is the same logic?\n            viewPortY = source.pixelHeight - viewport.height;\n        }\n\n        // unbind the current render texture..\n        renderTarget.colorTextures.forEach((texture) =>\n        {\n            this._renderer.texture.unbind(texture);\n        });\n\n        const gl = this._renderer.gl;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, gpuRenderTarget.framebuffer);\n\n        const viewPortCache = this._viewPortCache;\n\n        if (viewPortCache.x !== viewport.x\n            || viewPortCache.y !== viewPortY\n            || viewPortCache.width !== viewport.width\n            || viewPortCache.height !== viewport.height)\n        {\n            viewPortCache.x = viewport.x;\n            viewPortCache.y = viewPortY;\n            viewPortCache.width = viewport.width;\n            viewPortCache.height = viewport.height;\n\n            gl.viewport(\n                viewport.x,\n                viewPortY,\n                viewport.width,\n                viewport.height,\n            );\n        }\n\n        // if the stencil buffer has been requested, we need to create a stencil buffer\n        if (!gpuRenderTarget.depthStencilRenderBuffer && (renderTarget.stencil || renderTarget.depth))\n        {\n            this._initStencil(gpuRenderTarget);\n        }\n\n        this.clear(renderTarget, clear, clearColor);\n    }\n\n    public finishRenderPass(renderTarget?: RenderTarget)\n    {\n        const renderTargetSystem = this._renderTargetSystem;\n\n        const glRenderTarget = renderTargetSystem.getGpuRenderTarget(renderTarget);\n\n        if (!glRenderTarget.msaa) return;\n\n        const gl = this._renderer.gl;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, glRenderTarget.resolveTargetFramebuffer);\n        gl.bindFramebuffer(gl.READ_FRAMEBUFFER, glRenderTarget.framebuffer);\n\n        gl.blitFramebuffer(\n            0, 0, glRenderTarget.width, glRenderTarget.height,\n            0, 0, glRenderTarget.width, glRenderTarget.height,\n            gl.COLOR_BUFFER_BIT, gl.NEAREST,\n        );\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, glRenderTarget.framebuffer);\n\n        // dont think we need this anymore? keeping around just in case the wheels fall off\n        // gl.bindFramebuffer(gl.READ_FRAMEBUFFER, null);\n    }\n\n    public initGpuRenderTarget(renderTarget: RenderTarget): GlRenderTarget\n    {\n        const renderer = this._renderer;\n\n        const gl = renderer.gl;\n\n        // do single...\n\n        const glRenderTarget = new GlRenderTarget();\n\n        // we are rendering to the main canvas..\n        const colorTexture = renderTarget.colorTexture;\n\n        if (colorTexture instanceof CanvasSource)\n        {\n            this._renderer.context.ensureCanvasSize(renderTarget.colorTexture.resource);\n\n            glRenderTarget.framebuffer = null;\n\n            return glRenderTarget;\n        }\n\n        this._initColor(renderTarget, glRenderTarget);\n\n        // set up a depth texture..\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n        return glRenderTarget;\n    }\n\n    public destroyGpuRenderTarget(gpuRenderTarget: GlRenderTarget)\n    {\n        const gl = this._renderer.gl;\n\n        if (gpuRenderTarget.framebuffer)\n        {\n            gl.deleteFramebuffer(gpuRenderTarget.framebuffer);\n            gpuRenderTarget.framebuffer = null;\n        }\n\n        if (gpuRenderTarget.resolveTargetFramebuffer)\n        {\n            gl.deleteFramebuffer(gpuRenderTarget.resolveTargetFramebuffer);\n            gpuRenderTarget.resolveTargetFramebuffer = null;\n        }\n\n        if (gpuRenderTarget.depthStencilRenderBuffer)\n        {\n            gl.deleteRenderbuffer(gpuRenderTarget.depthStencilRenderBuffer);\n            gpuRenderTarget.depthStencilRenderBuffer = null;\n        }\n\n        gpuRenderTarget.msaaRenderBuffer.forEach((renderBuffer) =>\n        {\n            gl.deleteRenderbuffer(renderBuffer);\n        });\n\n        gpuRenderTarget.msaaRenderBuffer = null;\n    }\n\n    public clear(_renderTarget: RenderTarget, clear: CLEAR_OR_BOOL, clearColor?: RgbaArray)\n    {\n        if (!clear) return;\n\n        const renderTargetSystem = this._renderTargetSystem;\n\n        // if clear is boolean..\n        if (typeof clear === 'boolean')\n        {\n            clear = clear ? CLEAR.ALL : CLEAR.NONE;\n        }\n\n        const gl = this._renderer.gl;\n\n        if (clear & CLEAR.COLOR)\n        {\n            clearColor ??= renderTargetSystem.defaultClearColor;\n\n            const clearColorCache = this._clearColorCache;\n            const clearColorArray = clearColor as number[];\n\n            if (clearColorCache[0] !== clearColorArray[0]\n                || clearColorCache[1] !== clearColorArray[1]\n                || clearColorCache[2] !== clearColorArray[2]\n                || clearColorCache[3] !== clearColorArray[3])\n            {\n                clearColorCache[0] = clearColorArray[0];\n                clearColorCache[1] = clearColorArray[1];\n                clearColorCache[2] = clearColorArray[2];\n                clearColorCache[3] = clearColorArray[3];\n\n                gl.clearColor(clearColorArray[0], clearColorArray[1], clearColorArray[2], clearColorArray[3]);\n            }\n        }\n\n        gl.clear(clear);\n    }\n\n    public resizeGpuRenderTarget(renderTarget: RenderTarget)\n    {\n        if (renderTarget.isRoot) return;\n\n        const renderTargetSystem = this._renderTargetSystem;\n\n        const glRenderTarget = renderTargetSystem.getGpuRenderTarget(renderTarget);\n\n        this._resizeColor(renderTarget, glRenderTarget);\n\n        if (renderTarget.stencil || renderTarget.depth)\n        {\n            this._resizeStencil(glRenderTarget);\n        }\n    }\n\n    private _initColor(renderTarget: RenderTarget, glRenderTarget: GlRenderTarget)\n    {\n        const renderer = this._renderer;\n\n        const gl = renderer.gl;\n        // deal with our outputs..\n        const resolveTargetFramebuffer = gl.createFramebuffer();\n\n        glRenderTarget.resolveTargetFramebuffer = resolveTargetFramebuffer;\n\n        // set up the texture..\n        gl.bindFramebuffer(gl.FRAMEBUFFER, resolveTargetFramebuffer);\n\n        glRenderTarget.width = renderTarget.colorTexture.source.pixelWidth;\n        glRenderTarget.height = renderTarget.colorTexture.source.pixelHeight;\n\n        renderTarget.colorTextures.forEach((colorTexture, i) =>\n        {\n            const source = colorTexture.source;\n\n            if (source.antialias)\n            {\n                if (renderer.context.supports.msaa)\n                {\n                    glRenderTarget.msaa = true;\n                }\n                else\n                {\n                    warn('[RenderTexture] Antialiasing on textures is not supported in WebGL1');\n                }\n            }\n\n            // TODO bindSource could return the glTexture\n            renderer.texture.bindSource(source, 0);\n            const glSource = renderer.texture.getGlSource(source);\n\n            const glTexture = glSource.texture;\n\n            gl.framebufferTexture2D(gl.FRAMEBUFFER,\n                gl.COLOR_ATTACHMENT0 + i,\n                3553, // texture.target,\n                glTexture,\n                0);// mipLevel);\n        });\n\n        if (glRenderTarget.msaa)\n        {\n            const viewFramebuffer = gl.createFramebuffer();\n\n            glRenderTarget.framebuffer = viewFramebuffer;\n\n            gl.bindFramebuffer(gl.FRAMEBUFFER, viewFramebuffer);\n\n            renderTarget.colorTextures.forEach((_, i) =>\n            {\n                const msaaRenderBuffer = gl.createRenderbuffer();\n\n                glRenderTarget.msaaRenderBuffer[i] = msaaRenderBuffer;\n            });\n        }\n        else\n        {\n            glRenderTarget.framebuffer = resolveTargetFramebuffer;\n        }\n\n        this._resizeColor(renderTarget, glRenderTarget);\n    }\n\n    private _resizeColor(renderTarget: RenderTarget, glRenderTarget: GlRenderTarget)\n    {\n        const source = renderTarget.colorTexture.source;\n\n        glRenderTarget.width = source.pixelWidth;\n        glRenderTarget.height = source.pixelHeight;\n\n        renderTarget.colorTextures.forEach((colorTexture, i) =>\n        {\n            // nno need to resize the first texture..\n            if (i === 0) return;\n\n            colorTexture.source.resize(source.width, source.height, source._resolution);\n        });\n\n        if (glRenderTarget.msaa)\n        {\n            const renderer = this._renderer;\n            const gl = renderer.gl;\n\n            const viewFramebuffer = glRenderTarget.framebuffer;\n\n            gl.bindFramebuffer(gl.FRAMEBUFFER, viewFramebuffer);\n\n            renderTarget.colorTextures.forEach((colorTexture, i) =>\n            {\n                const source = colorTexture.source;\n\n                renderer.texture.bindSource(source, 0);\n                const glSource = renderer.texture.getGlSource(source);\n\n                const glInternalFormat = glSource.internalFormat;\n\n                const msaaRenderBuffer = glRenderTarget.msaaRenderBuffer[i];\n\n                gl.bindRenderbuffer(\n                    gl.RENDERBUFFER,\n                    msaaRenderBuffer\n                );\n\n                gl.renderbufferStorageMultisample(\n                    gl.RENDERBUFFER,\n                    4,\n                    glInternalFormat,\n                    source.pixelWidth,\n                    source.pixelHeight\n                );\n\n                gl.framebufferRenderbuffer(\n                    gl.FRAMEBUFFER,\n                    gl.COLOR_ATTACHMENT0 + i,\n                    gl.RENDERBUFFER,\n                    msaaRenderBuffer\n                );\n            });\n        }\n    }\n\n    private _initStencil(glRenderTarget: GlRenderTarget)\n    {\n        // this already exists on the default screen\n        if (glRenderTarget.framebuffer === null) return;\n\n        const gl = this._renderer.gl;\n\n        const depthStencilRenderBuffer = gl.createRenderbuffer();\n\n        glRenderTarget.depthStencilRenderBuffer = depthStencilRenderBuffer;\n\n        gl.bindRenderbuffer(\n            gl.RENDERBUFFER,\n            depthStencilRenderBuffer\n        );\n\n        gl.framebufferRenderbuffer(\n            gl.FRAMEBUFFER,\n            gl.DEPTH_STENCIL_ATTACHMENT,\n            gl.RENDERBUFFER,\n            depthStencilRenderBuffer\n        );\n\n        // TDO DO>>\n        this._resizeStencil(glRenderTarget);\n    }\n\n    private _resizeStencil(glRenderTarget: GlRenderTarget)\n    {\n        const gl = this._renderer.gl;\n\n        gl.bindRenderbuffer(\n            gl.RENDERBUFFER,\n            glRenderTarget.depthStencilRenderBuffer\n        );\n\n        if (glRenderTarget.msaa)\n        {\n            gl.renderbufferStorageMultisample(\n                gl.RENDERBUFFER,\n                4,\n                gl.DEPTH24_STENCIL8,\n                glRenderTarget.width,\n                glRenderTarget.height\n            );\n        }\n        else\n        {\n            gl.renderbufferStorage(\n                gl.RENDERBUFFER,\n                this._renderer.context.webGLVersion === 2\n                    ? gl.DEPTH24_STENCIL8\n                    : gl.DEPTH_STENCIL,\n                glRenderTarget.width,\n                glRenderTarget.height\n            );\n        }\n    }\n\n    public prerender(renderTarget: RenderTarget)\n    {\n        const resource = renderTarget.colorTexture.resource;\n\n        // if the render target is a canvas, ensure its size matches the source\n        if (this._renderer.context.multiView && CanvasSource.test(resource))\n        {\n            this._renderer.context.ensureCanvasSize(resource);\n        }\n    }\n\n    public postrender(renderTarget: RenderTarget)\n    {\n        // if multiView is not enabled, we don't need to do anything\n        if (!this._renderer.context.multiView) return;\n\n        // if the render target is a canvas, we need to copy the pixels from the gl canvas\n        // to the canvas target\n        if (CanvasSource.test(renderTarget.colorTexture.resource))\n        {\n            const contextCanvas = this._renderer.context.canvas;\n            const canvasSource = renderTarget.colorTexture as unknown as CanvasSource;\n\n            canvasSource.context2D.drawImage(\n                contextCanvas as CanvasImageSource,\n                0, canvasSource.pixelHeight - contextCanvas.height\n            );\n        }\n    }\n}\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { RenderTargetSystem } from '../../shared/renderTarget/RenderTargetSystem';\nimport { GlRenderTargetAdaptor } from './GlRenderTargetAdaptor';\n\nimport type { GlRenderTarget } from '../GlRenderTarget';\nimport type { WebGLRenderer } from '../WebGLRenderer';\n\n/**\n * The WebGL adaptor for the render target system. Allows the Render Target System to be used with the WebGl renderer\n * @category rendering\n * @advanced\n */\nexport class GlRenderTargetSystem extends RenderTargetSystem<GlRenderTarget>\n{\n    /** @ignore */\n    public static extension = {\n        type: [ExtensionType.WebGLSystem],\n        name: 'renderTarget',\n    } as const;\n\n    public adaptor = new GlRenderTargetAdaptor();\n\n    constructor(renderer: WebGLRenderer)\n    {\n        super(renderer);\n\n        this.adaptor.init(renderer, this);\n    }\n}\n","/** @private */\nexport class IGLUniformData\n{\n    public location: WebGLUniformLocation;\n    public value: number | boolean | Float32Array | Int32Array | Uint32Array | boolean[];\n}\n\n/**\n * Helper class to create a WebGL Program\n * @private\n */\nexport class GlProgramData\n{\n    /** The shader program. */\n    public program: WebGLProgram;\n\n    /**\n     * Holds the uniform data which contains uniform locations\n     * and current uniform values used for caching and preventing unneeded GPU commands.\n     */\n    public uniformData: Record<string, any>;\n\n    /**\n     * UniformGroups holds the various upload functions for the shader. Each uniform group\n     * and program have a unique upload function generated.\n     */\n    public uniformGroups: Record<string, any>;\n\n    /** A hash that stores where UBOs are bound to on the program. */\n    public uniformBlockBindings: Record<string, any>;\n\n    /** A hash for lazily-generated uniform uploading functions. */\n    public uniformSync: Record<string, any>;\n\n    /**\n     * A place where dirty ticks are stored for groups\n     * If a tick here does not match with the Higher level Programs tick, it means\n     * we should re upload the data.\n     */\n    public uniformDirtyGroups: Record<string, any>;\n\n    /**\n     * Makes a new Pixi program.\n     * @param program - webgl program\n     * @param uniformData - uniforms\n     */\n    constructor(program: WebGLProgram, uniformData: {[key: string]: IGLUniformData})\n    {\n        this.program = program;\n        this.uniformData = uniformData;\n        this.uniformGroups = {};\n        this.uniformDirtyGroups = {};\n        this.uniformBlockBindings = {};\n    }\n\n    /** Destroys this program. */\n    public destroy(): void\n    {\n        this.uniformData = null;\n        this.uniformGroups = null;\n        this.uniformDirtyGroups = null;\n        this.uniformBlockBindings = null;\n        this.program = null;\n    }\n}\n","/**\n * @private\n * @param {WebGLRenderingContext} gl - The current WebGL context {WebGLProgram}\n * @param {number} type - the type, can be either VERTEX_SHADER or FRAGMENT_SHADER\n * @param {string} src - The vertex shader source as an array of strings.\n * @returns {WebGLShader} the shader\n */\nexport function compileShader(gl: WebGLRenderingContextBase, type: number, src: string): WebGLShader\n{\n    const shader = gl.createShader(type);\n\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n\n    return shader;\n}\n","function booleanArray(size: number): Array<boolean>\n{\n    const array = new Array(size);\n\n    for (let i = 0; i < array.length; i++)\n    {\n        array[i] = false;\n    }\n\n    return array;\n}\n\n/**\n * @param {string} type - Type of value\n * @param {number} size\n * @private\n */\nexport function defaultValue(\n    type: string,\n    size: number\n): number | Float32Array | Int32Array | Uint32Array | boolean | boolean[]\n{\n    switch (type)\n    {\n        case 'float':\n            return 0;\n\n        case 'vec2':\n            return new Float32Array(2 * size);\n\n        case 'vec3':\n            return new Float32Array(3 * size);\n\n        case 'vec4':\n            return new Float32Array(4 * size);\n\n        case 'int':\n        case 'uint':\n        case 'sampler2D':\n        case 'sampler2DArray':\n            return 0;\n\n        case 'ivec2':\n            return new Int32Array(2 * size);\n\n        case 'ivec3':\n            return new Int32Array(3 * size);\n\n        case 'ivec4':\n            return new Int32Array(4 * size);\n\n        case 'uvec2':\n            return new Uint32Array(2 * size);\n\n        case 'uvec3':\n            return new Uint32Array(3 * size);\n\n        case 'uvec4':\n            return new Uint32Array(4 * size);\n\n        case 'bool':\n            return false;\n\n        case 'bvec2':\n\n            return booleanArray(2 * size);\n\n        case 'bvec3':\n            return booleanArray(3 * size);\n\n        case 'bvec4':\n            return booleanArray(4 * size);\n\n        case 'mat2':\n            return new Float32Array([1, 0,\n                0, 1]);\n\n        case 'mat3':\n            return new Float32Array([1, 0, 0,\n                0, 1, 0,\n                0, 0, 1]);\n\n        case 'mat4':\n            return new Float32Array([1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1]);\n    }\n\n    return null;\n}\n","import type { Dict } from '../../../../../utils/types';\nimport type { VertexFormat } from '../../../shared/geometry/const';\n\nlet GL_TABLE: Dict<string> = null;\n\nconst GL_TO_GLSL_TYPES: Dict<string> = {\n    FLOAT:       'float',\n    FLOAT_VEC2:  'vec2',\n    FLOAT_VEC3:  'vec3',\n    FLOAT_VEC4:  'vec4',\n\n    INT:         'int',\n    INT_VEC2:    'ivec2',\n    INT_VEC3:    'ivec3',\n    INT_VEC4:    'ivec4',\n\n    UNSIGNED_INT:         'uint',\n    UNSIGNED_INT_VEC2:    'uvec2',\n    UNSIGNED_INT_VEC3:    'uvec3',\n    UNSIGNED_INT_VEC4:    'uvec4',\n\n    BOOL:        'bool',\n    BOOL_VEC2:   'bvec2',\n    BOOL_VEC3:   'bvec3',\n    BOOL_VEC4:   'bvec4',\n\n    FLOAT_MAT2:  'mat2',\n    FLOAT_MAT3:  'mat3',\n    FLOAT_MAT4:  'mat4',\n\n    SAMPLER_2D:              'sampler2D',\n    INT_SAMPLER_2D:          'sampler2D',\n    UNSIGNED_INT_SAMPLER_2D: 'sampler2D',\n    SAMPLER_CUBE:              'samplerCube',\n    INT_SAMPLER_CUBE:          'samplerCube',\n    UNSIGNED_INT_SAMPLER_CUBE: 'samplerCube',\n    SAMPLER_2D_ARRAY:              'sampler2DArray',\n    INT_SAMPLER_2D_ARRAY:          'sampler2DArray',\n    UNSIGNED_INT_SAMPLER_2D_ARRAY: 'sampler2DArray',\n};\n\nconst GLSL_TO_VERTEX_TYPES: Record<string, VertexFormat> = {\n\n    float: 'float32',\n    vec2: 'float32x2',\n    vec3: 'float32x3',\n    vec4: 'float32x4',\n\n    int: 'sint32',\n    ivec2: 'sint32x2',\n    ivec3: 'sint32x3',\n    ivec4: 'sint32x4',\n\n    uint: 'uint32',\n    uvec2: 'uint32x2',\n    uvec3: 'uint32x3',\n    uvec4: 'uint32x4',\n\n    bool: 'uint32',\n    bvec2: 'uint32x2',\n    bvec3: 'uint32x3',\n    bvec4: 'uint32x4',\n};\n\n/**\n * @param gl\n * @param type\n * @internal\n */\nexport function mapType(gl: any, type: number): string\n{\n    if (!GL_TABLE)\n    {\n        const typeNames = Object.keys(GL_TO_GLSL_TYPES);\n\n        GL_TABLE = {};\n\n        for (let i = 0; i < typeNames.length; ++i)\n        {\n            const tn = typeNames[i];\n\n            GL_TABLE[gl[tn]] = GL_TO_GLSL_TYPES[tn];\n        }\n    }\n\n    return GL_TABLE[type];\n}\n\n/**\n * @param gl\n * @param type\n * @internal\n */\nexport function mapGlToVertexFormat(gl: any, type: number): VertexFormat\n{\n    const typeValue = mapType(gl, type);\n\n    return GLSL_TO_VERTEX_TYPES[typeValue] || 'float32';\n}\n","/**\n * will log a shader error highlighting the lines with the error\n * also will add numbers along the side.\n * @param gl - the WebGLContext\n * @param shader - the shader to log errors for\n */\nfunction logPrettyShaderError(gl: WebGLRenderingContext, shader: WebGLShader): void\n{\n    const shaderSrc = gl.getShaderSource(shader)\n        .split('\\n')\n        .map((line, index) => `${index}: ${line}`);\n\n    const shaderLog = gl.getShaderInfoLog(shader);\n    const splitShader = shaderLog.split('\\n');\n\n    const dedupe: Record<number, boolean> = {};\n\n    const lineNumbers = splitShader.map((line) => parseFloat(line.replace(/^ERROR\\: 0\\:([\\d]+)\\:.*$/, '$1')))\n        .filter((n) =>\n        {\n            if (n && !dedupe[n])\n            {\n                dedupe[n] = true;\n\n                return true;\n            }\n\n            return false;\n        });\n\n    const logArgs = [''];\n\n    lineNumbers.forEach((number) =>\n    {\n        shaderSrc[number - 1] = `%c${shaderSrc[number - 1]}%c`;\n        logArgs.push('background: #FF0000; color:#FFFFFF; font-size: 10px', 'font-size: 10px');\n    });\n\n    const fragmentSourceToLog = shaderSrc\n        .join('\\n');\n\n    logArgs[0] = fragmentSourceToLog;\n\n    console.error(shaderLog);\n\n    // eslint-disable-next-line no-console\n    console.groupCollapsed('click to view full shader code');\n    console.warn(...logArgs);\n    // eslint-disable-next-line no-console\n    console.groupEnd();\n}\n\n/**\n *\n * logs out any program errors\n * @param gl - The current WebGL context\n * @param program - the WebGL program to display errors for\n * @param vertexShader  - the fragment WebGL shader program\n * @param fragmentShader - the vertex WebGL shader program\n * @private\n */\nexport function logProgramError(\n    gl: WebGLRenderingContext,\n    program: WebGLProgram,\n    vertexShader: WebGLShader,\n    fragmentShader: WebGLShader\n): void\n{\n    // if linking fails, then log and cleanup\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS))\n    {\n        if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS))\n        {\n            logPrettyShaderError(gl, vertexShader);\n        }\n\n        if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS))\n        {\n            logPrettyShaderError(gl, fragmentShader);\n        }\n\n        console.error('PixiJS Error: Could not initialize shader.');\n\n        // if there is a program info log, log it\n        if (gl.getProgramInfoLog(program) !== '')\n        {\n            console.warn('PixiJS Warning: gl.getProgramInfoLog()', gl.getProgramInfoLog(program));\n        }\n    }\n}\n","import { warn } from '../../../../../utils/logging/warn';\nimport { GlProgramData } from '../GlProgramData';\nimport { compileShader } from './compileShader';\nimport { defaultValue } from './defaultValue';\nimport { extractAttributesFromGlProgram } from './extractAttributesFromGlProgram';\nimport { getUboData } from './getUboData';\nimport { getUniformData } from './getUniformData';\nimport { logProgramError } from './logProgramError';\n\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { GlProgram } from '../GlProgram';\nimport type { IGLUniformData } from '../GlProgramData';\n\n/**\n * generates a WebGL Program object from a high level Pixi Program.\n * @param gl - a rendering context on which to generate the program\n * @param program - the high level Pixi Program.\n * @private\n */\nexport function generateProgram(gl: GlRenderingContext, program: GlProgram): GlProgramData\n{\n    const glVertShader = compileShader(gl, gl.VERTEX_SHADER, program.vertex);\n    const glFragShader = compileShader(gl, gl.FRAGMENT_SHADER, program.fragment);\n\n    const webGLProgram = gl.createProgram();\n\n    gl.attachShader(webGLProgram, glVertShader);\n    gl.attachShader(webGLProgram, glFragShader);\n\n    const transformFeedbackVaryings = program.transformFeedbackVaryings;\n\n    if (transformFeedbackVaryings)\n    {\n        if (typeof gl.transformFeedbackVaryings !== 'function')\n        {\n            // #if _DEBUG\n            warn(`TransformFeedback is not supported but TransformFeedbackVaryings are given.`);\n            // #endif\n        }\n        else\n        {\n            gl.transformFeedbackVaryings(\n                webGLProgram,\n                transformFeedbackVaryings.names,\n                transformFeedbackVaryings.bufferMode === 'separate'\n                    ? gl.SEPARATE_ATTRIBS\n                    : gl.INTERLEAVED_ATTRIBS\n            );\n        }\n    }\n\n    gl.linkProgram(webGLProgram);\n\n    if (!gl.getProgramParameter(webGLProgram, gl.LINK_STATUS))\n    {\n        logProgramError(gl, webGLProgram, glVertShader, glFragShader);\n    }\n\n    // GLSL 1.00: bind attributes sorted by name in ascending order\n    // GLSL 3.00: don't change the attribute locations that where chosen by the compiler\n    //            or assigned by the layout specifier in the shader source code\n    program._attributeData = extractAttributesFromGlProgram(\n        webGLProgram,\n        gl,\n        !(/^[ \\t]*#[ \\t]*version[ \\t]+300[ \\t]+es[ \\t]*$/m).test(program.vertex)\n    );\n\n    program._uniformData = getUniformData(webGLProgram, gl);\n    program._uniformBlockData = getUboData(webGLProgram, gl);\n\n    gl.deleteShader(glVertShader);\n    gl.deleteShader(glFragShader);\n\n    const uniformData: {[key: string]: IGLUniformData} = {};\n\n    for (const i in program._uniformData)\n    {\n        const data = program._uniformData[i];\n\n        uniformData[i] = {\n            location: gl.getUniformLocation(webGLProgram, i),\n            value: defaultValue(data.type, data.size),\n        };\n    }\n\n    const glProgram = new GlProgramData(webGLProgram, uniformData);\n\n    return glProgram;\n}\n","import { getAttributeInfoFromFormat } from '../../../shared/geometry/utils/getAttributeInfoFromFormat';\nimport { mapGlToVertexFormat } from './mapType';\n\nimport type { Attribute } from '../../../shared/geometry/Geometry';\n\n/**\n * This interface represents the extracted attribute data from a WebGL program.\n * It extends the `Attribute` interface but omits the `buffer` property.\n * It includes an optional `location` property that indicates where the shader location is for this attribute.\n * @category rendering\n * @advanced\n */\nexport interface ExtractedAttributeData extends Omit<Attribute, 'buffer'>\n{\n    /** set where the shader location is for this attribute */\n    location?: number;\n}\n\n/**\n * returns the attribute data from the program\n * @private\n * @param {WebGLProgram} [program] - the WebGL program\n * @param {WebGLRenderingContext} [gl] - the WebGL context\n * @param sortAttributes\n * @returns {object} the attribute data for this program\n */\nexport function extractAttributesFromGlProgram(\n    program: WebGLProgram,\n    gl: WebGLRenderingContextBase,\n    sortAttributes = false\n): Record<string, ExtractedAttributeData>\n{\n    const attributes: {[key: string]: ExtractedAttributeData} = {};\n\n    const totalAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n\n    for (let i = 0; i < totalAttributes; i++)\n    {\n        const attribData = gl.getActiveAttrib(program, i);\n\n        // ignore the default ones!\n        if (attribData.name.startsWith('gl_'))\n        {\n            continue;\n        }\n\n        const format = mapGlToVertexFormat(gl, attribData.type);\n\n        attributes[attribData.name] = {\n            location: 0, // set further down..\n            format,\n            stride: getAttributeInfoFromFormat(format).stride,\n            offset: 0,\n            instance: false,\n            start: 0,\n        };\n    }\n\n    const keys = Object.keys(attributes);\n\n    if (sortAttributes)\n    {\n        keys.sort((a, b) => (a > b) ? 1 : -1); // eslint-disable-line no-confusing-arrow\n\n        for (let i = 0; i < keys.length; i++)\n        {\n            attributes[keys[i]].location = i;\n\n            gl.bindAttribLocation(program, i, keys[i]);\n        }\n\n        gl.linkProgram(program);\n    }\n    else\n    {\n        for (let i = 0; i < keys.length; i++)\n        {\n            attributes[keys[i]].location = gl.getAttribLocation(program, keys[i]);\n        }\n    }\n\n    return attributes;\n}\n","import { defaultValue } from './defaultValue';\nimport { mapType } from './mapType';\n\nimport type { GlUniformData } from '../GlProgram';\n\n/**\n * returns the uniform data from the program\n * @private\n * @param program - the webgl program\n * @param gl - the WebGL context\n * @returns {object} the uniform data for this program\n */\nexport function getUniformData(program: WebGLProgram, gl: WebGLRenderingContextBase): {[key: string]: GlUniformData}\n{\n    const uniforms: {[key: string]: GlUniformData} = {};\n\n    const totalUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n\n    for (let i = 0; i < totalUniforms; i++)\n    {\n        const uniformData = gl.getActiveUniform(program, i);\n        const name = uniformData.name.replace(/\\[.*?\\]$/, '');\n\n        const isArray = !!(uniformData.name.match(/\\[.*?\\]$/));\n\n        const type = mapType(gl, uniformData.type);\n\n        uniforms[name] = {\n            name,\n            index: i,\n            type,\n            size: uniformData.size,\n            isArray,\n            value: defaultValue(type, uniformData.size),\n        };\n    }\n\n    return uniforms;\n}\n","import type { GlUniformBlockData } from '../GlProgram';\n\n/**\n * returns the uniform block data from the program\n * @private\n * @param program - the webgl program\n * @param gl - the WebGL context\n * @returns {object} the uniform data for this program\n */\nexport function getUboData(program: WebGLProgram, gl: WebGL2RenderingContext): Record<string, GlUniformBlockData>\n{\n    // if uniform buffer data is not supported, early out\n    if (!gl.ACTIVE_UNIFORM_BLOCKS) return {};\n\n    const uniformBlocks: Record<string, GlUniformBlockData> = {};\n\n    // const totalUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n\n    const totalUniformsBlocks = gl.getProgramParameter(program, gl.ACTIVE_UNIFORM_BLOCKS);\n\n    for (let i = 0; i < totalUniformsBlocks; i++)\n    {\n        const name = gl.getActiveUniformBlockName(program, i);\n        const uniformBlockIndex = gl.getUniformBlockIndex(program, name);\n\n        const size = gl.getActiveUniformBlockParameter(program, i, gl.UNIFORM_BLOCK_DATA_SIZE);\n\n        uniformBlocks[name] = {\n            name,\n            index: uniformBlockIndex,\n            size,\n        };\n    }\n\n    return uniformBlocks;\n}\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { generateShaderSyncCode } from './GenerateShaderSyncCode';\nimport { generateProgram } from './program/generateProgram';\n\nimport type { BufferResource } from '../../shared/buffer/BufferResource';\nimport type { Shader } from '../../shared/shader/Shader';\nimport type { UniformGroup } from '../../shared/shader/UniformGroup';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\nimport type { WebGLRenderer } from '../WebGLRenderer';\nimport type { GlProgram } from './GlProgram';\nimport type { GlProgramData } from './GlProgramData';\n\n/** @internal */\nexport interface ShaderSyncData\n{\n    textureCount: number;\n    blockIndex: number;\n}\n\n/** @internal */\nexport type ShaderSyncFunction = (renderer: WebGLRenderer, shader: Shader, syncData: ShaderSyncData) => void;\n\n// default sync data so we don't create a new one each time!\nconst defaultSyncData: ShaderSyncData = {\n    textureCount: 0,\n    blockIndex: 0,\n};\n\n/**\n * System plugin to the renderer to manage the shaders for WebGL.\n * @category rendering\n * @advanced\n */\nexport class GlShaderSystem\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'shader',\n    } as const;\n\n    /** @internal */\n    public _activeProgram: GlProgram = null;\n\n    private _programDataHash: Record<string, GlProgramData> = Object.create(null);\n    private readonly _renderer: WebGLRenderer;\n    /** @internal */\n    public _gl: WebGL2RenderingContext;\n    private _shaderSyncFunctions: Record<string, ShaderSyncFunction> = Object.create(null);\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n        this._renderer.renderableGC.addManagedHash(this, '_programDataHash');\n    }\n\n    protected contextChange(gl: GlRenderingContext): void\n    {\n        this._gl = gl;\n\n        this._programDataHash = Object.create(null);\n        /**\n         * these need to also be cleared as internally some uniforms are set as an optimisation as the sync\n         * function is generated. Specifically the texture ints.\n         */\n        this._shaderSyncFunctions = Object.create(null);\n        this._activeProgram = null;\n    }\n\n    /**\n     * Changes the current shader to the one given in parameter.\n     * @param shader - the new shader\n     * @param skipSync - false if the shader should automatically sync its uniforms.\n     * @returns the glProgram that belongs to the shader.\n     */\n    public bind(shader: Shader, skipSync?: boolean): void\n    {\n        this._setProgram(shader.glProgram);\n\n        if (skipSync) return;\n\n        defaultSyncData.textureCount = 0;\n        defaultSyncData.blockIndex = 0;\n\n        let syncFunction = this._shaderSyncFunctions[shader.glProgram._key];\n\n        if (!syncFunction)\n        {\n            syncFunction = this._shaderSyncFunctions[shader.glProgram._key] = this._generateShaderSync(shader, this);\n        }\n\n        // TODO: take into account number of TF buffers. Currently works only with interleaved\n        this._renderer.buffer.nextBindBase(!!shader.glProgram.transformFeedbackVaryings);\n        syncFunction(this._renderer, shader, defaultSyncData);\n    }\n\n    /**\n     * Updates the uniform group.\n     * @param uniformGroup - the uniform group to update\n     */\n    public updateUniformGroup(uniformGroup: UniformGroup): void\n    {\n        this._renderer.uniformGroup.updateUniformGroup(uniformGroup, this._activeProgram, defaultSyncData);\n    }\n\n    /**\n     * Binds a uniform block to the shader.\n     * @param uniformGroup - the uniform group to bind\n     * @param name - the name of the uniform block\n     * @param index - the index of the uniform block\n     */\n    public bindUniformBlock(uniformGroup: UniformGroup | BufferResource, name: string, index = 0): void\n    {\n        const bufferSystem = this._renderer.buffer;\n        const programData = this._getProgramData(this._activeProgram);\n\n        const isBufferResource = (uniformGroup as BufferResource)._bufferResource;\n\n        if (!isBufferResource)\n        {\n            this._renderer.ubo.updateUniformGroup(uniformGroup as UniformGroup);\n        }\n\n        const buffer = uniformGroup.buffer;\n\n        const glBuffer = bufferSystem.updateBuffer(buffer);\n\n        const boundLocation = bufferSystem.freeLocationForBufferBase(glBuffer);\n\n        if (isBufferResource)\n        {\n            const { offset, size } = (uniformGroup as BufferResource);\n\n            // trivial case of buffer resource, can be cached\n            if (offset === 0 && size === buffer.data.byteLength)\n            {\n                bufferSystem.bindBufferBase(glBuffer, boundLocation);\n            }\n            else\n            {\n                bufferSystem.bindBufferRange(glBuffer, boundLocation, offset);\n            }\n        }\n        else if (bufferSystem.getLastBindBaseLocation(glBuffer) !== boundLocation)\n        {\n            // confirmation that buffer isn't there yet\n            bufferSystem.bindBufferBase(glBuffer, boundLocation);\n        }\n\n        const uniformBlockIndex = this._activeProgram._uniformBlockData[name].index;\n\n        if (programData.uniformBlockBindings[index] === boundLocation) return;\n        programData.uniformBlockBindings[index] = boundLocation;\n\n        this._renderer.gl.uniformBlockBinding(programData.program, uniformBlockIndex, boundLocation);\n    }\n\n    private _setProgram(program: GlProgram)\n    {\n        if (this._activeProgram === program) return;\n\n        this._activeProgram = program;\n\n        const programData = this._getProgramData(program);\n\n        this._gl.useProgram(programData.program);\n    }\n\n    /**\n     * @param program - the program to get the data for\n     * @internal\n     */\n    public _getProgramData(program: GlProgram): GlProgramData\n    {\n        return this._programDataHash[program._key] || this._createProgramData(program);\n    }\n\n    private _createProgramData(program: GlProgram): GlProgramData\n    {\n        const key = program._key;\n\n        this._programDataHash[key] = generateProgram(this._gl, program);\n\n        return this._programDataHash[key];\n    }\n\n    public destroy(): void\n    {\n        for (const key of Object.keys(this._programDataHash))\n        {\n            const programData = this._programDataHash[key];\n\n            programData.destroy();\n            this._programDataHash[key] = null;\n        }\n\n        this._programDataHash = null;\n        this._shaderSyncFunctions = null;\n        this._activeProgram = null;\n        (this._renderer as null) = null;\n        this._gl = null;\n    }\n\n    /**\n     * Creates a function that can be executed that will sync the shader as efficiently as possible.\n     * Overridden by the unsafe eval package if you don't want eval used in your project.\n     * @param shader - the shader to generate the sync function for\n     * @param shaderSystem - the shader system to use\n     * @returns - the generated sync function\n     * @ignore\n     */\n    public _generateShaderSync(shader: Shader, shaderSystem: GlShaderSystem): ShaderSyncFunction\n    {\n        return generateShaderSyncCode(shader, shaderSystem);\n    }\n\n    public resetState(): void\n    {\n        this._activeProgram = null;\n    }\n}\n","import { BufferResource } from '../../shared/buffer/BufferResource';\nimport { UniformGroup } from '../../shared/shader/UniformGroup';\nimport { TextureSource } from '../../shared/texture/sources/TextureSource';\n\nimport type { Shader } from '../../shared/shader/Shader';\nimport type { GlShaderSystem, ShaderSyncFunction } from './GlShaderSystem';\n\n/**\n * Generates the a function that will efficiently sync shader resources with the GPU.\n * @param shader - The shader to generate the code for\n * @param shaderSystem - An instance of the shader system\n * @internal\n */\nexport function generateShaderSyncCode(shader: Shader, shaderSystem: GlShaderSystem): ShaderSyncFunction\n{\n    const funcFragments: string[] = [];\n\n    /**\n     * rS = renderer.shader\n     * sS = shaderSystem\n     * sD = shaderData\n     * g = shader.groups\n     * s = shader\n     * r = renderer\n     * ugS = renderer.uniformGroupSystem\n     */\n    const headerFragments: string[] = [`\n        var g = s.groups;\n        var sS = r.shader;\n        var p = s.glProgram;\n        var ugS = r.uniformGroup;\n        var resources;\n    `];\n\n    let addedTextreSystem = false;\n    let textureCount = 0;\n\n    const programData = shaderSystem._getProgramData(shader.glProgram);\n\n    for (const i in shader.groups)\n    {\n        const group = shader.groups[i];\n\n        funcFragments.push(`\n            resources = g[${i}].resources;\n        `);\n\n        for (const j in group.resources)\n        {\n            const resource = group.resources[j];\n\n            if (resource instanceof UniformGroup)\n            {\n                if (resource.ubo)\n                {\n                    const resName = shader._uniformBindMap[i][Number(j)];\n\n                    funcFragments.push(`\n                        sS.bindUniformBlock(\n                            resources[${j}],\n                            '${resName}',\n                            ${shader.glProgram._uniformBlockData[resName].index}\n                        );\n                    `);\n                }\n                else\n                {\n                    funcFragments.push(`\n                        ugS.updateUniformGroup(resources[${j}], p, sD);\n                    `);\n                }\n            }\n            else if (resource instanceof BufferResource)\n            {\n                const resName = shader._uniformBindMap[i][Number(j)];\n\n                funcFragments.push(`\n                    sS.bindUniformBlock(\n                        resources[${j}],\n                        '${resName}',\n                        ${shader.glProgram._uniformBlockData[resName].index}\n                    );\n                `);\n            }\n            else if (resource instanceof TextureSource)\n            {\n                const uniformName = shader._uniformBindMap[i as unknown as number][j as unknown as number];\n\n                const uniformData = programData.uniformData[uniformName];\n\n                if (uniformData)\n                {\n                    if (!addedTextreSystem)\n                    {\n                        addedTextreSystem = true;\n                        headerFragments.push(`\n                        var tS = r.texture;\n                        `);\n                    }\n\n                    shaderSystem._gl.uniform1i(uniformData.location, textureCount);\n\n                    funcFragments.push(`\n                        tS.bind(resources[${j}], ${textureCount});\n                    `);\n\n                    textureCount++;\n                }\n            }\n        }\n    }\n\n    const functionSource = [...headerFragments, ...funcFragments].join('\\n');\n\n    // eslint-disable-next-line no-new-func\n    return new Function('r', 's', 'sD', functionSource) as ShaderSyncFunction;\n}\n","// cu = Cached value's uniform data field\n// cv = Cached value\n// v = value to upload\n// ud = uniformData\n// uv = uniformValue\n\nimport type { UNIFORM_TYPES } from '../../../shared/shader/types';\n\n/** @internal */\nexport const UNIFORM_TO_SINGLE_SETTERS: Record<UNIFORM_TYPES | string, string> = {\n    f32: `if (cv !== v) {\n            cu.value = v;\n            gl.uniform1f(location, v);\n        }`,\n    'vec2<f32>': `if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2f(location, v[0], v[1]);\n        }`,\n    'vec3<f32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3f(location, v[0], v[1], v[2]);\n        }`,\n    'vec4<f32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n        }`,\n    i32: `if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }`,\n    'vec2<i32>': `if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }`,\n    'vec3<i32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }`,\n    'vec4<i32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }`,\n    u32: `if (cv !== v) {\n            cu.value = v;\n            gl.uniform1ui(location, v);\n        }`,\n    'vec2<u32>': `if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2ui(location, v[0], v[1]);\n        }`,\n    'vec3<u32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3ui(location, v[0], v[1], v[2]);\n        }`,\n    'vec4<u32>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n        }`,\n    bool: `if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }`,\n    'vec2<bool>': `if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }`,\n    'vec3<bool>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }`,\n    'vec4<bool>': `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }`,\n    'mat2x2<f32>': `gl.uniformMatrix2fv(location, false, v);`,\n    'mat3x3<f32>': `gl.uniformMatrix3fv(location, false, v);`,\n    'mat4x4<f32>': `gl.uniformMatrix4fv(location, false, v);`,\n};\n\n/** @internal */\nexport const UNIFORM_TO_ARRAY_SETTERS: Record<UNIFORM_TYPES | string, string> = {\n    f32: `gl.uniform1fv(location, v);`,\n    'vec2<f32>': `gl.uniform2fv(location, v);`,\n    'vec3<f32>': `gl.uniform3fv(location, v);`,\n    'vec4<f32>': `gl.uniform4fv(location, v);`,\n    'mat2x2<f32>': `gl.uniformMatrix2fv(location, false, v);`,\n    'mat3x3<f32>': `gl.uniformMatrix3fv(location, false, v);`,\n    'mat4x4<f32>': `gl.uniformMatrix4fv(location, false, v);`,\n    i32: `gl.uniform1iv(location, v);`,\n    'vec2<i32>': `gl.uniform2iv(location, v);`,\n    'vec3<i32>': `gl.uniform3iv(location, v);`,\n    'vec4<i32>': `gl.uniform4iv(location, v);`,\n    u32: `gl.uniform1iv(location, v);`,\n    'vec2<u32>': `gl.uniform2iv(location, v);`,\n    'vec3<u32>': `gl.uniform3iv(location, v);`,\n    'vec4<u32>': `gl.uniform4iv(location, v);`,\n    bool: `gl.uniform1iv(location, v);`,\n    'vec2<bool>': `gl.uniform2iv(location, v);`,\n    'vec3<bool>': `gl.uniform3iv(location, v);`,\n    'vec4<bool>': `gl.uniform4iv(location, v);`,\n};\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { generateUniformsSync } from './utils/generateUniformsSync';\n\nimport type { UniformsSyncCallback } from '../../shared/shader/types';\nimport type { UniformGroup } from '../../shared/shader/UniformGroup';\nimport type { System } from '../../shared/system/System';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\nimport type { WebGLRenderer } from '../WebGLRenderer';\nimport type { GlProgram, GlUniformData } from './GlProgram';\n\n/**\n * System plugin to the renderer to manage shaders.\n * @category rendering\n * @advanced\n */\nexport class GlUniformGroupSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'uniformGroup',\n    } as const;\n\n    /**\n     * The current WebGL rendering context.\n     * @type {WebGLRenderingContext}\n     */\n    protected gl: GlRenderingContext;\n\n    /** Cache to holds the generated functions. Stored against UniformObjects unique signature. */\n    private _cache: Record<string, UniformsSyncCallback> = {};\n    private _renderer: WebGLRenderer;\n\n    private _uniformGroupSyncHash: Record<string, Record<string, UniformsSyncCallback>> = {};\n\n    /** @param renderer - The renderer this System works for. */\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n\n        this.gl = null;\n        this._cache = {};\n    }\n\n    protected contextChange(gl: GlRenderingContext): void\n    {\n        this.gl = gl;\n    }\n\n    /**\n     * Uploads the uniforms values to the currently bound shader.\n     * @param group - the uniforms values that be applied to the current shader\n     * @param program\n     * @param syncData\n     * @param syncData.textureCount\n     */\n    public updateUniformGroup(group: UniformGroup, program: GlProgram, syncData: { textureCount: number }): void\n    {\n        const programData = this._renderer.shader._getProgramData(program);\n\n        if (!group.isStatic || group._dirtyId !== programData.uniformDirtyGroups[group.uid])\n        {\n            programData.uniformDirtyGroups[group.uid] = group._dirtyId;\n\n            const syncFunc = this._getUniformSyncFunction(group, program);\n\n            syncFunc(programData.uniformData, group.uniforms, this._renderer, syncData);\n        }\n    }\n\n    /**\n     * Overridable by the pixi.js/unsafe-eval package to use static syncUniforms instead.\n     * @param group\n     * @param program\n     */\n    private _getUniformSyncFunction(group: UniformGroup, program: GlProgram): UniformsSyncCallback\n    {\n        return this._uniformGroupSyncHash[group._signature]?.[program._key]\n            || this._createUniformSyncFunction(group, program);\n    }\n\n    private _createUniformSyncFunction(group: UniformGroup, program: GlProgram): UniformsSyncCallback\n    {\n        const uniformGroupSyncHash = this._uniformGroupSyncHash[group._signature]\n            || (this._uniformGroupSyncHash[group._signature] = {});\n\n        const id = this._getSignature(group, program._uniformData, 'u');\n\n        if (!this._cache[id])\n        {\n            this._cache[id] = this._generateUniformsSync(group, program._uniformData);\n        }\n\n        uniformGroupSyncHash[program._key] = this._cache[id];\n\n        return uniformGroupSyncHash[program._key];\n    }\n\n    private _generateUniformsSync(group: UniformGroup, uniformData: Record<string, GlUniformData>): UniformsSyncCallback\n    {\n        return generateUniformsSync(group, uniformData);\n    }\n\n    /**\n     * Takes a uniform group and data and generates a unique signature for them.\n     * @param group - The uniform group to get signature of\n     * @param group.uniforms\n     * @param uniformData - Uniform information generated by the shader\n     * @param preFix\n     * @returns Unique signature of the uniform group\n     */\n    private _getSignature(group: UniformGroup, uniformData: Record<string, any>, preFix: string): string\n    {\n        const uniforms = group.uniforms;\n\n        const strings = [`${preFix}-`];\n\n        for (const i in uniforms)\n        {\n            strings.push(i);\n\n            if (uniformData[i])\n            {\n                strings.push(uniformData[i].type);\n            }\n        }\n\n        return strings.join('-');\n    }\n\n    /** Destroys this System and removes all its textures. */\n    public destroy(): void\n    {\n        this._renderer = null;\n        this._cache = null;\n    }\n}\n","// cu = Cached value's uniform data field\n// cv = Cached value\n// v = value to upload\n// ud = uniformData\n// uv = uniformValue\n\nimport { BufferResource } from '../../../shared/buffer/BufferResource';\nimport { UniformGroup } from '../../../shared/shader/UniformGroup';\nimport { uniformParsers } from '../../../shared/shader/utils/uniformParsers';\nimport { UNIFORM_TO_ARRAY_SETTERS, UNIFORM_TO_SINGLE_SETTERS } from './generateUniformsSyncTypes';\n\nimport type { UniformsSyncCallback } from '../../../shared/shader/types';\n\n/**\n * @param group\n * @param uniformData\n * @internal\n */\nexport function generateUniformsSync(group: UniformGroup, uniformData: Record<string, any>): UniformsSyncCallback\n{\n    const funcFragments = [`\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n        var name = null;\n    `];\n\n    for (const i in group.uniforms)\n    {\n        if (!uniformData[i])\n        {\n            if (group.uniforms[i] instanceof UniformGroup)\n            {\n                if ((group.uniforms[i] as UniformGroup).ubo)\n                {\n                    funcFragments.push(`\n                        renderer.shader.bindUniformBlock(uv.${i}, \"${i}\");\n                    `);\n                }\n                else\n                {\n                    funcFragments.push(`\n                        renderer.shader.updateUniformGroup(uv.${i});\n                    `);\n                }\n            }\n            else if (group.uniforms[i] instanceof BufferResource)\n            {\n                funcFragments.push(`\n                        renderer.shader.bindBufferResource(uv.${i}, \"${i}\");\n                    `);\n            }\n\n            continue;\n        }\n\n        const uniform = group.uniformStructures[i];\n\n        let parsed = false;\n\n        for (let j = 0; j < uniformParsers.length; j++)\n        {\n            const parser = uniformParsers[j];\n\n            if (uniform.type === parser.type && parser.test(uniform))\n            {\n                funcFragments.push(`name = \"${i}\";`, uniformParsers[j].uniform);\n                parsed = true;\n\n                break;\n            }\n        }\n\n        if (!parsed)\n        {\n            const templateType = uniform.size === 1 ? UNIFORM_TO_SINGLE_SETTERS : UNIFORM_TO_ARRAY_SETTERS;\n\n            const template = templateType[uniform.type].replace('location', `ud[\"${i}\"].location`);\n\n            funcFragments.push(`\n            cu = ud[\"${i}\"];\n            cv = cu.value;\n            v = uv[\"${i}\"];\n            ${template};`);\n        }\n    }\n\n    /*\n     * the introduction of syncData is to solve an issue where textures in uniform groups are not set correctly\n     * the texture count was always starting from 0 in each group. This needs to increment each time a texture is used\n     * no matter which group is being used\n     *\n     */\n    // eslint-disable-next-line no-new-func\n    return new Function('ud', 'uv', 'renderer', 'syncData', funcFragments.join('\\n')) as UniformsSyncCallback;\n}\n","import { ExtensionType } from '../../../../extensions/Extensions';\nimport { type RenderTarget } from '../../shared/renderTarget/RenderTarget';\nimport { State } from '../../shared/state/State';\nimport { type WebGLRenderer } from '../WebGLRenderer';\nimport { mapWebGLBlendModesToPixi } from './mapWebGLBlendModesToPixi';\n\nimport type { BLEND_MODES } from '../../shared/state/const';\nimport type { System } from '../../shared/system/System';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\n\nconst BLEND = 0;\nconst OFFSET = 1;\nconst CULLING = 2;\nconst DEPTH_TEST = 3;\nconst WINDING = 4;\nconst DEPTH_MASK = 5;\n\n/**\n * System plugin to the renderer to manage WebGL state machines\n * @category rendering\n * @advanced\n */\nexport class GlStateSystem implements System\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'state',\n    } as const;\n\n    /**\n     * State ID\n     * @readonly\n     */\n    public stateId: number;\n\n    /**\n     * Polygon offset\n     * @readonly\n     */\n    public polygonOffset: number;\n\n    /**\n     * Blend mode\n     * @default 'none'\n     * @readonly\n     */\n    public blendMode: BLEND_MODES;\n\n    /** Whether current blend equation is different */\n    protected _blendEq: boolean;\n\n    /**\n     * GL context\n     * @type {WebGLRenderingContext}\n     * @readonly\n     */\n    protected gl: GlRenderingContext;\n\n    protected blendModesMap: Record<BLEND_MODES, number[]>;\n\n    /**\n     * Collection of calls\n     * @type {Function[]}\n     */\n    protected readonly map: ((value: boolean) => void)[];\n\n    /**\n     * Collection of check calls\n     * @type {Function[]}\n     */\n    protected readonly checks: ((system: this, state: State) => void)[];\n\n    /**\n     * Default WebGL State\n     * @readonly\n     */\n    protected defaultState: State;\n\n    /**\n     * Whether to invert the front face when rendering\n     * This is used for render textures where the Y-coordinate is flipped\n     * @default false\n     */\n    private _invertFrontFace: boolean = false;\n    private _glFrontFace: boolean;\n    private _cullFace: boolean;\n    private _frontFaceDirty: boolean;\n    private _frontFace: boolean;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this.gl = null;\n\n        this.stateId = 0;\n        this.polygonOffset = 0;\n        this.blendMode = 'none';\n\n        this._blendEq = false;\n\n        // map functions for when we set state..\n        this.map = [];\n        this.map[BLEND] = this.setBlend;\n        this.map[OFFSET] = this.setOffset;\n        this.map[CULLING] = this.setCullFace;\n        this.map[DEPTH_TEST] = this.setDepthTest;\n        this.map[WINDING] = this.setFrontFace;\n        this.map[DEPTH_MASK] = this.setDepthMask;\n\n        this.checks = [];\n\n        this.defaultState = State.for2d();\n\n        // listen for when the renderTarget changes\n        // as rendering to textures means we need to invert the front face\n        renderer.renderTarget.onRenderTargetChange.add(this);\n    }\n\n    protected onRenderTargetChange(renderTarget: RenderTarget)\n    {\n        this._invertFrontFace = !renderTarget.isRoot;\n\n        // mini optimization to avoid setting the front face if culling is disabled\n        if (this._cullFace)\n        {\n            // need to set the front face to the requested value as it matters because of the culling is active!\n            this.setFrontFace(this._frontFace);\n        }\n        else\n        {\n            // if culling is disabled, we need to set the front face dirty\n            this._frontFaceDirty = true;\n        }\n    }\n\n    protected contextChange(gl: GlRenderingContext): void\n    {\n        this.gl = gl;\n\n        this.blendModesMap = mapWebGLBlendModesToPixi(gl);\n\n        // Reset face culling variables\n\n        this.resetState();\n    }\n\n    /**\n     * Sets the current state\n     * @param {*} state - The state to set.\n     */\n    public set(state: State): void\n    {\n        state ||= this.defaultState;\n\n        // TODO maybe to an object check? ( this.state === state )?\n        if (this.stateId !== state.data)\n        {\n            let diff = this.stateId ^ state.data;\n            let i = 0;\n\n            // order from least to most common\n            while (diff)\n            {\n                if (diff & 1)\n                {\n                    // state change!\n                    this.map[i].call(this, !!(state.data & (1 << i)));\n                }\n\n                diff >>= 1;\n                i++;\n            }\n\n            this.stateId = state.data;\n        }\n\n        // based on the above settings we check for specific modes..\n        // for example if blend is active we check and set the blend modes\n        // or of polygon offset is active we check the poly depth.\n        for (let i = 0; i < this.checks.length; i++)\n        {\n            this.checks[i](this, state);\n        }\n    }\n\n    /**\n     * Sets the state, when previous state is unknown.\n     * @param {*} state - The state to set\n     */\n    public forceState(state: State): void\n    {\n        state ||= this.defaultState;\n        for (let i = 0; i < this.map.length; i++)\n        {\n            this.map[i].call(this, !!(state.data & (1 << i)));\n        }\n        for (let i = 0; i < this.checks.length; i++)\n        {\n            this.checks[i](this, state);\n        }\n\n        this.stateId = state.data;\n    }\n\n    /**\n     * Sets whether to enable or disable blending.\n     * @param value - Turn on or off WebGl blending.\n     */\n    public setBlend(value: boolean): void\n    {\n        this._updateCheck(GlStateSystem._checkBlendMode, value);\n\n        this.gl[value ? 'enable' : 'disable'](this.gl.BLEND);\n    }\n\n    /**\n     * Sets whether to enable or disable polygon offset fill.\n     * @param value - Turn on or off webgl polygon offset testing.\n     */\n    public setOffset(value: boolean): void\n    {\n        this._updateCheck(GlStateSystem._checkPolygonOffset, value);\n\n        this.gl[value ? 'enable' : 'disable'](this.gl.POLYGON_OFFSET_FILL);\n    }\n\n    /**\n     * Sets whether to enable or disable depth test.\n     * @param value - Turn on or off webgl depth testing.\n     */\n    public setDepthTest(value: boolean): void\n    {\n        this.gl[value ? 'enable' : 'disable'](this.gl.DEPTH_TEST);\n    }\n\n    /**\n     * Sets whether to enable or disable depth mask.\n     * @param value - Turn on or off webgl depth mask.\n     */\n    public setDepthMask(value: boolean): void\n    {\n        this.gl.depthMask(value);\n    }\n\n    /**\n     * Sets whether to enable or disable cull face.\n     * @param {boolean} value - Turn on or off webgl cull face.\n     */\n    public setCullFace(value: boolean): void\n    {\n        this._cullFace = value;\n        this.gl[value ? 'enable' : 'disable'](this.gl.CULL_FACE);\n\n        if (this._cullFace && this._frontFaceDirty)\n        {\n            // need to set the front face to the requested value as it matters because of the culling is active!\n            this.setFrontFace(this._frontFace);\n        }\n    }\n\n    /**\n     * Sets the gl front face.\n     * @param {boolean} value - true is clockwise and false is counter-clockwise\n     */\n    public setFrontFace(value: boolean): void\n    {\n        this._frontFace = value;\n        this._frontFaceDirty = false;\n        // If invertFrontFace is true, we invert the face direction\n        const faceMode = this._invertFrontFace ? !value : value;\n\n        if (this._glFrontFace !== faceMode)\n        {\n            this._glFrontFace = faceMode;\n            this.gl.frontFace(this.gl[faceMode ? 'CW' : 'CCW']);\n        }\n    }\n\n    /**\n     * Sets the blend mode.\n     * @param {number} value - The blend mode to set to.\n     */\n    public setBlendMode(value: BLEND_MODES): void\n    {\n        if (!this.blendModesMap[value])\n        {\n            value = 'normal';\n        }\n\n        if (value === this.blendMode)\n        {\n            return;\n        }\n\n        this.blendMode = value;\n\n        const mode = this.blendModesMap[value];\n        const gl = this.gl;\n\n        if (mode.length === 2)\n        {\n            gl.blendFunc(mode[0], mode[1]);\n        }\n        else\n        {\n            gl.blendFuncSeparate(mode[0], mode[1], mode[2], mode[3]);\n        }\n\n        if (mode.length === 6)\n        {\n            this._blendEq = true;\n            gl.blendEquationSeparate(mode[4], mode[5]);\n        }\n        else if (this._blendEq)\n        {\n            this._blendEq = false;\n            gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\n        }\n    }\n\n    /**\n     * Sets the polygon offset.\n     * @param {number} value - the polygon offset\n     * @param {number} scale - the polygon offset scale\n     */\n    public setPolygonOffset(value: number, scale: number): void\n    {\n        this.gl.polygonOffset(value, scale);\n    }\n\n    /** Resets all the logic and disables the VAOs. */\n    public resetState(): void\n    {\n        this._glFrontFace = false;\n        this._frontFace = false;\n        this._cullFace = false;\n        this._frontFaceDirty = false;\n        this._invertFrontFace = false;\n\n        this.gl.frontFace(this.gl.CCW);\n        this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, false);\n\n        this.forceState(this.defaultState);\n\n        this._blendEq = true;\n        // setting to '' means the blend mode will be set as soon as we set the first blend mode when rendering!\n        this.blendMode = '' as BLEND_MODES;\n        this.setBlendMode('normal');\n    }\n\n    /**\n     * Checks to see which updates should be checked based on which settings have been activated.\n     *\n     * For example, if blend is enabled then we should check the blend modes each time the state is changed\n     * or if polygon fill is activated then we need to check if the polygon offset changes.\n     * The idea is that we only check what we have too.\n     * @param func - the checking function to add or remove\n     * @param value - should the check function be added or removed.\n     */\n    private _updateCheck(func: (system: this, state: State) => void, value: boolean): void\n    {\n        const index = this.checks.indexOf(func);\n\n        if (value && index === -1)\n        {\n            this.checks.push(func);\n        }\n        else if (!value && index !== -1)\n        {\n            this.checks.splice(index, 1);\n        }\n    }\n\n    /**\n     * A private little wrapper function that we call to check the blend mode.\n     * @param system - the System to perform the state check on\n     * @param state - the state that the blendMode will pulled from\n     */\n    private static _checkBlendMode(system: GlStateSystem, state: State): void\n    {\n        system.setBlendMode(state.blendMode);\n    }\n\n    /**\n     * A private little wrapper function that we call to check the polygon offset.\n     * @param system - the System to perform the state check on\n     * @param state - the state that the blendMode will pulled from\n     */\n    private static _checkPolygonOffset(system: GlStateSystem, state: State): void\n    {\n        system.setPolygonOffset(1, state.polygonOffset);\n    }\n\n    /** @ignore */\n    public destroy(): void\n    {\n        this.gl = null;\n        this.checks.length = 0;\n    }\n}\n","import { DOMAdapter } from '../../../../environment/adapter';\n\nimport type { BLEND_MODES } from '../../shared/state/const';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\n\n/**\n * Maps gl blend combinations to WebGL.\n * @param gl\n * @returns {object} Map of gl blend combinations to WebGL.\n * @internal\n */\nexport function mapWebGLBlendModesToPixi(gl: GlRenderingContext): Record<BLEND_MODES, number[]>\n{\n    const blendMap: Partial<Record<BLEND_MODES, number[]>> = {};\n\n    // TODO - premultiply alpha would be different.\n    // add a boolean for that!\n    blendMap.normal = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];\n    blendMap.add = [gl.ONE, gl.ONE];\n    blendMap.multiply = [gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];\n    blendMap.screen = [gl.ONE, gl.ONE_MINUS_SRC_COLOR, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];\n    blendMap.none = [0, 0];\n\n    // not-premultiplied blend modes\n    blendMap['normal-npm'] = [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];\n    blendMap['add-npm'] = [gl.SRC_ALPHA, gl.ONE, gl.ONE, gl.ONE];\n    blendMap['screen-npm'] = [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_COLOR, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];\n\n    blendMap.erase = [gl.ZERO, gl.ONE_MINUS_SRC_ALPHA];\n\n    const isWebGl2 = !(gl instanceof DOMAdapter.get().getWebGLRenderingContext());\n\n    if (isWebGl2)\n    {\n        blendMap.min = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, gl.MIN, gl.MIN];\n        blendMap.max = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, gl.MAX, gl.MAX];\n    }\n    else\n    {\n        const ext = gl.getExtension('EXT_blend_minmax');\n\n        if (ext)\n        {\n            blendMap.min = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, ext.MIN_EXT, ext.MIN_EXT];\n            blendMap.max = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, ext.MAX_EXT, ext.MAX_EXT];\n        }\n    }\n\n    // TODO - implement if requested!\n    // composite operations\n    // array[BLEND_MODES.SRC_IN] = [gl.DST_ALPHA, gl.ZERO];\n    // array[BLEND_MODES.SRC_OUT] = [gl.ONE_MINUS_DST_ALPHA, gl.ZERO];\n    // array[BLEND_MODES.SRC_ATOP] = [gl.DST_ALPHA, gl.ONE_MINUS_SRC_ALPHA];\n    // array[BLEND_MODES.DST_OVER] = [gl.ONE_MINUS_DST_ALPHA, gl.ONE];\n    // array[BLEND_MODES.DST_IN] = [gl.ZERO, gl.SRC_ALPHA];\n    // array[BLEND_MODES.DST_OUT] = [gl.ZERO, gl.ONE_MINUS_SRC_ALPHA];\n    // array[BLEND_MODES.DST_ATOP] = [gl.ONE_MINUS_DST_ALPHA, gl.SRC_ALPHA];\n    // array[BLEND_MODES.XOR] = [gl.ONE_MINUS_DST_ALPHA, gl.ONE_MINUS_SRC_ALPHA];\n    // SUBTRACT from flash\n    // array[BLEND_MODES.SUBTRACT] = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, gl.FUNC_REVERSE_SUBTRACT, gl.FUNC_ADD];\n\n    return blendMap as Record<BLEND_MODES, number[]>;\n}\n","import { GL_FORMATS, GL_TARGETS, GL_TYPES } from './const';\n\n/**\n * Internal texture for WebGL context\n * @category rendering\n * @ignore\n */\nexport class GlTexture\n{\n    public target: GL_TARGETS = GL_TARGETS.TEXTURE_2D;\n\n    /** The WebGL texture. */\n    public texture: WebGLTexture;\n\n    /** Width of texture that was used in texImage2D. */\n    public width: number;\n\n    /** Height of texture that was used in texImage2D. */\n    public height: number;\n\n    /** Whether mip levels has to be generated. */\n    public mipmap: boolean;\n\n    /** Type copied from texture source. */\n    public type: number;\n\n    /** Type copied from texture source. */\n    public internalFormat: number;\n\n    /** Type of sampler corresponding to this texture. See {@link SAMPLER_TYPES} */\n    public samplerType: number;\n\n    public format: GL_FORMATS;\n\n    constructor(texture: WebGLTexture)\n    {\n        this.texture = texture;\n        this.width = -1;\n        this.height = -1;\n        this.type = GL_TYPES.UNSIGNED_BYTE;\n        this.internalFormat = GL_FORMATS.RGBA;\n        this.format = GL_FORMATS.RGBA;\n        this.samplerType = 0;\n    }\n}\n","import type { TextureSource } from '../../../shared/texture/sources/TextureSource';\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { GlTexture } from '../GlTexture';\nimport type { GLTextureUploader } from './GLTextureUploader';\n\n/** @internal */\nexport const glUploadBufferImageResource = {\n\n    id: 'buffer',\n\n    upload(source: TextureSource, glTexture: GlTexture, gl: GlRenderingContext)\n    {\n        if (glTexture.width === source.width || glTexture.height === source.height)\n        {\n            gl.texSubImage2D(\n                gl.TEXTURE_2D,\n                0,\n                0,\n                0,\n                source.width,\n                source.height,\n                glTexture.format,\n                glTexture.type,\n                source.resource\n            );\n        }\n        else\n        {\n            gl.texImage2D(\n                glTexture.target,\n                0,\n                glTexture.internalFormat,\n                source.width,\n                source.height,\n                0,\n                glTexture.format,\n                glTexture.type,\n                source.resource\n            );\n        }\n\n        glTexture.width = source.width;\n        glTexture.height = source.height;\n    }\n} as GLTextureUploader;\n\n","import type { CompressedSource } from '../../../shared/texture/sources/CompressedSource';\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { GlTexture } from '../GlTexture';\nimport type { GLTextureUploader } from './GLTextureUploader';\n\nconst compressedFormatMap: Record<string, boolean> = {\n    'bc1-rgba-unorm': true,\n    'bc1-rgba-unorm-srgb': true,\n    'bc2-rgba-unorm': true,\n    'bc2-rgba-unorm-srgb': true,\n    'bc3-rgba-unorm': true,\n    'bc3-rgba-unorm-srgb': true,\n    'bc4-r-unorm': true,\n    'bc4-r-snorm': true,\n    'bc5-rg-unorm': true,\n    'bc5-rg-snorm': true,\n    'bc6h-rgb-ufloat': true,\n    'bc6h-rgb-float': true,\n    'bc7-rgba-unorm': true,\n    'bc7-rgba-unorm-srgb': true,\n\n    // ETC2 compressed formats usable if \"texture-compression-etc2\" is both\n    // supported by the device/user agent and enabled in requestDevice.\n    'etc2-rgb8unorm': true,\n    'etc2-rgb8unorm-srgb': true,\n    'etc2-rgb8a1unorm': true,\n    'etc2-rgb8a1unorm-srgb': true,\n    'etc2-rgba8unorm': true,\n    'etc2-rgba8unorm-srgb': true,\n    'eac-r11unorm': true,\n    'eac-r11snorm': true,\n    'eac-rg11unorm': true,\n    'eac-rg11snorm': true,\n\n    // ASTC compressed formats usable if \"texture-compression-astc\" is both\n    // supported by the device/user agent and enabled in requestDevice.\n    'astc-4x4-unorm': true,\n    'astc-4x4-unorm-srgb': true,\n    'astc-5x4-unorm': true,\n    'astc-5x4-unorm-srgb': true,\n    'astc-5x5-unorm': true,\n    'astc-5x5-unorm-srgb': true,\n    'astc-6x5-unorm': true,\n    'astc-6x5-unorm-srgb': true,\n    'astc-6x6-unorm': true,\n    'astc-6x6-unorm-srgb': true,\n    'astc-8x5-unorm': true,\n    'astc-8x5-unorm-srgb': true,\n    'astc-8x6-unorm': true,\n    'astc-8x6-unorm-srgb': true,\n    'astc-8x8-unorm': true,\n    'astc-8x8-unorm-srgb': true,\n    'astc-10x5-unorm': true,\n    'astc-10x5-unorm-srgb': true,\n    'astc-10x6-unorm': true,\n    'astc-10x6-unorm-srgb': true,\n    'astc-10x8-unorm': true,\n    'astc-10x8-unorm-srgb': true,\n    'astc-10x10-unorm': true,\n    'astc-10x10-unorm-srgb': true,\n    'astc-12x10-unorm': true,\n    'astc-12x10-unorm-srgb': true,\n    'astc-12x12-unorm': true,\n    'astc-12x12-unorm-srgb': true,\n};\n\n/** @internal */\nexport const glUploadCompressedTextureResource = {\n\n    id: 'compressed',\n\n    upload(source: CompressedSource, glTexture: GlTexture, gl: GlRenderingContext)\n    {\n        gl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);\n\n        let mipWidth = source.pixelWidth;\n        let mipHeight = source.pixelHeight;\n\n        const compressed = !!compressedFormatMap[source.format];\n\n        for (let i = 0; i < source.resource.length; i++)\n        {\n            const levelBuffer = source.resource[i];\n\n            if (compressed)\n            {\n                gl.compressedTexImage2D(\n                    gl.TEXTURE_2D, i, glTexture.internalFormat,\n                    mipWidth, mipHeight, 0,\n                    levelBuffer\n                );\n            }\n            else\n            {\n                gl.texImage2D(\n                    gl.TEXTURE_2D, i, glTexture.internalFormat,\n                    mipWidth, mipHeight, 0,\n                    glTexture.format, glTexture.type,\n                    levelBuffer);\n            }\n\n            mipWidth = Math.max(mipWidth >> 1, 1);\n            mipHeight = Math.max(mipHeight >> 1, 1);\n        }\n    }\n} as GLTextureUploader;\n\n","import type { CanvasSource } from '../../../shared/texture/sources/CanvasSource';\nimport type { ImageSource } from '../../../shared/texture/sources/ImageSource';\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { GlTexture } from '../GlTexture';\nimport type { GLTextureUploader } from './GLTextureUploader';\n\n/** @internal */\nexport const glUploadImageResource = {\n\n    id: 'image',\n\n    upload(source: ImageSource | CanvasSource, glTexture: GlTexture, gl: GlRenderingContext, webGLVersion: number)\n    {\n        const glWidth = glTexture.width;\n        const glHeight = glTexture.height;\n\n        const textureWidth = source.pixelWidth;\n        const textureHeight = source.pixelHeight;\n\n        const resourceWidth = source.resourceWidth;\n        const resourceHeight = source.resourceHeight;\n\n        if (resourceWidth < textureWidth || resourceHeight < textureHeight)\n        {\n            if (glWidth !== textureWidth || glHeight !== textureHeight)\n            {\n                gl.texImage2D(\n                    glTexture.target,\n                    0,\n                    glTexture.internalFormat,\n                    textureWidth,\n                    textureHeight,\n                    0,\n                    glTexture.format,\n                    glTexture.type,\n                    null\n                );\n            }\n\n            if (webGLVersion === 2)\n            {\n                gl.texSubImage2D(\n                    gl.TEXTURE_2D,\n                    0,\n                    0,\n                    0,\n                    resourceWidth,\n                    resourceHeight,\n                    glTexture.format,\n                    glTexture.type,\n                    source.resource as TexImageSource\n                );\n            }\n            else\n            {\n                gl.texSubImage2D(\n                    gl.TEXTURE_2D,\n                    0,\n                    0,\n                    0,\n                    glTexture.format,\n                    glTexture.type,\n                    source.resource as TexImageSource\n                );\n            }\n        }\n        else if (glWidth === textureWidth && glHeight === textureHeight)\n        {\n            gl.texSubImage2D(\n                gl.TEXTURE_2D,\n                0,\n                0,\n                0,\n                glTexture.format,\n                glTexture.type,\n                source.resource as TexImageSource\n            );\n        }\n        else if (webGLVersion === 2)\n        {\n            gl.texImage2D(\n                glTexture.target,\n                0,\n                glTexture.internalFormat,\n                textureWidth,\n                textureHeight,\n                0,\n                glTexture.format,\n                glTexture.type,\n                source.resource as TexImageSource\n            );\n        }\n        else\n        {\n            gl.texImage2D(\n                glTexture.target,\n                0,\n                glTexture.internalFormat,\n                glTexture.format,\n                glTexture.type,\n                source.resource as TexImageSource\n            );\n        }\n\n        glTexture.width = textureWidth;\n        glTexture.height = textureHeight;\n    }\n} as GLTextureUploader;\n\n","import { glUploadImageResource } from './glUploadImageResource';\n\nimport type { VideoSource } from '../../../shared/texture/sources/VideoSource';\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { GlTexture } from '../GlTexture';\nimport type { GLTextureUploader } from './GLTextureUploader';\n\n/** @internal */\nexport const glUploadVideoResource = {\n\n    id: 'video',\n\n    upload(source: VideoSource, glTexture: GlTexture, gl: GlRenderingContext, webGLVersion: number)\n    {\n        if (!source.isValid)\n        {\n            gl.texImage2D(\n                glTexture.target,\n                0,\n                glTexture.internalFormat,\n                1,\n                1,\n                0,\n                glTexture.format,\n                glTexture.type,\n                null\n            );\n\n            return;\n        }\n\n        glUploadImageResource.upload(source, glTexture, gl, webGLVersion);\n    }\n} as GLTextureUploader;\n\n","/** @internal */\nexport const scaleModeToGlFilter = {\n    linear: 9729,\n    nearest: 9728,\n};\n\n/** @internal */\nexport const mipmapScaleModeToGlFilter = {\n    linear: {\n        linear: 9987,\n        nearest: 9985,\n    },\n    nearest: {\n        linear: 9986,\n        nearest: 9984,\n    }\n};\n\n/** @internal */\nexport const wrapModeToGlAddress = {\n    'clamp-to-edge': 33071,\n    repeat: 10497,\n    'mirror-repeat': 33648,\n};\n\n/** @internal */\nexport const compareModeToGlCompare = {\n    never: 512,\n    less: 513,\n    equal: 514,\n    'less-equal': 515,\n    greater: 516,\n    'not-equal': 517,\n    'greater-equal': 518,\n    always: 519,\n};\n\n","import {\n    compareModeToGlCompare,\n    mipmapScaleModeToGlFilter,\n    scaleModeToGlFilter,\n    wrapModeToGlAddress\n} from './pixiToGlMaps';\n\nimport type { TextureStyle } from '../../../shared/texture/TextureStyle';\n\n/**\n * @param style\n * @param gl\n * @param mipmaps\n * @param anisotropicExt\n * @param glFunctionName\n * @param firstParam\n * @param forceClamp\n * @param firstCreation\n * @internal\n */\nexport function applyStyleParams(\n    style: TextureStyle,\n    gl: WebGL2RenderingContext,\n    mipmaps: boolean,\n    // eslint-disable-next-line camelcase\n    anisotropicExt: EXT_texture_filter_anisotropic,\n    glFunctionName: 'samplerParameteri' | 'texParameteri',\n    firstParam: 3553 | WebGLSampler,\n    forceClamp: boolean,\n    /** if true we can skip setting certain values if the values is the same as the default gl values */\n    firstCreation: boolean\n)\n{\n    const castParam = firstParam as 3553;\n\n    if (!firstCreation\n        || style.addressModeU !== 'repeat'\n        || style.addressModeV !== 'repeat'\n        || style.addressModeW !== 'repeat'\n    )\n    {\n        // 1. set the wrapping mode\n        const wrapModeS = wrapModeToGlAddress[forceClamp ? 'clamp-to-edge' : style.addressModeU];\n        const wrapModeT = wrapModeToGlAddress[forceClamp ? 'clamp-to-edge' : style.addressModeV];\n        const wrapModeR = wrapModeToGlAddress[forceClamp ? 'clamp-to-edge' : style.addressModeW];\n\n        gl[glFunctionName](castParam, gl.TEXTURE_WRAP_S, wrapModeS);\n        gl[glFunctionName](castParam, gl.TEXTURE_WRAP_T, wrapModeT);\n\n        // does not exist in webGL1\n        if (gl.TEXTURE_WRAP_R) gl[glFunctionName](castParam, gl.TEXTURE_WRAP_R, wrapModeR);\n    }\n\n    if (!firstCreation || style.magFilter !== 'linear')\n    {\n        // 2. set the filtering mode\n        gl[glFunctionName](castParam, gl.TEXTURE_MAG_FILTER, scaleModeToGlFilter[style.magFilter]);\n    }\n\n    // assuming the currently bound texture is the one we want to set the filter for\n    // the only smelly part of this code, WebGPU is much better here :P\n    if (mipmaps)\n    {\n        if (!firstCreation || style.mipmapFilter !== 'linear')\n        {\n            const glFilterMode = mipmapScaleModeToGlFilter[style.minFilter][style.mipmapFilter];\n\n            gl[glFunctionName](castParam, gl.TEXTURE_MIN_FILTER, glFilterMode);\n        }\n    }\n\n    else\n    {\n        gl[glFunctionName](castParam, gl.TEXTURE_MIN_FILTER, scaleModeToGlFilter[style.minFilter]);\n    }\n\n    // 3. set the anisotropy\n    if (anisotropicExt && style.maxAnisotropy > 1)\n    {\n        const level = Math.min(style.maxAnisotropy, gl.getParameter(anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));\n\n        gl[glFunctionName](castParam, anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT, level);\n    }\n\n    // 4. set the compare mode\n    if (style.compare)\n    {\n        gl[glFunctionName](castParam, gl.TEXTURE_COMPARE_FUNC, compareModeToGlCompare[style.compare]);\n    }\n}\n","import { DOMAdapter } from '../../../../environment/adapter';\nimport { ExtensionType } from '../../../../extensions/Extensions';\nimport { Texture } from '../../shared/texture/Texture';\nimport { GlTexture } from './GlTexture';\nimport { glUploadBufferImageResource } from './uploaders/glUploadBufferImageResource';\nimport { glUploadCompressedTextureResource } from './uploaders/glUploadCompressedTextureResource';\nimport { glUploadImageResource } from './uploaders/glUploadImageResource';\nimport { glUploadVideoResource } from './uploaders/glUploadVideoResource';\nimport { applyStyleParams } from './utils/applyStyleParams';\nimport { mapFormatToGlFormat } from './utils/mapFormatToGlFormat';\nimport { mapFormatToGlInternalFormat } from './utils/mapFormatToGlInternalFormat';\nimport { mapFormatToGlType } from './utils/mapFormatToGlType';\nimport { unpremultiplyAlpha } from './utils/unpremultiplyAlpha';\n\nimport type { ICanvas } from '../../../../environment/canvas/ICanvas';\nimport type { System } from '../../shared/system/System';\nimport type { CanvasGenerator, GetPixelsOutput } from '../../shared/texture/GenerateCanvas';\nimport type { TextureSource } from '../../shared/texture/sources/TextureSource';\nimport type { BindableTexture } from '../../shared/texture/Texture';\nimport type { TextureStyle } from '../../shared/texture/TextureStyle';\nimport type { GlRenderingContext } from '../context/GlRenderingContext';\nimport type { WebGLRenderer } from '../WebGLRenderer';\nimport type { GLTextureUploader } from './uploaders/GLTextureUploader';\n\nconst BYTES_PER_PIXEL = 4;\n\n/**\n * The system for managing textures in WebGL.\n * @category rendering\n * @advanced\n */\nexport class GlTextureSystem implements System, CanvasGenerator\n{\n    /** @ignore */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLSystem,\n        ],\n        name: 'texture',\n    } as const;\n\n    public readonly managedTextures: TextureSource[] = [];\n\n    private readonly _renderer: WebGLRenderer;\n\n    private _glTextures: Record<number, GlTexture> = Object.create(null);\n    private _glSamplers: Record<string, WebGLSampler> = Object.create(null);\n\n    private _boundTextures: TextureSource[] = [];\n    private _activeTextureLocation = -1;\n\n    private _boundSamplers: Record<number, WebGLSampler> = Object.create(null);\n\n    private readonly _uploads: Record<string, GLTextureUploader> = {\n        image: glUploadImageResource,\n        buffer: glUploadBufferImageResource,\n        video: glUploadVideoResource,\n        compressed: glUploadCompressedTextureResource,\n    };\n\n    private _gl: GlRenderingContext;\n    private _mapFormatToInternalFormat: Record<string, number>;\n    private _mapFormatToType: Record<string, number>;\n    private _mapFormatToFormat: Record<string, number>;\n\n    private _premultiplyAlpha = false;\n\n    // TODO - separate samplers will be a cool thing to add, but not right now!\n    private readonly _useSeparateSamplers = false;\n\n    constructor(renderer: WebGLRenderer)\n    {\n        this._renderer = renderer;\n        this._renderer.renderableGC.addManagedHash(this, '_glTextures');\n        this._renderer.renderableGC.addManagedHash(this, '_glSamplers');\n    }\n\n    protected contextChange(gl: GlRenderingContext): void\n    {\n        this._gl = gl;\n\n        if (!this._mapFormatToInternalFormat)\n        {\n            this._mapFormatToInternalFormat = mapFormatToGlInternalFormat(gl, this._renderer.context.extensions);\n\n            this._mapFormatToType = mapFormatToGlType(gl);\n            this._mapFormatToFormat = mapFormatToGlFormat(gl);\n        }\n\n        this._glTextures = Object.create(null);\n        this._glSamplers = Object.create(null);\n        this._boundSamplers = Object.create(null);\n        this._premultiplyAlpha = false;\n\n        for (let i = 0; i < 16; i++)\n        {\n            this.bind(Texture.EMPTY, i);\n        }\n    }\n\n    /**\n     * Initializes a texture source, if it has already been initialized nothing will happen.\n     * @param source - The texture source to initialize.\n     * @returns The initialized texture source.\n     */\n    public initSource(source: TextureSource)\n    {\n        this.bind(source);\n    }\n\n    public bind(texture: BindableTexture, location = 0)\n    {\n        const source = texture.source;\n\n        if (texture)\n        {\n            this.bindSource(source, location);\n\n            if (this._useSeparateSamplers)\n            {\n                this._bindSampler(source.style, location);\n            }\n        }\n        else\n        {\n            this.bindSource(null, location);\n\n            if (this._useSeparateSamplers)\n            {\n                this._bindSampler(null, location);\n            }\n        }\n    }\n\n    public bindSource(source: TextureSource, location = 0): void\n    {\n        const gl = this._gl;\n\n        source._touched = this._renderer.textureGC.count;\n\n        if (this._boundTextures[location] !== source)\n        {\n            this._boundTextures[location] = source;\n            this._activateLocation(location);\n\n            source ||= Texture.EMPTY.source;\n\n            // bind texture and source!\n            const glTexture = this.getGlSource(source);\n\n            gl.bindTexture(glTexture.target, glTexture.texture);\n        }\n    }\n\n    private _bindSampler(style: TextureStyle, location = 0): void\n    {\n        const gl = this._gl;\n\n        if (!style)\n        {\n            this._boundSamplers[location] = null;\n            gl.bindSampler(location, null);\n\n            return;\n        }\n\n        const sampler = this._getGlSampler(style);\n\n        if (this._boundSamplers[location] !== sampler)\n        {\n            this._boundSamplers[location] = sampler;\n            gl.bindSampler(location, sampler);\n        }\n    }\n\n    public unbind(texture: BindableTexture): void\n    {\n        const source = texture.source;\n        const boundTextures = this._boundTextures;\n        const gl = this._gl;\n\n        for (let i = 0; i < boundTextures.length; i++)\n        {\n            if (boundTextures[i] === source)\n            {\n                this._activateLocation(i);\n\n                const glTexture = this.getGlSource(source);\n\n                gl.bindTexture(glTexture.target, null);\n                boundTextures[i] = null;\n            }\n        }\n    }\n\n    private _activateLocation(location: number): void\n    {\n        if (this._activeTextureLocation !== location)\n        {\n            this._activeTextureLocation = location;\n            this._gl.activeTexture(this._gl.TEXTURE0 + location);\n        }\n    }\n\n    private _initSource(source: TextureSource): GlTexture\n    {\n        const gl = this._gl;\n\n        const glTexture = new GlTexture(gl.createTexture());\n\n        glTexture.type = this._mapFormatToType[source.format];\n        glTexture.internalFormat = this._mapFormatToInternalFormat[source.format];\n        glTexture.format = this._mapFormatToFormat[source.format];\n\n        if (source.autoGenerateMipmaps && (this._renderer.context.supports.nonPowOf2mipmaps || source.isPowerOfTwo))\n        {\n            const biggestDimension = Math.max(source.width, source.height);\n\n            source.mipLevelCount = Math.floor(Math.log2(biggestDimension)) + 1;\n        }\n\n        this._glTextures[source.uid] = glTexture;\n\n        if (!this.managedTextures.includes(source))\n        {\n            source.on('update', this.onSourceUpdate, this);\n            source.on('resize', this.onSourceUpdate, this);\n            source.on('styleChange', this.onStyleChange, this);\n            source.on('destroy', this.onSourceDestroy, this);\n            source.on('unload', this.onSourceUnload, this);\n            source.on('updateMipmaps', this.onUpdateMipmaps, this);\n\n            this.managedTextures.push(source);\n        }\n\n        this.onSourceUpdate(source);\n        this.updateStyle(source, false);\n\n        return glTexture;\n    }\n\n    protected onStyleChange(source: TextureSource): void\n    {\n        this.updateStyle(source, false);\n    }\n\n    protected updateStyle(source: TextureSource, firstCreation: boolean): void\n    {\n        const gl = this._gl;\n\n        const glTexture = this.getGlSource(source);\n\n        gl.bindTexture(gl.TEXTURE_2D, glTexture.texture);\n\n        this._boundTextures[this._activeTextureLocation] = source;\n\n        applyStyleParams(\n            source.style,\n            gl,\n            source.mipLevelCount > 1,\n            this._renderer.context.extensions.anisotropicFiltering,\n            'texParameteri',\n            gl.TEXTURE_2D,\n            // will force a clamp to edge if the texture is not a power of two\n            !this._renderer.context.supports.nonPowOf2wrapping && !source.isPowerOfTwo,\n            firstCreation,\n        );\n    }\n\n    protected onSourceUnload(source: TextureSource): void\n    {\n        const glTexture = this._glTextures[source.uid];\n\n        if (!glTexture) return;\n\n        this.unbind(source);\n        this._glTextures[source.uid] = null;\n\n        this._gl.deleteTexture(glTexture.texture);\n    }\n\n    protected onSourceUpdate(source: TextureSource): void\n    {\n        const gl = this._gl;\n\n        const glTexture = this.getGlSource(source);\n\n        gl.bindTexture(gl.TEXTURE_2D, glTexture.texture);\n\n        this._boundTextures[this._activeTextureLocation] = source;\n\n        const premultipliedAlpha = source.alphaMode === 'premultiply-alpha-on-upload';\n\n        if (this._premultiplyAlpha !== premultipliedAlpha)\n        {\n            this._premultiplyAlpha = premultipliedAlpha;\n            gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultipliedAlpha);\n        }\n\n        if (this._uploads[source.uploadMethodId])\n        {\n            this._uploads[source.uploadMethodId].upload(source, glTexture, gl, this._renderer.context.webGLVersion);\n        }\n        else\n        {\n            // eslint-disable-next-line max-len\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, source.pixelWidth, source.pixelHeight, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        }\n\n        if (source.autoGenerateMipmaps && source.mipLevelCount > 1)\n        {\n            this.onUpdateMipmaps(source, false);\n        }\n    }\n\n    protected onUpdateMipmaps(source: TextureSource, bind = true): void\n    {\n        if (bind) this.bindSource(source, 0);\n\n        const glTexture = this.getGlSource(source);\n\n        this._gl.generateMipmap(glTexture.target);\n    }\n\n    protected onSourceDestroy(source: TextureSource): void\n    {\n        source.off('destroy', this.onSourceDestroy, this);\n        source.off('update', this.onSourceUpdate, this);\n        source.off('resize', this.onSourceUpdate, this);\n        source.off('unload', this.onSourceUnload, this);\n        source.off('styleChange', this.onStyleChange, this);\n        source.off('updateMipmaps', this.onUpdateMipmaps, this);\n\n        this.managedTextures.splice(this.managedTextures.indexOf(source), 1);\n\n        this.onSourceUnload(source);\n    }\n\n    private _initSampler(style: TextureStyle): WebGLSampler\n    {\n        const gl = this._gl;\n\n        const glSampler = this._gl.createSampler();\n\n        this._glSamplers[style._resourceId] = glSampler;\n\n        applyStyleParams(\n            style,\n            gl,\n            this._boundTextures[this._activeTextureLocation].mipLevelCount > 1,\n            this._renderer.context.extensions.anisotropicFiltering,\n            'samplerParameteri',\n            glSampler,\n            false,\n            true,\n        );\n\n        return this._glSamplers[style._resourceId];\n    }\n\n    private _getGlSampler(sampler: TextureStyle): WebGLSampler\n    {\n        return this._glSamplers[sampler._resourceId] || this._initSampler(sampler);\n    }\n\n    public getGlSource(source: TextureSource): GlTexture\n    {\n        return this._glTextures[source.uid] || this._initSource(source);\n    }\n\n    public generateCanvas(texture: Texture): ICanvas\n    {\n        const { pixels, width, height } = this.getPixels(texture);\n\n        const canvas = DOMAdapter.get().createCanvas();\n\n        canvas.width = width;\n        canvas.height = height;\n\n        const ctx = canvas.getContext('2d');\n\n        if (ctx)\n        {\n            const imageData = ctx.createImageData(width, height);\n\n            imageData.data.set(pixels);\n            ctx.putImageData(imageData, 0, 0);\n        }\n\n        return canvas;\n    }\n\n    public getPixels(texture: Texture): GetPixelsOutput\n    {\n        const resolution = texture.source.resolution;\n        const frame = texture.frame;\n\n        const width = Math.max(Math.round(frame.width * resolution), 1);\n        const height = Math.max(Math.round(frame.height * resolution), 1);\n        const pixels = new Uint8Array(BYTES_PER_PIXEL * width * height);\n\n        const renderer = this._renderer;\n\n        const renderTarget = renderer.renderTarget.getRenderTarget(texture);\n        const glRenterTarget = renderer.renderTarget.getGpuRenderTarget(renderTarget);\n\n        const gl = renderer.gl;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, glRenterTarget.resolveTargetFramebuffer);\n\n        gl.readPixels(\n            Math.round(frame.x * resolution),\n            Math.round(frame.y * resolution),\n            width,\n            height,\n            gl.RGBA,\n            gl.UNSIGNED_BYTE,\n            pixels\n        );\n\n        // if (texture.source.premultiplyAlpha > 0)\n        // TODO - premultiplied alpha does not exist right now, need to add that back in!\n        // eslint-disable-next-line no-constant-condition\n        if (false)\n        {\n            unpremultiplyAlpha(pixels);\n        }\n\n        return { pixels: new Uint8ClampedArray(pixels.buffer), width, height };\n    }\n\n    public destroy(): void\n    {\n        // we copy the array as the array with a slice as onSourceDestroy\n        // will remove the source from the real managedTextures array\n        this.managedTextures\n            .slice()\n            .forEach((source) => this.onSourceDestroy(source));\n\n        (this.managedTextures as null) = null;\n        this._glTextures = null;\n        this._glSamplers = null;\n        this._boundTextures = null;\n        this._boundSamplers = null;\n        this._mapFormatToInternalFormat = null;\n        this._mapFormatToType = null;\n        this._mapFormatToFormat = null;\n        (this._uploads as null) = null;\n        (this._renderer as null) = null;\n    }\n\n    public resetState(): void\n    {\n        this._activeTextureLocation = -1;\n        this._boundTextures.fill(Texture.EMPTY.source);\n        this._boundSamplers = Object.create(null);\n\n        const gl = this._gl;\n\n        this._premultiplyAlpha = false;\n\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this._premultiplyAlpha);\n    }\n}\n\n","import { DOMAdapter } from '../../../../../environment/adapter';\n\nimport type { GlRenderingContext } from '../../context/GlRenderingContext';\nimport type { WebGLExtensions } from '../../context/WebGLExtensions';\n\n/**\n * Returns a lookup table that maps each type-format pair to a compatible internal format.\n * @function mapTypeAndFormatToInternalFormat\n * @private\n * @param gl - The rendering context.\n * @param extensions - The WebGL extensions.\n * @returns Lookup table.\n */\nexport function mapFormatToGlInternalFormat(\n    gl: GlRenderingContext,\n    extensions: WebGLExtensions,\n): Record<string, number>\n{\n    let srgb = {};\n    let bgra8unorm: number = gl.RGBA;\n\n    if (!(gl instanceof DOMAdapter.get().getWebGLRenderingContext()))\n    {\n        srgb = {\n            'rgba8unorm-srgb': gl.SRGB8_ALPHA8,\n            'bgra8unorm-srgb': gl.SRGB8_ALPHA8,\n        };\n\n        bgra8unorm = gl.RGBA8;\n    }\n    else if (extensions.srgb)\n    {\n        srgb = {\n            'rgba8unorm-srgb': extensions.srgb.SRGB8_ALPHA8_EXT,\n            'bgra8unorm-srgb': extensions.srgb.SRGB8_ALPHA8_EXT,\n        };\n    }\n\n    return {\n        // 8-bit formats\n        r8unorm: gl.R8,\n        r8snorm: gl.R8_SNORM,\n        r8uint: gl.R8UI,\n        r8sint: gl.R8I,\n\n        // 16-bit formats\n        r16uint: gl.R16UI,\n        r16sint: gl.R16I,\n        r16float: gl.R16F,\n        rg8unorm: gl.RG8,\n        rg8snorm: gl.RG8_SNORM,\n        rg8uint: gl.RG8UI,\n        rg8sint: gl.RG8I,\n\n        // 32-bit formats\n        r32uint: gl.R32UI,\n        r32sint: gl.R32I,\n        r32float: gl.R32F,\n        rg16uint: gl.RG16UI,\n        rg16sint: gl.RG16I,\n        rg16float: gl.RG16F,\n        rgba8unorm: gl.RGBA,\n\n        ...srgb,\n\n        // Packed 32-bit formats\n        rgba8snorm: gl.RGBA8_SNORM,\n        rgba8uint: gl.RGBA8UI,\n        rgba8sint: gl.RGBA8I,\n        bgra8unorm,\n        rgb9e5ufloat: gl.RGB9_E5,\n        rgb10a2unorm: gl.RGB10_A2,\n        rg11b10ufloat: gl.R11F_G11F_B10F,\n\n        // 64-bit formats\n        rg32uint: gl.RG32UI,\n        rg32sint: gl.RG32I,\n        rg32float: gl.RG32F,\n        rgba16uint: gl.RGBA16UI,\n        rgba16sint: gl.RGBA16I,\n        rgba16float: gl.RGBA16F,\n\n        // 128-bit formats\n        rgba32uint: gl.RGBA32UI,\n        rgba32sint: gl.RGBA32I,\n        rgba32float: gl.RGBA32F,\n\n        // Depth/stencil formats\n        stencil8: gl.STENCIL_INDEX8,\n        depth16unorm: gl.DEPTH_COMPONENT16,\n        depth24plus: gl.DEPTH_COMPONENT24,\n        'depth24plus-stencil8': gl.DEPTH24_STENCIL8,\n        depth32float: gl.DEPTH_COMPONENT32F,\n        'depth32float-stencil8': gl.DEPTH32F_STENCIL8,\n\n        // Compressed formats\n        ...extensions.s3tc ? {\n            'bc1-rgba-unorm': extensions.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,\n            'bc2-rgba-unorm': extensions.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,\n            'bc3-rgba-unorm': extensions.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT,\n        } : {},\n        ...extensions.s3tc_sRGB ? {\n            'bc1-rgba-unorm-srgb': extensions.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,\n            'bc2-rgba-unorm-srgb': extensions.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,\n            'bc3-rgba-unorm-srgb': extensions.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,\n        } : {},\n        ...extensions.rgtc ? {\n            'bc4-r-unorm': extensions.rgtc.COMPRESSED_RED_RGTC1_EXT,\n            'bc4-r-snorm': extensions.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,\n            'bc5-rg-unorm': extensions.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,\n            'bc5-rg-snorm': extensions.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT,\n        } : {},\n        ...extensions.bptc ? {\n            'bc6h-rgb-float': extensions.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,\n            'bc6h-rgb-ufloat': extensions.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,\n            'bc7-rgba-unorm': extensions.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,\n            'bc7-rgba-unorm-srgb': extensions.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT,\n        } : {},\n        ...extensions.etc ? {\n            'etc2-rgb8unorm': extensions.etc.COMPRESSED_RGB8_ETC2,\n            'etc2-rgb8unorm-srgb': extensions.etc.COMPRESSED_SRGB8_ETC2,\n            'etc2-rgb8a1unorm': extensions.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,\n            'etc2-rgb8a1unorm-srgb': extensions.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,\n            'etc2-rgba8unorm': extensions.etc.COMPRESSED_RGBA8_ETC2_EAC,\n            'etc2-rgba8unorm-srgb': extensions.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,\n            'eac-r11unorm': extensions.etc.COMPRESSED_R11_EAC,\n            // 'eac-r11snorm'\n            'eac-rg11unorm': extensions.etc.COMPRESSED_SIGNED_RG11_EAC,\n            // 'eac-rg11snorm'\n        } : {},\n        ...extensions.astc ? {\n            'astc-4x4-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,\n            'astc-4x4-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,\n            'astc-5x4-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,\n            'astc-5x4-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,\n            'astc-5x5-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,\n            'astc-5x5-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,\n            'astc-6x5-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,\n            'astc-6x5-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,\n            'astc-6x6-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,\n            'astc-6x6-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,\n            'astc-8x5-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,\n            'astc-8x5-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,\n            'astc-8x6-unorm':   extensions.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,\n            'astc-8x6-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,\n            'astc-8x8-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,\n            'astc-8x8-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,\n            'astc-10x5-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,\n            'astc-10x5-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,\n            'astc-10x6-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,\n            'astc-10x6-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,\n            'astc-10x8-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,\n            'astc-10x8-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,\n            'astc-10x10-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,\n            'astc-10x10-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,\n            'astc-12x10-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,\n            'astc-12x10-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,\n            'astc-12x12-unorm': extensions.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,\n            'astc-12x12-unorm-srgb': extensions.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR,\n        } : {},\n    };\n}\n","import type { GlRenderingContext } from '../../context/GlRenderingContext';\n\n/**\n * Returns a lookup table that maps each type-format pair to a compatible internal format.\n * @function mapTypeAndFormatToInternalFormat\n * @private\n * @param {WebGLRenderingContext} gl - The rendering context.\n * @returns Lookup table.\n */\nexport function mapFormatToGlType(gl: GlRenderingContext): Record<string, number>\n{\n    return {\n        // 8-bit formats\n        r8unorm: gl.UNSIGNED_BYTE,\n        r8snorm: gl.BYTE,\n        r8uint: gl.UNSIGNED_BYTE,\n        r8sint: gl.BYTE,\n\n        // 16-bit formats\n        r16uint: gl.UNSIGNED_SHORT,\n        r16sint: gl.SHORT,\n        r16float: gl.HALF_FLOAT,\n        rg8unorm: gl.UNSIGNED_BYTE,\n        rg8snorm: gl.BYTE,\n        rg8uint: gl.UNSIGNED_BYTE,\n        rg8sint: gl.BYTE,\n\n        // 32-bit formats\n        r32uint: gl.UNSIGNED_INT,\n        r32sint: gl.INT,\n        r32float: gl.FLOAT,\n        rg16uint: gl.UNSIGNED_SHORT,\n        rg16sint: gl.SHORT,\n        rg16float: gl.HALF_FLOAT,\n        rgba8unorm: gl.UNSIGNED_BYTE,\n        'rgba8unorm-srgb': gl.UNSIGNED_BYTE,\n\n        // Packed 32-bit formats\n        rgba8snorm: gl.BYTE,\n        rgba8uint: gl.UNSIGNED_BYTE,\n        rgba8sint: gl.BYTE,\n        bgra8unorm: gl.UNSIGNED_BYTE,\n        'bgra8unorm-srgb': gl.UNSIGNED_BYTE,\n        rgb9e5ufloat: gl.UNSIGNED_INT_5_9_9_9_REV,\n        rgb10a2unorm: gl.UNSIGNED_INT_2_10_10_10_REV,\n        rg11b10ufloat: gl.UNSIGNED_INT_10F_11F_11F_REV,\n\n        // 64-bit formats\n        rg32uint: gl.UNSIGNED_INT,\n        rg32sint: gl.INT,\n        rg32float: gl.FLOAT,\n        rgba16uint: gl.UNSIGNED_SHORT,\n        rgba16sint: gl.SHORT,\n        rgba16float: gl.HALF_FLOAT,\n\n        // 128-bit formats\n        rgba32uint: gl.UNSIGNED_INT,\n        rgba32sint: gl.INT,\n        rgba32float: gl.FLOAT,\n\n        // Depth/stencil formats\n        stencil8: gl.UNSIGNED_BYTE,\n        depth16unorm: gl.UNSIGNED_SHORT,\n        depth24plus: gl.UNSIGNED_INT,\n        'depth24plus-stencil8': gl.UNSIGNED_INT_24_8,\n        depth32float: gl.FLOAT,\n        'depth32float-stencil8': gl.FLOAT_32_UNSIGNED_INT_24_8_REV,\n\n    };\n}\n","import type { GlRenderingContext } from '../../context/GlRenderingContext';\n\n/**\n * Returns a lookup table that maps each type-format pair to a compatible internal format.\n * @function mapTypeAndFormatToInternalFormat\n * @private\n * @param {WebGLRenderingContext} gl - The rendering context.\n * @returns Lookup table.\n */\nexport function mapFormatToGlFormat(gl: GlRenderingContext): Record<string, number>\n{\n    return {\n        // 8-bit formats\n        r8unorm: gl.RED,\n        r8snorm: gl.RED,\n        r8uint: gl.RED,\n        r8sint: gl.RED,\n\n        // 16-bit formats\n        r16uint: gl.RED,\n        r16sint:    gl.RED,\n        r16float: gl.RED,\n        rg8unorm:  gl.RG,\n        rg8snorm:   gl.RG,\n        rg8uint:  gl.RG,\n        rg8sint:  gl.RG,\n\n        // 32-bit formats\n        r32uint: gl.RED,\n        r32sint: gl.RED,\n        r32float: gl.RED,\n        rg16uint:   gl.RG,\n        rg16sint:  gl.RG,\n        rg16float:  gl.RG,\n        rgba8unorm: gl.RGBA,\n        'rgba8unorm-srgb': gl.RGBA,\n\n        // Packed 32-bit formats\n        rgba8snorm: gl.RGBA,\n        rgba8uint: gl.RGBA,\n        rgba8sint: gl.RGBA,\n        bgra8unorm: gl.RGBA,\n        'bgra8unorm-srgb': gl.RGBA,\n        rgb9e5ufloat: gl.RGB,\n        rgb10a2unorm: gl.RGBA,\n        rg11b10ufloat: gl.RGB,\n\n        // 64-bit formats\n        rg32uint: gl.RG,\n        rg32sint: gl.RG,\n        rg32float:  gl.RG,\n        rgba16uint: gl.RGBA,\n        rgba16sint: gl.RGBA,\n        rgba16float: gl.RGBA,\n\n        // 128-bit formats\n        rgba32uint: gl.RGBA,\n        rgba32sint: gl.RGBA,\n        rgba32float: gl.RGBA,\n\n        // Depth/stencil formats\n        stencil8: gl.STENCIL_INDEX8,\n        depth16unorm: gl.DEPTH_COMPONENT,\n        depth24plus: gl.DEPTH_COMPONENT,\n        'depth24plus-stencil8': gl.DEPTH_STENCIL,\n        depth32float: gl.DEPTH_COMPONENT,\n        'depth32float-stencil8': gl.DEPTH_STENCIL,\n\n    };\n}\n","import { extensions, ExtensionType } from '../../../extensions/Extensions';\nimport { GlGraphicsAdaptor } from '../../../scene/graphics/gl/GlGraphicsAdaptor';\nimport { GlMeshAdaptor } from '../../../scene/mesh/gl/GlMeshAdaptor';\nimport { GlBatchAdaptor } from '../../batcher/gl/GlBatchAdaptor';\nimport { AbstractRenderer } from '../shared/system/AbstractRenderer';\nimport { SharedRenderPipes, SharedSystems } from '../shared/system/SharedSystems';\nimport { RendererType } from '../types';\nimport { GlBufferSystem } from './buffer/GlBufferSystem';\nimport { GlContextSystem } from './context/GlContextSystem';\nimport { GlGeometrySystem } from './geometry/GlGeometrySystem';\nimport { GlBackBufferSystem } from './GlBackBufferSystem';\nimport { GlColorMaskSystem } from './GlColorMaskSystem';\nimport { GlEncoderSystem } from './GlEncoderSystem';\nimport { GlLimitsSystem } from './GlLimitsSystem';\nimport { GlStencilSystem } from './GlStencilSystem';\nimport { GlUboSystem } from './GlUboSystem';\nimport { GlRenderTargetSystem } from './renderTarget/GlRenderTargetSystem';\nimport { GlShaderSystem } from './shader/GlShaderSystem';\nimport { GlUniformGroupSystem } from './shader/GlUniformGroupSystem';\nimport { GlStateSystem } from './state/GlStateSystem';\nimport { GlTextureSystem } from './texture/GlTextureSystem';\n\nimport type { ICanvas } from '../../../environment/canvas/ICanvas';\nimport type { PipeConstructor } from '../shared/instructions/RenderPipe';\nimport type { SharedRendererOptions } from '../shared/system/SharedSystems';\nimport type { SystemConstructor } from '../shared/system/System';\nimport type { ExtractRendererOptions, ExtractSystemTypes } from '../shared/system/utils/typeUtils';\nimport type { GlRenderingContext } from './context/GlRenderingContext';\n\nconst DefaultWebGLSystems = [\n    ...SharedSystems,\n    GlUboSystem,\n    GlBackBufferSystem,\n    GlContextSystem,\n    GlLimitsSystem,\n    GlBufferSystem,\n    GlTextureSystem,\n    GlRenderTargetSystem,\n    GlGeometrySystem,\n    GlUniformGroupSystem,\n    GlShaderSystem,\n    GlEncoderSystem,\n    GlStateSystem,\n    GlStencilSystem,\n    GlColorMaskSystem,\n];\nconst DefaultWebGLPipes = [...SharedRenderPipes];\nconst DefaultWebGLAdapters = [GlBatchAdaptor, GlMeshAdaptor, GlGraphicsAdaptor];\n\n// installed systems will bbe added to this array by the extensions manager..\nconst systems: { name: string; value: SystemConstructor }[] = [];\nconst renderPipes: { name: string; value: PipeConstructor }[] = [];\nconst renderPipeAdaptors: { name: string; value: any }[] = [];\n\nextensions.handleByNamedList(ExtensionType.WebGLSystem, systems);\nextensions.handleByNamedList(ExtensionType.WebGLPipes, renderPipes);\nextensions.handleByNamedList(ExtensionType.WebGLPipesAdaptor, renderPipeAdaptors);\n\n// add all the default systems as well as any user defined ones from the extensions\nextensions.add(...DefaultWebGLSystems, ...DefaultWebGLPipes, ...DefaultWebGLAdapters);\n\n/**\n * The default WebGL renderer, uses WebGL2 contexts.\n * @category rendering\n * @standard\n * @interface\n */\nexport type WebGLSystems = ExtractSystemTypes<typeof DefaultWebGLSystems>\n& PixiMixins.RendererSystems & PixiMixins.WebGLSystems;\n\n/**\n * The default WebGL renderer, uses WebGL2 contexts.\n * @internal\n */\nexport type WebGLPipes = ExtractSystemTypes<typeof DefaultWebGLPipes> & PixiMixins.RendererPipes & PixiMixins.WebGLPipes;\n\n/**\n * Options for WebGLRenderer.\n * @category rendering\n * @standard\n */\nexport interface WebGLOptions\n    extends\n    SharedRendererOptions,\n    ExtractRendererOptions<typeof DefaultWebGLSystems>,\n    PixiMixins.WebGLOptions {}\n\n// eslint-disable-next-line requireExport/require-export-jsdoc, requireMemberAPI/require-member-api-doc\nexport interface WebGLRenderer<T extends ICanvas = HTMLCanvasElement>\n    extends AbstractRenderer<WebGLPipes, WebGLOptions, T>,\n    WebGLSystems {}\n\n/* eslint-disable max-len */\n/**\n * The WebGL PixiJS Renderer. This renderer allows you to use the most common graphics API, WebGL (and WebGL2).\n *\n * ```ts\n * // Create a new renderer\n * const renderer = new WebGLRenderer();\n * await renderer.init();\n *\n * // Add the renderer to the stage\n * document.body.appendChild(renderer.canvas);\n *\n * // Create a new stage\n * const stage = new Container();\n *\n * // Render the stage\n * renderer.render(stage);\n * ```\n *\n * You can use {@link autoDetectRenderer} to create a renderer that will automatically detect the best\n * renderer for the environment.\n *\n *\n * ```ts\n * // Create a new renderer\n * const renderer = await rendering.autoDetectRenderer({\n *    preference:'webgl',\n * });\n * ```\n *\n * The renderer is composed of systems that manage specific tasks. The following systems are added by default\n * whenever you create a WebGL renderer:\n *\n * | WebGL Core Systems                          | Systems that are specific to the WebGL renderer                               |\n * | ------------------------------------------- | ----------------------------------------------------------------------------- |\n * | {@link GlUboSystem}               | This manages WebGL2 uniform buffer objects feature for shaders                |\n * | {@link GlBackBufferSystem}        | manages the back buffer, used so that we can pixi can pixels from the screen  |\n * | {@link GlContextSystem}           | This manages the WebGL context and its extensions                             |\n * | {@link GlBufferSystem}            | This manages buffers and their GPU resources, keeps everything in sync        |\n * | {@link GlTextureSystem}           | This manages textures and their GPU resources, keeps everything in sync       |\n * | {@link GlRenderTargetSystem}      | This manages what we render too. For example the screen, or another texture   |\n * | {@link GlGeometrySystem}          | This manages geometry, used for drawing meshes via the GPU                    |\n * | {@link GlUniformGroupSystem}      | This manages uniform groups. Syncing shader properties with the GPU           |\n * | {@link GlShaderSystem}            | This manages shaders, programs that run on the GPU to output lovely pixels    |\n * | {@link GlEncoderSystem}           | This manages encoders, a WebGPU Paradigm, use it to draw a mesh + shader      |\n * | {@link GlStateSystem}             | This manages the state of the WebGL context. eg the various flags that can be set blend modes / depthTesting etc |\n * | {@link GlStencilSystem}           | This manages the stencil buffer. Used primarily for masking                   |\n * | {@link GlColorMaskSystem}         | This manages the color mask. Used for color masking                           |\n *\n * The breadth of the API surface provided by the renderer is contained within these systems.\n * @category rendering\n * @property {GlUboSystem} ubo - UboSystem instance.\n * @property {GlBackBufferSystem} backBuffer - BackBufferSystem instance.\n * @property {GlContextSystem} context - ContextSystem instance.\n * @property {GlBufferSystem} buffer - BufferSystem instance.\n * @property {GlTextureSystem} texture - TextureSystem instance.\n * @property {GlRenderTargetSystem} renderTarget - RenderTargetSystem instance.\n * @property {GlGeometrySystem} geometry - GeometrySystem instance.\n * @property {GlUniformGroupSystem} uniformGroup - UniformGroupSystem instance.\n * @property {GlShaderSystem} shader - ShaderSystem instance.\n * @property {GlEncoderSystem} encoder - EncoderSystem instance.\n * @property {GlStateSystem} state - StateSystem instance.\n * @property {GlStencilSystem} stencil - StencilSystem instance.\n * @property {GlColorMaskSystem} colorMask - ColorMaskSystem instance.\n * @extends AbstractRenderer\n * @standard\n */\nexport class WebGLRenderer<T extends ICanvas = HTMLCanvasElement>\n    extends AbstractRenderer<WebGLPipes, WebGLOptions, T>\n    implements WebGLSystems\n{\n    public gl: GlRenderingContext;\n\n    constructor()\n    {\n        const systemConfig = {\n            name: 'webgl',\n            type: RendererType.WEBGL,\n            systems,\n            renderPipes,\n            renderPipeAdaptors,\n        };\n\n        super(systemConfig);\n    }\n}\n"],"names":["GlGraphicsAdaptor","contextChange","renderer","uniforms","UniformGroup","uColor","value","Float32Array","type","uTransformMatrix","Matrix","uRound","maxTextures","limits","maxBatchableTextures","glProgram","compileHighShaderGlProgram","name","bits","colorBitGl","generateTextureBatchBitGl","localUniformBitGl","roundPixelsBitGl","shader","Shader","resources","localUniforms","batchSamplers","getBatchSamplersUniformGroup","execute","graphicsPipe","renderable","context","customShader","this","contextSystem","graphicsContext","batcher","instructions","getContextRenderData","groups","globalUniforms","bindGroup","state","set","bind","geometry","batches","i","instructionSize","batch","size","j","textures","count","texture","draw","topology","start","destroy","extension","ExtensionType","WebGLPipesAdaptor","GlMeshAdaptor","init","textureBitGl","_shader","uTexture","Texture","EMPTY","source","textureUniforms","uTextureMatrix","meshPipe","mesh","warn","uSampler","style","textureMatrix","mapCoord","localUniformsBindGroup","encoder","_geometry","GlBatchAdaptor","constructor","_tempState","State","for2d","_didUploadHash","batcherPipe","runners","add","batchPipe","didUpload","uid","updateUniformGroup","uniformGroup","blendMode","BUFFER_TYPE","BUFFER_TYPE2","GlBuffer","buffer","_lastBindBaseLocation","_lastBindCallId","updateID","byteLength","GlBufferSystem","_gpuBuffers","Object","create","_boundBufferBases","_minBaseLocation","_nextBindBaseIndex","_bindCallId","_renderer","renderableGC","addManagedHash","_gl","gl","_maxBindings","maxUniformBindings","getGlBuffer","createGLBuffer","glBuffer","bindBuffer","bindBufferBase","index","UNIFORM_BUFFER","nextBindBase","hasTransformFeedback","freeLocationForBufferBase","freeIndex","getLastBindBaseLocation","loop","nextIndex","curBuf","bindBufferRange","offset","updateBuffer","_updateID","data","drawType","descriptor","usage","BufferUsage","STATIC","STATIC_DRAW","DYNAMIC_DRAW","bufferSubData","_updateSize","BYTES_PER_ELEMENT","bufferData","destroyAll","id","deleteBuffer","onBufferDestroy","contextLost","ARRAY_BUFFER","INDEX","ELEMENT_ARRAY_BUFFER","UNIFORM","createBuffer","on","resetState","WebGLSystem","_GlContextSystem","supports","uint32Indices","uniformBufferObject","vertexArrayObject","srgbTextures","nonPowOf2wrapping","msaa","nonPowOf2mipmaps","extensions","handleContextLost","handleContextRestored","isLost","isContextLost","options","_objectSpread","defaultOptions","multiView","canvas","DOMAdapter","get","createCanvas","width","height","view","initFromContext","_options$premultiplie","_options$powerPrefere","alpha","background","premultipliedAlpha","antialias","backBuffer","useBackBuffer","createContext","preferWebGLVersion","stencil","preserveDrawingBuffer","powerPreference","ensureCanvasSize","targetCanvas","Math","max","webGLVersion","getWebGLRenderingContext","getExtensions","validateContext","emit","element","addEventListener","getContext","Error","common","anisotropicFiltering","getExtension","floatTextureLinear","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc","rgtc","loseContext","drawBuffers","depthTexture","uint32ElementIndex","floatTexture","textureHalfFloat","textureHalfFloatLinear","vertexAttribDivisorANGLE","srgb","colorBufferFloat","provokeExt","provokingVertexWEBGL","FIRST_VERTEX_CONVENTION_WEBGL","event","preventDefault","_contextLossForced","setTimeout","_this$extensions$lose","restoreContext","_this$extensions$lose2","removeEventListener","useProgram","forceContextLoss","_this$extensions$lose3","attributes","getContextAttributes","isWebGl2","GlContextSystem","GL_FORMATS","GL_FORMATS2","GL_TARGETS","GL_TARGETS2","GL_TYPES","GL_TYPES2","infoMap","uint8x2","UNSIGNED_BYTE","uint8x4","sint8x2","BYTE","sint8x4","unorm8x2","unorm8x4","snorm8x2","snorm8x4","uint16x2","UNSIGNED_SHORT","uint16x4","sint16x2","SHORT","sint16x4","unorm16x2","unorm16x4","snorm16x2","snorm16x4","float16x2","HALF_FLOAT","float16x4","float32","FLOAT","float32x2","float32x3","float32x4","uint32","UNSIGNED_INT","uint32x2","uint32x3","uint32x4","sint32","INT","sint32x2","sint32x3","sint32x4","getGlTypeFromFormat","format","_infoMap$format","topologyToGlMap","GlGeometrySystem","_geometryVaoHash","_activeGeometry","_activeVao","hasVao","hasInstance","nativeVaoExtension","createVertexArray","createVertexArrayOES","bindVertexArray","vao","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","nativeInstancedExtension","drawArraysInstanced","a","b","c","d","drawArraysInstancedANGLE","drawElementsInstanced","e","drawElementsInstancedANGLE","vertexAttribDivisor","program","getVao","updateBuffers","unbind","bufferSystem","buffers","length","checkCompatibility","geometryAttributes","shaderAttributes","_attributeData","concat","getSignature","attribs","strings","push","location","join","_this$_geometryVaoHas","_key","initGeometryVao","_getProgramData","signature","onGeometryDestroy","vaoObjectHash","ensureAttributes","activateVao","arguments","undefined","indexBuffer","lastBuffer","attribute","programAttrib","_programAttrib$format","enableVertexAttribArray","attributeInfo","getAttributeInfoFromFormat","substring","vertexAttribIPointer","stride","vertexAttribPointer","normalised","instance","_attribute$divisor","divisor","instanceCount","glTopology","byteSize","glType","drawElements","getSize","drawArrays","bigTriangleGeometry","Geometry","aPosition","_GlBackBufferSystem","_useBackBufferThisRender","_antialias","_state","bigTriangleProgram","GlProgram","vertex","fragment","_bigTriangleShader","WHITE","renderStart","renderTarget","getRenderTarget","target","isRoot","renderTarget2","_targetTexture","colorTexture","_getBackBufferTexture","renderEnd","_presentBackBuffer","finishRenderPass","_backBufferTexture","targetSourceTexture","TextureSource","resolution","_resolution","resize","priority","GlBackBufferSystem","GlColorMaskSystem","_colorMaskCache","setMask","colorMask","GlEncoderSystem","commandFinished","Promise","resolve","setGeometry","skipSync","_activeProgram","GlLimitsSystem","getParameter","MAX_TEXTURE_IMAGE_UNITS","checkMaxIfStatementsInShader","MAX_UNIFORM_BUFFER_BINDINGS","GlStencilSystem","_stencilCache","enabled","stencilReference","stencilMode","STENCIL_MODES","NONE","_renderTargetStencilState","onRenderTargetChange","_comparisonFuncMapping","always","ALWAYS","never","NEVER","equal","EQUAL","NOTEQUAL","less","LESS","LEQUAL","greater","GREATER","GEQUAL","_stencilOpsMapping","keep","KEEP","zero","ZERO","replace","REPLACE","invert","INVERT","INCR","DECR","INCR_WRAP","DECR_WRAP","_activeRenderTarget","stencilState","DISABLED","setStencilMode","mode","GpuStencilModesToPixi","enable","STENCIL_TEST","stencilFunc","stencilBack","compare","stencilOp","passOp","disable","WGSL_TO_STD40_SIZE","f32","i32","createUboElementsSTD40","uniformData","uboElements","map","uboElement","boundary","curOffset","ceil","generateArraySyncSTD40","offsetToAdd","rowSize","elementSize","remainder","indexOf","createUboSyncFunctionSTD40","createUboSyncFunction","uboSyncFunctionsSTD40","GlUboSystem","UboSystem","createUboElements","generateUboSync","GlRenderTarget","msaaRenderBuffer","GlRenderTargetAdaptor","_clearColorCache","_viewPortCache","Rectangle","renderTargetSystem","_renderTargetSystem","copyToTexture","sourceRenderSurfaceTexture","destinationTexture","originSrc","originDest","glRenderTarget","getGpuRenderTarget","bindFramebuffer","FRAMEBUFFER","resolveTargetFramebuffer","copyTexSubImage2D","TEXTURE_2D","x","y","startRenderPass","clear","clearColor","viewport","gpuRenderTarget","viewPortY","pixelHeight","colorTextures","forEach","framebuffer","viewPortCache","depthStencilRenderBuffer","depth","_initStencil","READ_FRAMEBUFFER","blitFramebuffer","COLOR_BUFFER_BIT","NEAREST","initGpuRenderTarget","CanvasSource","resource","_initColor","destroyGpuRenderTarget","deleteFramebuffer","deleteRenderbuffer","renderBuffer","_renderTarget","CLEAR","ALL","COLOR","defaultClearColor","clearColorCache","clearColorArray","resizeGpuRenderTarget","_resizeColor","_resizeStencil","createFramebuffer","pixelWidth","bindSource","glTexture","getGlSource","framebufferTexture2D","COLOR_ATTACHMENT0","viewFramebuffer","_","createRenderbuffer","source2","glInternalFormat","internalFormat","bindRenderbuffer","RENDERBUFFER","renderbufferStorageMultisample","framebufferRenderbuffer","DEPTH_STENCIL_ATTACHMENT","DEPTH24_STENCIL8","renderbufferStorage","DEPTH_STENCIL","prerender","test","postrender","contextCanvas","canvasSource","context2D","drawImage","GlRenderTargetSystem","RenderTargetSystem","super","adaptor","GlProgramData","uniformGroups","uniformDirtyGroups","uniformBlockBindings","compileShader","src","createShader","shaderSource","booleanArray","array","Array","defaultValue","Int32Array","Uint32Array","GL_TABLE","GL_TO_GLSL_TYPES","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT_VEC2","INT_VEC3","INT_VEC4","UNSIGNED_INT_VEC2","UNSIGNED_INT_VEC3","UNSIGNED_INT_VEC4","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","SAMPLER_2D","INT_SAMPLER_2D","UNSIGNED_INT_SAMPLER_2D","SAMPLER_CUBE","INT_SAMPLER_CUBE","UNSIGNED_INT_SAMPLER_CUBE","SAMPLER_2D_ARRAY","INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_SAMPLER_2D_ARRAY","GLSL_TO_VERTEX_TYPES","float","vec2","vec3","vec4","int","ivec2","ivec3","ivec4","uint","uvec2","uvec3","uvec4","bool","bvec2","bvec3","bvec4","mapType","typeNames","keys","tn","mapGlToVertexFormat","typeValue","logPrettyShaderError","shaderSrc","getShaderSource","split","line","shaderLog","getShaderInfoLog","splitShader","dedupe","lineNumbers","parseFloat","filter","n","logArgs","number","fragmentSourceToLog","console","error","groupCollapsed","groupEnd","generateProgram","glVertShader","VERTEX_SHADER","glFragShader","FRAGMENT_SHADER","webGLProgram","createProgram","attachShader","transformFeedbackVaryings","names","bufferMode","SEPARATE_ATTRIBS","INTERLEAVED_ATTRIBS","linkProgram","getProgramParameter","LINK_STATUS","vertexShader","fragmentShader","getShaderParameter","COMPILE_STATUS","getProgramInfoLog","logProgramError","sortAttributes","totalAttributes","ACTIVE_ATTRIBUTES","attribData","getActiveAttrib","startsWith","sort","bindAttribLocation","getAttribLocation","extractAttributesFromGlProgram","_uniformData","totalUniforms","ACTIVE_UNIFORMS","getActiveUniform","isArray","match","getUniformData","_uniformBlockData","ACTIVE_UNIFORM_BLOCKS","uniformBlocks","totalUniformsBlocks","getActiveUniformBlockName","uniformBlockIndex","getUniformBlockIndex","getActiveUniformBlockParameter","UNIFORM_BLOCK_DATA_SIZE","getUboData","deleteShader","getUniformLocation","defaultSyncData","textureCount","blockIndex","GlShaderSystem","_programDataHash","_shaderSyncFunctions","_setProgram","syncFunction","_generateShaderSync","bindUniformBlock","programData","isBufferResource","_bufferResource","ubo","boundLocation","uniformBlockBinding","_createProgramData","key","shaderSystem","funcFragments","headerFragments","addedTextreSystem","group","resName","_uniformBindMap","Number","BufferResource","uniformName","uniform1i","functionSource","Function","generateShaderSyncCode","UNIFORM_TO_SINGLE_SETTERS","u32","UNIFORM_TO_ARRAY_SETTERS","GlUniformGroupSystem","_cache","_uniformGroupSyncHash","syncData","isStatic","_dirtyId","_getUniformSyncFunction","syncFunc","_this$_uniformGroupSy","_signature","_createUniformSyncFunction","uniformGroupSyncHash","_getSignature","_generateUniformsSync","uniform","uniformStructures","parsed","uniformParsers","parser","template","generateUniformsSync","preFix","_GlStateSystem","_invertFrontFace","stateId","polygonOffset","_blendEq","setBlend","setOffset","setCullFace","setDepthTest","setFrontFace","setDepthMask","checks","defaultState","_cullFace","_frontFace","_frontFaceDirty","blendModesMap","blendMap","normal","ONE","ONE_MINUS_SRC_ALPHA","multiply","DST_COLOR","screen","ONE_MINUS_SRC_COLOR","none","SRC_ALPHA","erase","ext","min","MIN_EXT","MAX_EXT","MIN","MAX","mapWebGLBlendModesToPixi","diff","call","forceState","_updateCheck","_checkBlendMode","BLEND","_checkPolygonOffset","POLYGON_OFFSET_FILL","DEPTH_TEST","depthMask","CULL_FACE","faceMode","_glFrontFace","frontFace","setBlendMode","blendFunc","blendFuncSeparate","blendEquationSeparate","FUNC_ADD","setPolygonOffset","scale","CCW","pixelStorei","UNPACK_FLIP_Y_WEBGL","func","splice","system","GlStateSystem","GlTexture","RGBA","samplerType","glUploadBufferImageResource","upload","texSubImage2D","texImage2D","compressedFormatMap","glUploadCompressedTextureResource","UNPACK_ALIGNMENT","mipWidth","mipHeight","compressed","levelBuffer","compressedTexImage2D","glUploadImageResource","glWidth","glHeight","textureWidth","textureHeight","resourceWidth","resourceHeight","glUploadVideoResource","isValid","scaleModeToGlFilter","linear","nearest","mipmapScaleModeToGlFilter","wrapModeToGlAddress","repeat","compareModeToGlCompare","applyStyleParams","mipmaps","anisotropicExt","glFunctionName","firstParam","forceClamp","firstCreation","castParam","addressModeU","addressModeV","addressModeW","wrapModeS","wrapModeT","wrapModeR","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_WRAP_R","magFilter","TEXTURE_MAG_FILTER","mipmapFilter","glFilterMode","minFilter","TEXTURE_MIN_FILTER","maxAnisotropy","level","MAX_TEXTURE_MAX_ANISOTROPY_EXT","TEXTURE_MAX_ANISOTROPY_EXT","TEXTURE_COMPARE_FUNC","GlTextureSystem","managedTextures","_glTextures","_glSamplers","_boundTextures","_activeTextureLocation","_boundSamplers","_uploads","image","video","_premultiplyAlpha","_useSeparateSamplers","_mapFormatToInternalFormat","bgra8unorm","SRGB8_ALPHA8_EXT","SRGB8_ALPHA8","RGBA8","r8unorm","R8","r8snorm","R8_SNORM","r8uint","R8UI","r8sint","R8I","r16uint","R16UI","r16sint","R16I","r16float","R16F","rg8unorm","RG8","rg8snorm","RG8_SNORM","rg8uint","RG8UI","rg8sint","RG8I","r32uint","R32UI","r32sint","R32I","r32float","R32F","rg16uint","RG16UI","rg16sint","RG16I","rg16float","RG16F","rgba8unorm","rgba8snorm","RGBA8_SNORM","rgba8uint","RGBA8UI","rgba8sint","RGBA8I","rgb9e5ufloat","RGB9_E5","rgb10a2unorm","RGB10_A2","rg11b10ufloat","R11F_G11F_B10F","rg32uint","RG32UI","rg32sint","RG32I","rg32float","RG32F","rgba16uint","RGBA16UI","rgba16sint","RGBA16I","rgba16float","RGBA16F","rgba32uint","RGBA32UI","rgba32sint","RGBA32I","rgba32float","RGBA32F","stencil8","STENCIL_INDEX8","depth16unorm","DEPTH_COMPONENT16","depth24plus","DEPTH_COMPONENT24","depth32float","DEPTH_COMPONENT32F","DEPTH32F_STENCIL8","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_RED_RGTC1_EXT","COMPRESSED_SIGNED_RED_RGTC1_EXT","COMPRESSED_RED_GREEN_RGTC2_EXT","COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT","COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT","COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT","COMPRESSED_RGBA_BPTC_UNORM_EXT","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","COMPRESSED_RGB8_ETC2","COMPRESSED_SRGB8_ETC2","COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2","COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2","COMPRESSED_RGBA8_ETC2_EAC","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","COMPRESSED_R11_EAC","COMPRESSED_SIGNED_RG11_EAC","COMPRESSED_RGBA_ASTC_4x4_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","COMPRESSED_RGBA_ASTC_5x4_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR","COMPRESSED_RGBA_ASTC_5x5_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR","COMPRESSED_RGBA_ASTC_6x5_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR","COMPRESSED_RGBA_ASTC_6x6_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR","COMPRESSED_RGBA_ASTC_8x5_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR","COMPRESSED_RGBA_ASTC_8x6_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR","COMPRESSED_RGBA_ASTC_8x8_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR","COMPRESSED_RGBA_ASTC_10x5_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR","COMPRESSED_RGBA_ASTC_10x6_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR","COMPRESSED_RGBA_ASTC_10x8_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR","COMPRESSED_RGBA_ASTC_10x10_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR","COMPRESSED_RGBA_ASTC_12x10_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR","COMPRESSED_RGBA_ASTC_12x12_KHR","COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR","mapFormatToGlInternalFormat","_mapFormatToType","UNSIGNED_INT_5_9_9_9_REV","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_24_8","FLOAT_32_UNSIGNED_INT_24_8_REV","mapFormatToGlType","_mapFormatToFormat","RED","RG","RGB","DEPTH_COMPONENT","mapFormatToGlFormat","initSource","_bindSampler","_touched","textureGC","_activateLocation","bindTexture","bindSampler","sampler","_getGlSampler","boundTextures","activeTexture","TEXTURE0","_initSource","createTexture","autoGenerateMipmaps","isPowerOfTwo","biggestDimension","mipLevelCount","floor","log2","includes","onSourceUpdate","onStyleChange","onSourceDestroy","onSourceUnload","onUpdateMipmaps","updateStyle","deleteTexture","alphaMode","UNPACK_PREMULTIPLY_ALPHA_WEBGL","uploadMethodId","generateMipmap","off","_initSampler","glSampler","createSampler","_resourceId","generateCanvas","pixels","getPixels","ctx","imageData","createImageData","putImageData","frame","round","Uint8Array","glRenterTarget","readPixels","Uint8ClampedArray","slice","fill","DefaultWebGLSystems","SharedSystems","DefaultWebGLPipes","SharedRenderPipes","DefaultWebGLAdapters","systems","renderPipes","renderPipeAdaptors","handleByNamedList","WebGLPipes","WebGLRenderer","AbstractRenderer","RendererType","WEBGL"],"sourceRoot":""}